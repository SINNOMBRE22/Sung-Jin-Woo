const a0_0x379de1=a0_0x3f54;(function(_0x3b4f68,_0x392536){const _0x4cfed8=a0_0x3f54,_0x5f5af1=_0x3b4f68();while(!![]){try{const _0x40cae5=-parseInt(_0x4cfed8(0x1cb))/0x1+-parseInt(_0x4cfed8(0x227))/0x2*(parseInt(_0x4cfed8(0x1e2))/0x3)+parseInt(_0x4cfed8(0x1f0))/0x4*(parseInt(_0x4cfed8(0x1f7))/0x5)+-parseInt(_0x4cfed8(0x22c))/0x6*(-parseInt(_0x4cfed8(0x1d8))/0x7)+-parseInt(_0x4cfed8(0x21e))/0x8*(-parseInt(_0x4cfed8(0x20c))/0x9)+parseInt(_0x4cfed8(0x225))/0xa*(-parseInt(_0x4cfed8(0x217))/0xb)+-parseInt(_0x4cfed8(0x1f9))/0xc;if(_0x40cae5===_0x392536)break;else _0x5f5af1['push'](_0x5f5af1['shift']());}catch(_0x52c2ef){_0x5f5af1['push'](_0x5f5af1['shift']());}}}(a0_0x588e,0x7aa12));import a0_0x5e2092 from'node-fetch';import a0_0x2ac951 from'pdfkit';import a0_0x3c06c7 from'pptxgenjs';import{createWriteStream}from'fs';import{promisify}from'util';import{pipeline}from'stream';function a0_0x588e(){const _0x37d57a=['command','height','body','presentacion.pptx','pdf','-t=','lineGap','ia\x20<texto>','133aItorj','length','openai/gpt-4o','Helvetica','json','defaultModel','statusText','find','forEach','message','3gEKeiN','-m=','POST','Respuesta\x20de\x20IA\x20malformada.','text','ia3\x20<texto>','https://yourdomain.com','application/json','count','📊\x20Presentación\x20para:\x20','trim','margins','split','toLowerCase','4XfXrqj','*Comandos\x20disponibles:*\x0a▸\x20','stringify','ia4','max_tokens','choices','concat','3950855EOAIdh','data','9688704zFBXtQ','maxHistory','get','sendFile','startsWith','\x0aTokens:\x20','join','chat','LAYOUT_WIDE','user','bufferedPageRange','help','temperature','theme','pageAdded','filter','📄\x20Resultado\x20para:\x20','push','font','4590702OQEWNi','has','string','set','error','fontSize','sender','tags','respuesta.pdf','write','end','11aqYFil','default','isArray','Malformed\x20choice\x20object:','catch','❌\x20Error:\x20','ia\x20<texto>\x20-\x20Respuesta\x20básica\x0a▸\x20','8qRWVpK','ia3','ia4\x20[opciones]\x20<texto>','addSlide','layout','Bearer\x20','model','6796400OCwoNr','363636','398802ZpoFBs','content','bodyStyle','assistant','pptx','307842nBuwLy','ia4\x20[-t=0.5]\x20[-m=1000]\x20<texto>\x20-\x20Opciones\x20avanzadas\x0a\x0a*Opciones:*\x0a-t\x20:\x20Temperatura\x20(0-2)\x0a-m\x20:\x20Máximo\x20de\x20tokens','Arial','WhatsApp\x20AI\x20Assistant','[AI\x20ERROR]','styles','reply','86359ceVMSp','substring','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','La\x20IA\x20no\x20devolvió\x20ninguna\x20elección\x20(choices).','addText'];a0_0x588e=function(){return _0x37d57a;};return a0_0x588e();}function a0_0x3f54(_0x1fdd3a,_0x334573){const _0x588ebf=a0_0x588e();return a0_0x3f54=function(_0x3f54f0,_0x499864){_0x3f54f0=_0x3f54f0-0x1c5;let _0x362810=_0x588ebf[_0x3f54f0];return _0x362810;},a0_0x3f54(_0x1fdd3a,_0x334573);}const API_KEY=a0_0x379de1(0x1cd),API_URL='https://openrouter.ai/api/v1/chat/completions',CONFIG={'defaultModel':a0_0x379de1(0x1da),'maxHistory':0x5,'maxTokens':0x5dc,'pdf':{'margins':0x32,'headerHeight':0x1e,'footerHeight':0x1e,'styles':{'title':{'fontSize':0x12,'bold':!![]},'body':{'fontSize':0xc,'lineGap':0x8}}},'pptx':{'slideWidth':13.33,'slideHeight':7.5,'titleStyle':{'fontSize':0x18,'bold':!![],'color':a0_0x379de1(0x226)},'bodyStyle':{'fontSize':0x10,'bullet':!![],'lineSpacing':0x18}}},chatHistory=new Map();async function callIA(_0x5dde05,_0x1abc6c={}){const _0x1e3a95=a0_0x379de1,_0x41db2e=await a0_0x5e2092(API_URL,{'method':_0x1e3a95(0x1e4),'headers':{'Authorization':_0x1e3a95(0x223)+API_KEY,'Content-Type':_0x1e3a95(0x1e9),'HTTP-Referer':_0x1e3a95(0x1e8),'X-Title':_0x1e3a95(0x1c7)},'body':JSON['stringify']({'model':_0x1abc6c[_0x1e3a95(0x224)]||CONFIG[_0x1e3a95(0x1dd)],'messages':_0x5dde05,'temperature':_0x1abc6c[_0x1e3a95(0x205)]||0.7,'max_tokens':_0x1abc6c['max_tokens']||CONFIG['maxTokens'],'top_p':_0x1abc6c['top_p']||0x1})});if(!_0x41db2e['ok']){const _0x5e0f08=await _0x41db2e[_0x1e3a95(0x1dc)]()[_0x1e3a95(0x21b)](()=>({}));throw new Error('API\x20Error:\x20'+(_0x5e0f08[_0x1e3a95(0x210)]?.[_0x1e3a95(0x1e1)]||_0x41db2e[_0x1e3a95(0x1de)]));}const _0x2496a1=await _0x41db2e['json']();if(!_0x2496a1[_0x1e3a95(0x1f5)]||!Array[_0x1e3a95(0x219)](_0x2496a1[_0x1e3a95(0x1f5)])||_0x2496a1[_0x1e3a95(0x1f5)][_0x1e3a95(0x1d9)]===0x0){console[_0x1e3a95(0x210)]('Unexpected\x20API\x20response:',JSON[_0x1e3a95(0x1f2)](_0x2496a1,null,0x2));throw new Error(_0x1e3a95(0x1ce));}const _0x5e50fb=_0x2496a1['choices'][0x0][_0x1e3a95(0x1e1)];if(!_0x5e50fb||typeof _0x5e50fb[_0x1e3a95(0x228)]!==_0x1e3a95(0x20e)){console[_0x1e3a95(0x210)](_0x1e3a95(0x21a),JSON['stringify'](_0x2496a1[_0x1e3a95(0x1f5)][0x0],null,0x2));throw new Error(_0x1e3a95(0x1e5));}return _0x5e50fb['content'][_0x1e3a95(0x1ec)]();}async function createPDF(_0x2d2bdf){return new Promise((_0xa00574,_0x494042)=>{const _0x454b1a=a0_0x3f54,_0x377912=new a0_0x2ac951({'margin':CONFIG[_0x454b1a(0x1d4)][_0x454b1a(0x1ed)],'bufferPages':!![]}),_0x5742f8=[];_0x377912['on'](_0x454b1a(0x1f8),_0x5742f8['push']['bind'](_0x5742f8)),_0x377912['on']('end',()=>_0xa00574(Buffer[_0x454b1a(0x1f6)](_0x5742f8))),_0x377912['on'](_0x454b1a(0x210),_0x494042),_0x377912[_0x454b1a(0x20b)](_0x454b1a(0x1db))[_0x454b1a(0x211)](CONFIG[_0x454b1a(0x1d4)][_0x454b1a(0x1c9)][_0x454b1a(0x1d2)]['fontSize'])[_0x454b1a(0x1e6)](_0x2d2bdf,{'align':'justify','lineGap':CONFIG['pdf']['styles'][_0x454b1a(0x1d2)][_0x454b1a(0x1d6)],'paragraphGap':0xa}),_0x377912['on'](_0x454b1a(0x207),()=>{const _0x329961=_0x454b1a,_0x4731c7=_0x377912[_0x329961(0x203)]()[_0x329961(0x1ea)];_0x377912[_0x329961(0x211)](0xa)['text']('Página\x20'+_0x4731c7,CONFIG[_0x329961(0x1d4)][_0x329961(0x1ed)],_0x377912['page'][_0x329961(0x1d1)]-0x14,{'align':'center'});}),_0x377912[_0x454b1a(0x216)]();});}async function createPPTX(_0x5abbac){const _0x5ea936=a0_0x379de1,_0x583116=new a0_0x3c06c7();_0x583116[_0x5ea936(0x222)]=_0x5ea936(0x201),_0x583116[_0x5ea936(0x206)]={'bodyFontFace':_0x5ea936(0x1c6),'titleFontFace':'Arial'};const _0x4aacd1=chunkText(_0x5abbac,0x1f4);return _0x4aacd1[_0x5ea936(0x1e0)](_0x49c8cc=>{const _0x1fe105=_0x5ea936,_0xd5e572=_0x583116[_0x1fe105(0x221)]();_0xd5e572[_0x1fe105(0x1cf)](_0x49c8cc,{'x':0.5,'y':0x1,'w':12.3,'h':0x5,...CONFIG[_0x1fe105(0x22b)][_0x1fe105(0x229)]});}),_0x583116[_0x5ea936(0x215)]('nodebuffer');}function chunkText(_0x1931cf,_0x1bd105){const _0x51424d=a0_0x379de1,_0x4c2cba=[];while(_0x1931cf[_0x51424d(0x1d9)]>0x0){_0x4c2cba[_0x51424d(0x20a)](_0x1931cf[_0x51424d(0x1cc)](0x0,_0x1bd105)),_0x1931cf=_0x1931cf[_0x51424d(0x1cc)](_0x1bd105);}return _0x4c2cba;}function manageHistory(_0x2ba8a3,_0x3b954c){const _0x144088=a0_0x379de1;if(!chatHistory[_0x144088(0x20d)](_0x2ba8a3))chatHistory[_0x144088(0x20f)](_0x2ba8a3,[]);const _0x1cf19d=chatHistory[_0x144088(0x1fb)](_0x2ba8a3);_0x1cf19d[_0x144088(0x20a)](_0x3b954c),_0x1cf19d[_0x144088(0x1d9)]>CONFIG[_0x144088(0x1fa)]*0x2&&_0x1cf19d['splice'](0x0,0x2);}let handler=async(_0x182c47,{conn:_0x5385d4,text:_0x1107f0,usedPrefix:_0x3b0467,command:_0x36e5b9})=>{const _0x58170d=a0_0x379de1,_0x5d2c48=_0x182c47[_0x58170d(0x212)],_0x315092=_0x1107f0['split']('\x20'),_0xe91a22={};let _0x3a837e=_0x1107f0;if(_0x36e5b9==='ia4'){const _0x3224d0=_0x315092['find'](_0x2130f1=>_0x2130f1[_0x58170d(0x1fd)](_0x58170d(0x1d5)))?.[_0x58170d(0x1ee)]('=')[0x1],_0x3edec1=_0x315092[_0x58170d(0x1df)](_0x5391de=>_0x5391de['startsWith'](_0x58170d(0x1e3)))?.[_0x58170d(0x1ee)]('=')[0x1];if(_0x3224d0)_0xe91a22[_0x58170d(0x205)]=parseFloat(_0x3224d0);if(_0x3edec1)_0xe91a22[_0x58170d(0x1f4)]=parseInt(_0x3edec1);_0x3a837e=_0x315092[_0x58170d(0x208)](_0x5f109f=>!_0x5f109f[_0x58170d(0x1fd)]('-'))[_0x58170d(0x1ff)]('\x20');}if(!_0x3a837e)return _0x182c47[_0x58170d(0x1ca)](formatHelp(_0x3b0467));try{manageHistory(_0x5d2c48,{'role':_0x58170d(0x202),'content':_0x3a837e});const _0x382d84=chatHistory['get'](_0x5d2c48),_0x38e9c9=await callIA(_0x382d84,_0xe91a22);manageHistory(_0x5d2c48,{'role':_0x58170d(0x22a),'content':_0x38e9c9});switch(_0x36e5b9[_0x58170d(0x1ef)]()){case'ia':await _0x182c47[_0x58170d(0x1ca)](_0x38e9c9);break;case'ia2':{const _0x516bfc=await createPDF(_0x38e9c9);await _0x5385d4[_0x58170d(0x1fc)](_0x182c47[_0x58170d(0x200)],_0x516bfc,_0x58170d(0x214),_0x58170d(0x209)+_0x3a837e,_0x182c47);break;}case _0x58170d(0x21f):{const _0x500be9=await createPPTX(_0x38e9c9);await _0x5385d4[_0x58170d(0x1fc)](_0x182c47[_0x58170d(0x200)],_0x500be9,_0x58170d(0x1d3),_0x58170d(0x1eb)+_0x3a837e,_0x182c47);break;}case _0x58170d(0x1f3):await _0x182c47[_0x58170d(0x1ca)]('⚙️\x20Configuraciones:\x0aTemperatura:\x20'+(_0xe91a22[_0x58170d(0x205)]||'default')+_0x58170d(0x1fe)+(_0xe91a22[_0x58170d(0x1f4)]||_0x58170d(0x218))+'\x0a\x0a'+_0x38e9c9);break;default:await _0x182c47['reply'](_0x38e9c9);}}catch(_0x300de8){console[_0x58170d(0x210)](_0x58170d(0x1c8),_0x300de8),await _0x182c47[_0x58170d(0x1ca)](_0x58170d(0x21c)+_0x300de8['message']);}};function formatHelp(_0x2d66b9){const _0x5f08fa=a0_0x379de1;return _0x5f08fa(0x1f1)+_0x2d66b9+_0x5f08fa(0x21d)+_0x2d66b9+'ia2\x20<texto>\x20-\x20Generar\x20PDF\x0a▸\x20'+_0x2d66b9+'ia3\x20<texto>\x20-\x20Generar\x20PPTX\x0a▸\x20'+_0x2d66b9+_0x5f08fa(0x1c5);}handler[a0_0x379de1(0x1d0)]=/^(ia|ia2|ia3|ia4)$/i,handler[a0_0x379de1(0x204)]=[a0_0x379de1(0x1d7),'ia2\x20<texto>',a0_0x379de1(0x1e7),a0_0x379de1(0x220)],handler[a0_0x379de1(0x213)]=['ai','tools'];export default handler;