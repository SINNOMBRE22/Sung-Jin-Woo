const a0_0x32d7b7=a0_0x4019;(function(_0x438f9b,_0x5a0e20){const _0x2b5e1b=a0_0x4019,_0xfc40c9=_0x438f9b();while(!![]){try{const _0x26130a=-parseInt(_0x2b5e1b(0x14e))/0x1*(-parseInt(_0x2b5e1b(0x11d))/0x2)+parseInt(_0x2b5e1b(0x107))/0x3+parseInt(_0x2b5e1b(0x156))/0x4+-parseInt(_0x2b5e1b(0x13d))/0x5*(-parseInt(_0x2b5e1b(0x149))/0x6)+parseInt(_0x2b5e1b(0x136))/0x7*(-parseInt(_0x2b5e1b(0x112))/0x8)+-parseInt(_0x2b5e1b(0x124))/0x9*(-parseInt(_0x2b5e1b(0x121))/0xa)+-parseInt(_0x2b5e1b(0x111))/0xb;if(_0x26130a===_0x5a0e20)break;else _0xfc40c9['push'](_0xfc40c9['shift']());}catch(_0x2d4846){_0xfc40c9['push'](_0xfc40c9['shift']());}}}(a0_0x3bbd,0x3894c));import{dirname}from'path';import{fileURLToPath}from'url';import*as a0_0x3bb899 from'fs';import*as a0_0x95a19d from'path';import*as a0_0x3aabd0 from'crypto';import{ffmpeg}from'./converter.js';import a0_0x44946a from'fluent-ffmpeg';import{spawn}from'child_process';import a0_0x5f49ad from'./uploadFile.js';import a0_0x44025c from'./uploadImage.js';import{fileTypeFromBuffer}from'file-type';import a0_0x14d2db from'node-webpmux';import a0_0x3bfc48 from'node-fetch';const __dirname=dirname(fileURLToPath(import.meta[a0_0x32d7b7(0x12a)])),tmp=a0_0x95a19d['join'](__dirname,a0_0x32d7b7(0x11f));function a0_0x4019(_0x567a7a,_0x6729cc){const _0x3bbda6=a0_0x3bbd();return a0_0x4019=function(_0x40193b,_0x2f8a7e){_0x40193b=_0x40193b-0x107;let _0xdb324c=_0x3bbda6[_0x40193b];return _0xdb324c;},a0_0x4019(_0x567a7a,_0x6729cc);}function sticker2(_0x1727f9,_0x5da647){return new Promise(async(_0x5d0d65,_0x21fc52)=>{const _0x784e59=a0_0x4019;try{if(_0x5da647){const _0x4b03e8=await a0_0x3bfc48(_0x5da647);if(_0x4b03e8['status']!==0xc8)throw await _0x4b03e8[_0x784e59(0x110)]();_0x1727f9=await _0x4b03e8['buffer']();}const _0x3109ee=a0_0x95a19d[_0x784e59(0x11a)](tmp,+new Date()+_0x784e59(0x118));await a0_0x3bb899[_0x784e59(0x145)]['writeFile'](_0x3109ee,_0x1727f9);const _0x17d961=spawn(_0x784e59(0x10f),['-y','-i',_0x3109ee,'-vf',_0x784e59(0x113),'-f',_0x784e59(0x14c),'-']);_0x17d961['on'](_0x784e59(0x141),_0x21fc52),_0x17d961['on'](_0x784e59(0x11e),async()=>{const _0x57def9=_0x784e59;await a0_0x3bb899[_0x57def9(0x145)][_0x57def9(0x116)](_0x3109ee);});const _0x13a9e2=[],[_0x24871d,..._0x279a9b]=[...module[_0x784e59(0x144)]['support']['gm']?['gm']:module[_0x784e59(0x144)][_0x784e59(0x140)]?[_0x784e59(0x140)]:[],_0x784e59(0x12e),_0x784e59(0x143),'webp:-'],_0x4e3921=spawn(_0x24871d,_0x279a9b);_0x4e3921['on'](_0x784e59(0x141),_0x1d9aae=>conn[_0x784e59(0x10e)](m[_0x784e59(0x108)],util[_0x784e59(0x13f)](_0x1d9aae),m)),_0x4e3921['stdout']['on'](_0x784e59(0x153),_0x248bd8=>_0x13a9e2[_0x784e59(0x133)](_0x248bd8)),_0x17d961[_0x784e59(0x130)]['pipe'](_0x4e3921['stdin']),_0x4e3921['on'](_0x784e59(0x154),()=>{const _0x260728=_0x784e59;_0x5d0d65(Buffer[_0x260728(0x139)](_0x13a9e2));});}catch(_0xbb69e5){_0x21fc52(_0xbb69e5);}});}async function sticker3(_0x23de12,_0x453a09,_0x4ad92e,_0x263f55){const _0x1b46e9=a0_0x32d7b7;_0x453a09=_0x453a09?_0x453a09:await a0_0x5f49ad(_0x23de12);const _0x4d01d8=await a0_0x3bfc48(_0x1b46e9(0x109)+new URLSearchParams(Object[_0x1b46e9(0x14f)]({'url':_0x453a09,'packname':_0x4ad92e,'author':_0x263f55})));return await _0x4d01d8[_0x1b46e9(0x126)]();}async function sticker4(_0x1b8d95,_0x124a6d){const _0x1ae837=a0_0x32d7b7;if(_0x124a6d){const _0x5b2d28=await a0_0x3bfc48(_0x124a6d);if(_0x5b2d28[_0x1ae837(0x148)]!==0xc8)throw await _0x5b2d28[_0x1ae837(0x110)]();_0x1b8d95=await _0x5b2d28[_0x1ae837(0x126)]();}return await ffmpeg(_0x1b8d95,[_0x1ae837(0x137),_0x1ae837(0x113)],'jpeg','webp');}function a0_0x3bbd(){const _0x5b438f=['iosAppStoreLink','format','magick','error','WEBP','png:-','exports','promises','stringify','packId','status','1194630ekZEAD','support','hex','png','bin','7049FDtrRV','entries','androidAppStoreLink','toFormat','isFirstPartySticker','data','exit','.webp','1784432jbPiuX','1277952KdGumC','chat','https://api.xteam.xyz/sticker/wm?','filter','scale=\x27min(320,iw)\x27:min\x27(320,ih)\x27:force_original_aspect_ratio=decrease,fps=15,\x20pad=320:320:-1:-1:color=white@0.0,\x20split\x20[a][b];\x20[a]\x20palettegen=reserve_transparent=on:transparency_color=ffffff\x20[p];\x20[b][p]\x20paletteuse','isAvatarSticker','templateId','reply','ffmpeg','text','10496013aihKlc','3536suUxCN','scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','accessibilityText','toString','unlink','-vcodec','.jpeg','length','join','includes','webp','6DRJCbV','close','../tmp','save','2310vMfufx','html','inputFormat','3681dytrQy','../tmp/','buffer','toUpperCase','stickerMakerSourceType','MYSTIC','url','exif','wa-sticker-formatter','isAiSticker','convert','writeFile','stdout','ffmpegWebp','utf8','push','addOutputOptions','toBuffer','14GIZAhZ','-vf','default','concat','readFile','from','ext','5TWgmNB'];a0_0x3bbd=function(){return _0x5b438f;};return a0_0x3bbd();}async function sticker5(_0x306d26,_0x1c172c,_0x31fa99,_0x29ae74,_0x56bf90=[''],_0x490b9b={}){const _0x3bedf7=a0_0x32d7b7,{Sticker:_0x191c5c}=await import(_0x3bedf7(0x12c)),_0x2460e2={'type':_0x3bedf7(0x138),'pack':_0x31fa99,'author':_0x29ae74,'categories':_0x56bf90,..._0x490b9b};return new _0x191c5c(_0x306d26?_0x306d26:_0x1c172c,_0x2460e2)[_0x3bedf7(0x135)]();}function sticker6(_0x4be7a8,_0x5b0217){return new Promise(async(_0xfeda7b,_0x2ac9c9)=>{const _0x2edba3=a0_0x4019;if(_0x5b0217){const _0x8ce477=await a0_0x3bfc48(_0x5b0217);if(_0x8ce477['status']!==0xc8)throw await _0x8ce477[_0x2edba3(0x110)]();_0x4be7a8=await _0x8ce477[_0x2edba3(0x126)]();}const _0x385953=await fileTypeFromBuffer(_0x4be7a8)||{'mime':'application/octet-stream','ext':_0x2edba3(0x14d)};if(_0x385953[_0x2edba3(0x13c)]==_0x2edba3(0x14d))_0x2ac9c9(_0x4be7a8);const _0x44f0f7=a0_0x95a19d[_0x2edba3(0x11a)](__dirname,_0x2edba3(0x125)+ +new Date()+'.'+_0x385953[_0x2edba3(0x13c)]),_0xcd64a5=a0_0x95a19d[_0x2edba3(0x11a)](_0x44f0f7+_0x2edba3(0x155));await a0_0x3bb899[_0x2edba3(0x145)][_0x2edba3(0x12f)](_0x44f0f7,_0x4be7a8);const _0xf67a21=/video/i['test'](_0x385953['mime'])?a0_0x44946a(_0x44f0f7)[_0x2edba3(0x123)](_0x385953['ext']):a0_0x44946a(_0x44f0f7)['input'](_0x44f0f7);_0xf67a21['on'](_0x2edba3(0x141),function(_0xc37a44){const _0x547430=_0x2edba3;console[_0x547430(0x141)](_0xc37a44),a0_0x3bb899[_0x547430(0x145)][_0x547430(0x116)](_0x44f0f7),_0x2ac9c9(_0x4be7a8);})['on']('end',async function(){const _0x1a318f=_0x2edba3;a0_0x3bb899[_0x1a318f(0x145)]['unlink'](_0x44f0f7),_0xfeda7b(await a0_0x3bb899['promises'][_0x1a318f(0x13a)](_0xcd64a5));})[_0x2edba3(0x134)]([_0x2edba3(0x117),'libwebp',_0x2edba3(0x137),_0x2edba3(0x10b)])[_0x2edba3(0x151)](_0x2edba3(0x11c))[_0x2edba3(0x120)](_0xcd64a5);});}async function addExif(_0x439d5b,_0x52d578,_0x55ade1,_0x7b81e=[''],_0x5d40e4){const _0x26a274=a0_0x32d7b7,_0x172968=new a0_0x14d2db['Image'](),_0x349c1c=_0x26a274(0x129)+a0_0x3aabd0['randomBytes'](0xc)[_0x26a274(0x115)](_0x26a274(0x14b))[_0x26a274(0x127)](),_0xac4143={'sticker-pack-id':_0x5d40e4[_0x26a274(0x147)]?_0x5d40e4['packId']:''+_0x349c1c,'sticker-pack-name':_0x52d578?_0x52d578:undefined,'sticker-pack-publisher':_0x55ade1?_0x55ade1:undefined,'android-app-store-link':_0x5d40e4[_0x26a274(0x150)]?_0x5d40e4[_0x26a274(0x150)]:undefined,'ios-app-store-link':_0x5d40e4[_0x26a274(0x13e)]?_0x5d40e4[_0x26a274(0x13e)]:undefined,'is-ai-sticker':_0x5d40e4[_0x26a274(0x12d)]?0x1:undefined,'is-first-party-sticker':_0x5d40e4[_0x26a274(0x152)]?0x1:undefined,'accessibility-text':_0x5d40e4[_0x26a274(0x114)]?_0x5d40e4[_0x26a274(0x114)]:undefined,'avatar-sticker-template-id':_0x5d40e4['templateId']?_0x5d40e4[_0x26a274(0x10d)]:undefined,'is-avatar-sticker':_0x5d40e4[_0x26a274(0x10c)]?0x1:undefined,'sticker-maker-source-type':_0x5d40e4['stickerMakerSourceType']?_0x5d40e4[_0x26a274(0x128)]:undefined,'emojis':_0x7b81e?_0x7b81e:undefined},_0xc49854=Buffer[_0x26a274(0x13b)]([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x324ac5=Buffer[_0x26a274(0x13b)](JSON[_0x26a274(0x146)](_0xac4143),_0x26a274(0x132)),_0x3b9e21=Buffer[_0x26a274(0x139)]([_0xc49854,_0x324ac5]);return _0x3b9e21['writeUIntLE'](_0x324ac5[_0x26a274(0x119)],0xe,0x4),await _0x172968['load'](_0x439d5b),_0x172968[_0x26a274(0x12b)]=_0x3b9e21,await _0x172968[_0x26a274(0x120)](null);}async function sticker(_0x22c486,_0x30b0c8,..._0x1ebca9){const _0x487e3c=a0_0x32d7b7;let _0x56b567,_0x49008f;for(const _0x4aa91c of[sticker3,global[_0x487e3c(0x14a)][_0x487e3c(0x10f)]&&sticker6,sticker5,global[_0x487e3c(0x14a)][_0x487e3c(0x10f)]&&global[_0x487e3c(0x14a)][_0x487e3c(0x131)]&&sticker4,global[_0x487e3c(0x14a)]['ffmpeg']&&(global[_0x487e3c(0x14a)]['convert']||global[_0x487e3c(0x14a)][_0x487e3c(0x140)]||global['support']['gm'])&&sticker2][_0x487e3c(0x10a)](_0x243e02=>_0x243e02)){try{_0x49008f=await _0x4aa91c(_0x22c486,_0x30b0c8,..._0x1ebca9);if(_0x49008f[_0x487e3c(0x11b)](_0x487e3c(0x122)))continue;if(_0x49008f[_0x487e3c(0x11b)](_0x487e3c(0x142)))try{return await addExif(_0x49008f,..._0x1ebca9);}catch(_0x5b1d4b){return console[_0x487e3c(0x141)](_0x5b1d4b),_0x49008f;}throw _0x49008f['toString']();}catch(_0x446d50){_0x56b567=_0x446d50;continue;}}return console[_0x487e3c(0x141)](_0x56b567),_0x56b567;}const support={'ffmpeg':!![],'ffprobe':!![],'ffmpegWebp':!![],'convert':!![],'magick':![],'gm':![],'find':![]};export{sticker,sticker2,sticker3,sticker4,sticker6,addExif,support};