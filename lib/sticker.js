const a0_0x28c5fd=a0_0xc207;(function(_0x514fee,_0x29cf94){const _0x2fad0b=a0_0xc207,_0x42ba4c=_0x514fee();while(!![]){try{const _0x594c30=parseInt(_0x2fad0b(0x126))/0x1*(-parseInt(_0x2fad0b(0x115))/0x2)+parseInt(_0x2fad0b(0x105))/0x3+-parseInt(_0x2fad0b(0x116))/0x4*(-parseInt(_0x2fad0b(0x124))/0x5)+parseInt(_0x2fad0b(0x140))/0x6+parseInt(_0x2fad0b(0x149))/0x7*(-parseInt(_0x2fad0b(0x131))/0x8)+parseInt(_0x2fad0b(0x139))/0x9+parseInt(_0x2fad0b(0x11d))/0xa*(-parseInt(_0x2fad0b(0x114))/0xb);if(_0x594c30===_0x29cf94)break;else _0x42ba4c['push'](_0x42ba4c['shift']());}catch(_0x544c23){_0x42ba4c['push'](_0x42ba4c['shift']());}}}(a0_0x181a,0x87625));import{dirname}from'path';import{fileURLToPath}from'url';function a0_0x181a(){const _0x5a677a=['webp','packId','jpeg','input','toBuffer','promises','3071530eGrHDT','exit','stdout','WEBP','html','writeFile','pipe','34995BNbZHu','bin','182492IsWIZt','wa-sticker-formatter','isAvatarSticker','error','ffmpeg','accessibilityText','stdin','entries','iosAppStoreLink','-vcodec','../tmp/','122816mYvmvB','Image','text','filter','save','reply','exports','test','9086967gqFpIU','ffmpegWebp','-vf','MYSTIC','concat','templateId','scale=\x27min(320,iw)\x27:min\x27(320,ih)\x27:force_original_aspect_ratio=decrease,fps=15,\x20pad=320:320:-1:-1:color=white@0.0,\x20split\x20[a][b];\x20[a]\x20palettegen=reserve_transparent=on:transparency_color=ffffff\x20[p];\x20[b][p]\x20paletteuse','1286946nuXJRE','toString','androidAppStoreLink','application/octet-stream','png:-','isAiSticker','isFirstPartySticker','chat','https://api.xteam.xyz/sticker/wm?','175gModwE','randomBytes','.jpeg','status','magick','support','.webp','inputFormat','utf8','libwebp','unlink','1009560kkcTkA','toFormat','buffer','writeUIntLE','format','close','data','toUpperCase','url','ext','join','stickerMakerSourceType','../tmp','webp:-','from','22YYecsr','4yzbdFO','204IpOjZG'];a0_0x181a=function(){return _0x5a677a;};return a0_0x181a();}import*as a0_0x387aeb from'fs';import*as a0_0x11541f from'path';import*as a0_0x56f7fc from'crypto';import{ffmpeg}from'./converter.js';import a0_0x33d8fb from'fluent-ffmpeg';import{spawn}from'child_process';import a0_0x223ac7 from'./uploadFile.js';import a0_0x3d4da9 from'./uploadImage.js';import{fileTypeFromBuffer}from'file-type';import a0_0x4ad906 from'node-webpmux';import a0_0x427a44 from'node-fetch';const __dirname=dirname(fileURLToPath(import.meta[a0_0x28c5fd(0x10d)])),tmp=a0_0x11541f[a0_0x28c5fd(0x10f)](__dirname,a0_0x28c5fd(0x111));function sticker2(_0x5acd0f,_0x1b7327){return new Promise(async(_0x34aebe,_0x1c32ad)=>{const _0x125f6e=a0_0xc207;try{if(_0x1b7327){const _0x396a4a=await a0_0x427a44(_0x1b7327);if(_0x396a4a[_0x125f6e(0xfd)]!==0xc8)throw await _0x396a4a['text']();_0x5acd0f=await _0x396a4a[_0x125f6e(0x107)]();}const _0x2c8ef4=a0_0x11541f[_0x125f6e(0x10f)](tmp,+new Date()+_0x125f6e(0x14b));await a0_0x387aeb[_0x125f6e(0x11c)]['writeFile'](_0x2c8ef4,_0x5acd0f);const _0x4285d1=spawn(_0x125f6e(0x12a),['-y','-i',_0x2c8ef4,'-vf','scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','-f','png','-']);_0x4285d1['on']('error',_0x1c32ad),_0x4285d1['on'](_0x125f6e(0x10a),async()=>{const _0x53b720=_0x125f6e;await a0_0x387aeb[_0x53b720(0x11c)][_0x53b720(0x104)](_0x2c8ef4);});const _0x47191b=[],[_0x3b5d8a,..._0x4f7f38]=[...module[_0x125f6e(0x137)][_0x125f6e(0xff)]['gm']?['gm']:module[_0x125f6e(0x137)]['magick']?[_0x125f6e(0xfe)]:[],'convert',_0x125f6e(0x144),_0x125f6e(0x112)],_0x65bb=spawn(_0x3b5d8a,_0x4f7f38);_0x65bb['on'](_0x125f6e(0x129),_0x4204bd=>conn[_0x125f6e(0x136)](m[_0x125f6e(0x147)],util[_0x125f6e(0x109)](_0x4204bd),m)),_0x65bb[_0x125f6e(0x11f)]['on'](_0x125f6e(0x10b),_0x30b212=>_0x47191b['push'](_0x30b212)),_0x4285d1[_0x125f6e(0x11f)][_0x125f6e(0x123)](_0x65bb[_0x125f6e(0x12c)]),_0x65bb['on'](_0x125f6e(0x11e),()=>{_0x34aebe(Buffer['concat'](_0x47191b));});}catch(_0x5d23f4){_0x1c32ad(_0x5d23f4);}});}async function sticker3(_0x30d35f,_0x35f5e4,_0x404079,_0x1b88a6){const _0x1009dc=a0_0x28c5fd;_0x35f5e4=_0x35f5e4?_0x35f5e4:await a0_0x223ac7(_0x30d35f);const _0x497283=await a0_0x427a44(_0x1009dc(0x148)+new URLSearchParams(Object[_0x1009dc(0x12d)]({'url':_0x35f5e4,'packname':_0x404079,'author':_0x1b88a6})));return await _0x497283[_0x1009dc(0x107)]();}function a0_0xc207(_0x2707b5,_0x512837){const _0x181a3c=a0_0x181a();return a0_0xc207=function(_0xc207b5,_0x9c27b9){_0xc207b5=_0xc207b5-0xfd;let _0x1801a0=_0x181a3c[_0xc207b5];return _0x1801a0;},a0_0xc207(_0x2707b5,_0x512837);}async function sticker4(_0x168c7a,_0x1cae79){const _0x25e7f3=a0_0x28c5fd;if(_0x1cae79){const _0x4af181=await a0_0x427a44(_0x1cae79);if(_0x4af181[_0x25e7f3(0xfd)]!==0xc8)throw await _0x4af181['text']();_0x168c7a=await _0x4af181[_0x25e7f3(0x107)]();}return await ffmpeg(_0x168c7a,[_0x25e7f3(0x13b),'scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1'],_0x25e7f3(0x119),_0x25e7f3(0x117));}async function sticker5(_0xcb8809,_0x3b0e49,_0xd88804,_0x42d5b1,_0x4f982a=[''],_0x5efcd6={}){const _0x22a920=a0_0x28c5fd,{Sticker:_0x2edc5a}=await import(_0x22a920(0x127)),_0x34178e={'type':'default','pack':_0xd88804,'author':_0x42d5b1,'categories':_0x4f982a,..._0x5efcd6};return new _0x2edc5a(_0xcb8809?_0xcb8809:_0x3b0e49,_0x34178e)[_0x22a920(0x11b)]();}function sticker6(_0x4d9277,_0x7e4968){return new Promise(async(_0x5ade82,_0x230268)=>{const _0x3b4d46=a0_0xc207;if(_0x7e4968){const _0x3014de=await a0_0x427a44(_0x7e4968);if(_0x3014de[_0x3b4d46(0xfd)]!==0xc8)throw await _0x3014de[_0x3b4d46(0x133)]();_0x4d9277=await _0x3014de[_0x3b4d46(0x107)]();}const _0x301a4f=await fileTypeFromBuffer(_0x4d9277)||{'mime':_0x3b4d46(0x143),'ext':'bin'};if(_0x301a4f['ext']==_0x3b4d46(0x125))_0x230268(_0x4d9277);const _0x2b9e8d=a0_0x11541f[_0x3b4d46(0x10f)](__dirname,_0x3b4d46(0x130)+ +new Date()+'.'+_0x301a4f[_0x3b4d46(0x10e)]),_0x1f18a3=a0_0x11541f[_0x3b4d46(0x10f)](_0x2b9e8d+_0x3b4d46(0x100));await a0_0x387aeb['promises'][_0x3b4d46(0x122)](_0x2b9e8d,_0x4d9277);const _0x30c596=/video/i[_0x3b4d46(0x138)](_0x301a4f['mime'])?a0_0x33d8fb(_0x2b9e8d)[_0x3b4d46(0x101)](_0x301a4f[_0x3b4d46(0x10e)]):a0_0x33d8fb(_0x2b9e8d)[_0x3b4d46(0x11a)](_0x2b9e8d);_0x30c596['on']('error',function(_0x1aa78e){const _0x3e87bf=_0x3b4d46;console[_0x3e87bf(0x129)](_0x1aa78e),a0_0x387aeb[_0x3e87bf(0x11c)]['unlink'](_0x2b9e8d),_0x230268(_0x4d9277);})['on']('end',async function(){const _0x1c1f56=_0x3b4d46;a0_0x387aeb[_0x1c1f56(0x11c)]['unlink'](_0x2b9e8d),_0x5ade82(await a0_0x387aeb['promises']['readFile'](_0x1f18a3));})['addOutputOptions']([_0x3b4d46(0x12f),_0x3b4d46(0x103),_0x3b4d46(0x13b),_0x3b4d46(0x13f)])[_0x3b4d46(0x106)](_0x3b4d46(0x117))['save'](_0x1f18a3);});}async function addExif(_0xc74d27,_0x4809de,_0x1f2027,_0x39ff84=[''],_0x3fb5b7){const _0xbe6c4d=a0_0x28c5fd,_0x4dd464=new a0_0x4ad906[(_0xbe6c4d(0x132))](),_0x453af0=_0xbe6c4d(0x13c)+a0_0x56f7fc[_0xbe6c4d(0x14a)](0xc)[_0xbe6c4d(0x141)]('hex')[_0xbe6c4d(0x10c)](),_0x3ae0ed={'sticker-pack-id':_0x3fb5b7[_0xbe6c4d(0x118)]?_0x3fb5b7[_0xbe6c4d(0x118)]:''+_0x453af0,'sticker-pack-name':_0x4809de?_0x4809de:undefined,'sticker-pack-publisher':_0x1f2027?_0x1f2027:undefined,'android-app-store-link':_0x3fb5b7['androidAppStoreLink']?_0x3fb5b7[_0xbe6c4d(0x142)]:undefined,'ios-app-store-link':_0x3fb5b7['iosAppStoreLink']?_0x3fb5b7[_0xbe6c4d(0x12e)]:undefined,'is-ai-sticker':_0x3fb5b7[_0xbe6c4d(0x145)]?0x1:undefined,'is-first-party-sticker':_0x3fb5b7[_0xbe6c4d(0x146)]?0x1:undefined,'accessibility-text':_0x3fb5b7[_0xbe6c4d(0x12b)]?_0x3fb5b7[_0xbe6c4d(0x12b)]:undefined,'avatar-sticker-template-id':_0x3fb5b7[_0xbe6c4d(0x13e)]?_0x3fb5b7[_0xbe6c4d(0x13e)]:undefined,'is-avatar-sticker':_0x3fb5b7[_0xbe6c4d(0x128)]?0x1:undefined,'sticker-maker-source-type':_0x3fb5b7[_0xbe6c4d(0x110)]?_0x3fb5b7[_0xbe6c4d(0x110)]:undefined,'emojis':_0x39ff84?_0x39ff84:undefined},_0x14fb76=Buffer[_0xbe6c4d(0x113)]([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x923d73=Buffer[_0xbe6c4d(0x113)](JSON['stringify'](_0x3ae0ed),_0xbe6c4d(0x102)),_0x307ca0=Buffer[_0xbe6c4d(0x13d)]([_0x14fb76,_0x923d73]);return _0x307ca0[_0xbe6c4d(0x108)](_0x923d73['length'],0xe,0x4),await _0x4dd464['load'](_0xc74d27),_0x4dd464['exif']=_0x307ca0,await _0x4dd464[_0xbe6c4d(0x135)](null);}async function sticker(_0x131b94,_0x23f8a7,..._0xad8e40){const _0x26c3b3=a0_0x28c5fd;let _0x2bf88c,_0xf0ae63;for(const _0x26b8f1 of[sticker3,global[_0x26c3b3(0xff)][_0x26c3b3(0x12a)]&&sticker6,sticker5,global[_0x26c3b3(0xff)]['ffmpeg']&&global[_0x26c3b3(0xff)][_0x26c3b3(0x13a)]&&sticker4,global[_0x26c3b3(0xff)]['ffmpeg']&&(global['support']['convert']||global[_0x26c3b3(0xff)]['magick']||global[_0x26c3b3(0xff)]['gm'])&&sticker2][_0x26c3b3(0x134)](_0x5b6a62=>_0x5b6a62)){try{_0xf0ae63=await _0x26b8f1(_0x131b94,_0x23f8a7,..._0xad8e40);if(_0xf0ae63['includes'](_0x26c3b3(0x121)))continue;if(_0xf0ae63['includes'](_0x26c3b3(0x120)))try{return await addExif(_0xf0ae63,..._0xad8e40);}catch(_0x1f337d){return console[_0x26c3b3(0x129)](_0x1f337d),_0xf0ae63;}throw _0xf0ae63[_0x26c3b3(0x141)]();}catch(_0x264692){_0x2bf88c=_0x264692;continue;}}return console[_0x26c3b3(0x129)](_0x2bf88c),_0x2bf88c;}const support={'ffmpeg':!![],'ffprobe':!![],'ffmpegWebp':!![],'convert':!![],'magick':![],'gm':![],'find':![]};export{sticker,sticker2,sticker3,sticker4,sticker6,addExif,support};