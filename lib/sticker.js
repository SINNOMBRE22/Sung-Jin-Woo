const a0_0x587fb9=a0_0x2901;(function(_0x1d234e,_0x4396c9){const _0x2b12e4=a0_0x2901,_0x41d943=_0x1d234e();while(!![]){try{const _0x2d9081=-parseInt(_0x2b12e4(0x1b3))/0x1+-parseInt(_0x2b12e4(0x197))/0x2+-parseInt(_0x2b12e4(0x1c1))/0x3*(parseInt(_0x2b12e4(0x1cb))/0x4)+-parseInt(_0x2b12e4(0x1db))/0x5+parseInt(_0x2b12e4(0x1d8))/0x6*(parseInt(_0x2b12e4(0x1c3))/0x7)+parseInt(_0x2b12e4(0x199))/0x8+parseInt(_0x2b12e4(0x1af))/0x9;if(_0x2d9081===_0x4396c9)break;else _0x41d943['push'](_0x41d943['shift']());}catch(_0x5e947a){_0x41d943['push'](_0x41d943['shift']());}}}(a0_0x544c,0x6801b));function a0_0x544c(){const _0x2de810=['inputFormat','../tmp/','accessibilityText','promises','androidAppStoreLink','985984fgLwrv','utf8','readFile','iosAppStoreLink','entries','writeUIntLE','stdin','webp','../tmp','scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','stickerMakerSourceType','webp:-','bin','4578RQVXiS','load','test','1182570NYEgdU','default','https://api.xteam.xyz/sticker/wm?','unlink','isFirstPartySticker','buffer','format','input','exports','420692VgWuDh','writeFile','4608392zCyZvY','pipe','png:-','mime','convert','stdout','close','toString','toUpperCase','hex','html','join','toBuffer','scale=\x27min(320,iw)\x27:min\x27(320,ih)\x27:force_original_aspect_ratio=decrease,fps=15,\x20pad=320:320:-1:-1:color=white@0.0,\x20split\x20[a][b];\x20[a]\x20palettegen=reserve_transparent=on:transparency_color=ffffff\x20[p];\x20[b][p]\x20paletteuse','ffmpegWebp','text','addOutputOptions','jpeg','exif','isAvatarSticker','save','status','7311600AsZoqI','chat','randomBytes','includes','352965LDwPez','url','error','push','magick','.jpeg','concat','-vcodec','ext','packId','ffmpeg','support','data','from','6wmmECQ','length','3031SUGiev','-vf','templateId'];a0_0x544c=function(){return _0x2de810;};return a0_0x544c();}import{dirname}from'path';import{fileURLToPath}from'url';import*as a0_0x260b4f from'fs';import*as a0_0x4f15bb from'path';import*as a0_0x37880d from'crypto';import{ffmpeg}from'./converter.js';import a0_0x22290e from'fluent-ffmpeg';import{spawn}from'child_process';import a0_0x5dfe93 from'./uploadFile.js';import a0_0x17cdeb from'./uploadImage.js';import{fileTypeFromBuffer}from'file-type';import a0_0x530730 from'node-webpmux';import a0_0x19a8c2 from'node-fetch';const __dirname=dirname(fileURLToPath(import.meta[a0_0x587fb9(0x1b4)])),tmp=a0_0x4f15bb[a0_0x587fb9(0x1a4)](__dirname,a0_0x587fb9(0x1d3));function sticker2(_0x19bd04,_0x462f11){return new Promise(async(_0x32ab8f,_0x59af2b)=>{const _0x194f04=a0_0x2901;try{if(_0x462f11){const _0x3ad70d=await a0_0x19a8c2(_0x462f11);if(_0x3ad70d[_0x194f04(0x1ae)]!==0xc8)throw await _0x3ad70d['text']();_0x19bd04=await _0x3ad70d['buffer']();}const _0x3cd7ec=a0_0x4f15bb[_0x194f04(0x1a4)](tmp,+new Date()+_0x194f04(0x1b8));await a0_0x260b4f[_0x194f04(0x1c9)][_0x194f04(0x198)](_0x3cd7ec,_0x19bd04);const _0x53b54d=spawn('ffmpeg',['-y','-i',_0x3cd7ec,_0x194f04(0x1c4),_0x194f04(0x1d4),'-f','png','-']);_0x53b54d['on'](_0x194f04(0x1b5),_0x59af2b),_0x53b54d['on'](_0x194f04(0x19f),async()=>{const _0x577c7b=_0x194f04;await a0_0x260b4f[_0x577c7b(0x1c9)][_0x577c7b(0x1de)](_0x3cd7ec);});const _0x865349=[],[_0x71505d,..._0x520a56]=[...module[_0x194f04(0x196)][_0x194f04(0x1be)]['gm']?['gm']:module[_0x194f04(0x196)][_0x194f04(0x1b7)]?[_0x194f04(0x1b7)]:[],'convert',_0x194f04(0x19b),_0x194f04(0x1d6)],_0x3a3c52=spawn(_0x71505d,_0x520a56);_0x3a3c52['on'](_0x194f04(0x1b5),_0x47ee86=>conn['reply'](m[_0x194f04(0x1b0)],util[_0x194f04(0x194)](_0x47ee86),m)),_0x3a3c52[_0x194f04(0x19e)]['on'](_0x194f04(0x1bf),_0x1bc35f=>_0x865349[_0x194f04(0x1b6)](_0x1bc35f)),_0x53b54d[_0x194f04(0x19e)][_0x194f04(0x19a)](_0x3a3c52[_0x194f04(0x1d1)]),_0x3a3c52['on']('exit',()=>{const _0x33fc1e=_0x194f04;_0x32ab8f(Buffer[_0x33fc1e(0x1b9)](_0x865349));});}catch(_0x26ab63){_0x59af2b(_0x26ab63);}});}async function sticker3(_0x32f661,_0x19ab5b,_0x11bd4e,_0x5455c0){const _0x26acbd=a0_0x587fb9;_0x19ab5b=_0x19ab5b?_0x19ab5b:await a0_0x5dfe93(_0x32f661);const _0x23c07d=await a0_0x19a8c2(_0x26acbd(0x1dd)+new URLSearchParams(Object[_0x26acbd(0x1cf)]({'url':_0x19ab5b,'packname':_0x11bd4e,'author':_0x5455c0})));return await _0x23c07d[_0x26acbd(0x1e0)]();}async function sticker4(_0x4c9502,_0x4d3cde){const _0x17c216=a0_0x587fb9;if(_0x4d3cde){const _0x9a0d51=await a0_0x19a8c2(_0x4d3cde);if(_0x9a0d51['status']!==0xc8)throw await _0x9a0d51[_0x17c216(0x1a8)]();_0x4c9502=await _0x9a0d51[_0x17c216(0x1e0)]();}return await ffmpeg(_0x4c9502,[_0x17c216(0x1c4),_0x17c216(0x1d4)],_0x17c216(0x1aa),'webp');}async function sticker5(_0x5dfa71,_0x303bee,_0x57d563,_0x41e563,_0x100f1d=[''],_0x57c124={}){const _0x560de8=a0_0x587fb9,{Sticker:_0x12529c}=await import('wa-sticker-formatter'),_0x56c03={'type':_0x560de8(0x1dc),'pack':_0x57d563,'author':_0x41e563,'categories':_0x100f1d,..._0x57c124};return new _0x12529c(_0x5dfa71?_0x5dfa71:_0x303bee,_0x56c03)[_0x560de8(0x1a5)]();}function sticker6(_0x39995b,_0x80ffde){return new Promise(async(_0x4758b3,_0x47a809)=>{const _0x4fef15=a0_0x2901;if(_0x80ffde){const _0x14f7a6=await a0_0x19a8c2(_0x80ffde);if(_0x14f7a6['status']!==0xc8)throw await _0x14f7a6[_0x4fef15(0x1a8)]();_0x39995b=await _0x14f7a6[_0x4fef15(0x1e0)]();}const _0x14b115=await fileTypeFromBuffer(_0x39995b)||{'mime':'application/octet-stream','ext':_0x4fef15(0x1d7)};if(_0x14b115['ext']==_0x4fef15(0x1d7))_0x47a809(_0x39995b);const _0x4690cd=a0_0x4f15bb['join'](__dirname,_0x4fef15(0x1c7)+ +new Date()+'.'+_0x14b115[_0x4fef15(0x1bb)]),_0x521eb5=a0_0x4f15bb[_0x4fef15(0x1a4)](_0x4690cd+'.webp');await a0_0x260b4f[_0x4fef15(0x1c9)]['writeFile'](_0x4690cd,_0x39995b);const _0x5c0d78=/video/i[_0x4fef15(0x1da)](_0x14b115[_0x4fef15(0x19c)])?a0_0x22290e(_0x4690cd)[_0x4fef15(0x1c6)](_0x14b115['ext']):a0_0x22290e(_0x4690cd)[_0x4fef15(0x195)](_0x4690cd);_0x5c0d78['on']('error',function(_0x414fca){const _0x245343=_0x4fef15;console[_0x245343(0x1b5)](_0x414fca),a0_0x260b4f['promises'][_0x245343(0x1de)](_0x4690cd),_0x47a809(_0x39995b);})['on']('end',async function(){const _0x251ce5=_0x4fef15;a0_0x260b4f[_0x251ce5(0x1c9)][_0x251ce5(0x1de)](_0x4690cd),_0x4758b3(await a0_0x260b4f[_0x251ce5(0x1c9)][_0x251ce5(0x1cd)](_0x521eb5));})[_0x4fef15(0x1a9)]([_0x4fef15(0x1ba),'libwebp','-vf',_0x4fef15(0x1a6)])['toFormat'](_0x4fef15(0x1d2))[_0x4fef15(0x1ad)](_0x521eb5);});}async function addExif(_0x267c8b,_0xc53d09,_0x1bfde3,_0x5d0e15=[''],_0x408d6b){const _0x505671=a0_0x587fb9,_0x5a9972=new a0_0x530730['Image'](),_0x4f550a='MYSTIC'+a0_0x37880d[_0x505671(0x1b1)](0xc)[_0x505671(0x1a0)](_0x505671(0x1a2))[_0x505671(0x1a1)](),_0x8d3aba={'sticker-pack-id':_0x408d6b['packId']?_0x408d6b[_0x505671(0x1bc)]:''+_0x4f550a,'sticker-pack-name':_0xc53d09?_0xc53d09:undefined,'sticker-pack-publisher':_0x1bfde3?_0x1bfde3:undefined,'android-app-store-link':_0x408d6b['androidAppStoreLink']?_0x408d6b[_0x505671(0x1ca)]:undefined,'ios-app-store-link':_0x408d6b['iosAppStoreLink']?_0x408d6b[_0x505671(0x1ce)]:undefined,'is-ai-sticker':_0x408d6b['isAiSticker']?0x1:undefined,'is-first-party-sticker':_0x408d6b[_0x505671(0x1df)]?0x1:undefined,'accessibility-text':_0x408d6b[_0x505671(0x1c8)]?_0x408d6b[_0x505671(0x1c8)]:undefined,'avatar-sticker-template-id':_0x408d6b[_0x505671(0x1c5)]?_0x408d6b[_0x505671(0x1c5)]:undefined,'is-avatar-sticker':_0x408d6b[_0x505671(0x1ac)]?0x1:undefined,'sticker-maker-source-type':_0x408d6b[_0x505671(0x1d5)]?_0x408d6b[_0x505671(0x1d5)]:undefined,'emojis':_0x5d0e15?_0x5d0e15:undefined},_0x4e0760=Buffer['from']([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0xe9fe8c=Buffer[_0x505671(0x1c0)](JSON['stringify'](_0x8d3aba),_0x505671(0x1cc)),_0x22bc0e=Buffer[_0x505671(0x1b9)]([_0x4e0760,_0xe9fe8c]);return _0x22bc0e[_0x505671(0x1d0)](_0xe9fe8c[_0x505671(0x1c2)],0xe,0x4),await _0x5a9972[_0x505671(0x1d9)](_0x267c8b),_0x5a9972[_0x505671(0x1ab)]=_0x22bc0e,await _0x5a9972['save'](null);}function a0_0x2901(_0x4431f6,_0x25f455){const _0x544c1b=a0_0x544c();return a0_0x2901=function(_0x29013f,_0x5aff72){_0x29013f=_0x29013f-0x194;let _0x2a56de=_0x544c1b[_0x29013f];return _0x2a56de;},a0_0x2901(_0x4431f6,_0x25f455);}async function sticker(_0x5d4aaa,_0x2aed75,..._0x1f7bb5){const _0x3776e3=a0_0x587fb9;let _0x30182f,_0x2c797f;for(const _0x15c84e of[sticker3,global[_0x3776e3(0x1be)]['ffmpeg']&&sticker6,sticker5,global[_0x3776e3(0x1be)][_0x3776e3(0x1bd)]&&global['support'][_0x3776e3(0x1a7)]&&sticker4,global[_0x3776e3(0x1be)]['ffmpeg']&&(global['support'][_0x3776e3(0x19d)]||global[_0x3776e3(0x1be)][_0x3776e3(0x1b7)]||global[_0x3776e3(0x1be)]['gm'])&&sticker2]['filter'](_0x470533=>_0x470533)){try{_0x2c797f=await _0x15c84e(_0x5d4aaa,_0x2aed75,..._0x1f7bb5);if(_0x2c797f[_0x3776e3(0x1b2)](_0x3776e3(0x1a3)))continue;if(_0x2c797f[_0x3776e3(0x1b2)]('WEBP'))try{return await addExif(_0x2c797f,..._0x1f7bb5);}catch(_0x274516){return console[_0x3776e3(0x1b5)](_0x274516),_0x2c797f;}throw _0x2c797f['toString']();}catch(_0x50b61f){_0x30182f=_0x50b61f;continue;}}return console[_0x3776e3(0x1b5)](_0x30182f),_0x30182f;}const support={'ffmpeg':!![],'ffprobe':!![],'ffmpegWebp':!![],'convert':!![],'magick':![],'gm':![],'find':![]};export{sticker,sticker2,sticker3,sticker4,sticker6,addExif,support};