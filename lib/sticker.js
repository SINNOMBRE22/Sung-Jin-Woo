const a0_0x18d0e2=a0_0x3d43;(function(_0x3a6799,_0x4435c3){const _0x6ce8d3=a0_0x3d43,_0x1485d8=_0x3a6799();while(!![]){try{const _0x2a326e=-parseInt(_0x6ce8d3(0xaf))/0x1*(-parseInt(_0x6ce8d3(0xc1))/0x2)+parseInt(_0x6ce8d3(0xc3))/0x3+-parseInt(_0x6ce8d3(0xc2))/0x4*(-parseInt(_0x6ce8d3(0x91))/0x5)+parseInt(_0x6ce8d3(0x98))/0x6+parseInt(_0x6ce8d3(0xa7))/0x7+-parseInt(_0x6ce8d3(0xb4))/0x8+parseInt(_0x6ce8d3(0xcb))/0x9*(-parseInt(_0x6ce8d3(0xb3))/0xa);if(_0x2a326e===_0x4435c3)break;else _0x1485d8['push'](_0x1485d8['shift']());}catch(_0x3b25cf){_0x1485d8['push'](_0x1485d8['shift']());}}}(a0_0x268f,0x67ece));import{dirname}from'path';import{fileURLToPath}from'url';import*as a0_0x108bc0 from'fs';import*as a0_0x5bfce3 from'path';import*as a0_0x2c06b9 from'crypto';import{ffmpeg}from'./converter.js';import a0_0x99beff from'fluent-ffmpeg';import{spawn}from'child_process';import a0_0x2d1afd from'./uploadFile.js';import a0_0x4dfb0b from'./uploadImage.js';import{fileTypeFromBuffer}from'file-type';function a0_0x3d43(_0xcb1299,_0x5b8cc9){const _0x268f18=a0_0x268f();return a0_0x3d43=function(_0x3d43ad,_0x1c4927){_0x3d43ad=_0x3d43ad-0x89;let _0x27d279=_0x268f18[_0x3d43ad];return _0x27d279;},a0_0x3d43(_0xcb1299,_0x5b8cc9);}import a0_0x4cdf31 from'node-webpmux';import a0_0x3d69f5 from'node-fetch';function a0_0x268f(){const _0x1168c2=['end','inputFormat','../tmp/','scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','randomBytes','.jpeg','wa-sticker-formatter','status','libwebp','pipe','stickerMakerSourceType','webp:-','mime','-vf','535ovRUGu','magick','iosAppStoreLink','androidAppStoreLink','filter','unlink','toUpperCase','3270066MVoXRi','join','toString','isFirstPartySticker','jpeg','addOutputOptions','writeUIntLE','stdout','-vcodec','ffmpeg','chat','../tmp','stringify','push','buffer','2518726wKIVNb','error','scale=\x27min(320,iw)\x27:min\x27(320,ih)\x27:force_original_aspect_ratio=decrease,fps=15,\x20pad=320:320:-1:-1:color=white@0.0,\x20split\x20[a][b];\x20[a]\x20palettegen=reserve_transparent=on:transparency_color=ffffff\x20[p];\x20[b][p]\x20paletteuse','isAiSticker','utf8','isAvatarSticker','webp','from','30CbmlaS','entries','.webp','exports','30vWhFHl','2010360XSuhwm','accessibilityText','text','readFile','templateId','default','stdin','support','save','length','ext','https://api.xteam.xyz/sticker/wm?','convert','42118fEfHsd','21652LTraFE','2195328PhyTmL','close','packId','toBuffer','bin','exif','format','ffmpegWebp','6511779MADDTP','test','url','promises','concat','includes','png'];a0_0x268f=function(){return _0x1168c2;};return a0_0x268f();}const __dirname=dirname(fileURLToPath(import.meta[a0_0x18d0e2(0xcd)])),tmp=a0_0x5bfce3[a0_0x18d0e2(0x99)](__dirname,a0_0x18d0e2(0xa3));function sticker2(_0x21023c,_0x19dc20){return new Promise(async(_0x47c089,_0x569dcb)=>{const _0x5181b4=a0_0x3d43;try{if(_0x19dc20){const _0x278d13=await a0_0x3d69f5(_0x19dc20);if(_0x278d13['status']!==0xc8)throw await _0x278d13[_0x5181b4(0xb6)]();_0x21023c=await _0x278d13[_0x5181b4(0xa6)]();}const _0x23bf4d=a0_0x5bfce3[_0x5181b4(0x99)](tmp,+new Date()+_0x5181b4(0xd7));await a0_0x108bc0[_0x5181b4(0xce)]['writeFile'](_0x23bf4d,_0x21023c);const _0x3b05d1=spawn(_0x5181b4(0xa1),['-y','-i',_0x23bf4d,'-vf',_0x5181b4(0xd5),'-f',_0x5181b4(0xd1),'-']);_0x3b05d1['on'](_0x5181b4(0xa8),_0x569dcb),_0x3b05d1['on'](_0x5181b4(0xc4),async()=>{const _0x2d2c43=_0x5181b4;await a0_0x108bc0['promises'][_0x2d2c43(0x96)](_0x23bf4d);});const _0x44f5c1=[],[_0x4e599d,..._0xa57a3a]=[...module['exports'][_0x5181b4(0xbb)]['gm']?['gm']:module[_0x5181b4(0xb2)][_0x5181b4(0x92)]?[_0x5181b4(0x92)]:[],_0x5181b4(0xc0),'png:-',_0x5181b4(0x8e)],_0x47002f=spawn(_0x4e599d,_0xa57a3a);_0x47002f['on'](_0x5181b4(0xa8),_0x5845bf=>conn['reply'](m[_0x5181b4(0xa2)],util[_0x5181b4(0xc9)](_0x5845bf),m)),_0x47002f['stdout']['on']('data',_0x34d8d3=>_0x44f5c1[_0x5181b4(0xa5)](_0x34d8d3)),_0x3b05d1[_0x5181b4(0x9f)][_0x5181b4(0x8c)](_0x47002f[_0x5181b4(0xba)]),_0x47002f['on']('exit',()=>{const _0x119030=_0x5181b4;_0x47c089(Buffer[_0x119030(0xcf)](_0x44f5c1));});}catch(_0x71158e){_0x569dcb(_0x71158e);}});}async function sticker3(_0x1a4e16,_0x2cc2c7,_0x4bda83,_0x711585){const _0x5bc893=a0_0x18d0e2;_0x2cc2c7=_0x2cc2c7?_0x2cc2c7:await a0_0x2d1afd(_0x1a4e16);const _0x4c0717=await a0_0x3d69f5(_0x5bc893(0xbf)+new URLSearchParams(Object[_0x5bc893(0xb0)]({'url':_0x2cc2c7,'packname':_0x4bda83,'author':_0x711585})));return await _0x4c0717[_0x5bc893(0xa6)]();}async function sticker4(_0x43868d,_0xc14a1f){const _0x2ef6c3=a0_0x18d0e2;if(_0xc14a1f){const _0x383c21=await a0_0x3d69f5(_0xc14a1f);if(_0x383c21[_0x2ef6c3(0x8a)]!==0xc8)throw await _0x383c21[_0x2ef6c3(0xb6)]();_0x43868d=await _0x383c21['buffer']();}return await ffmpeg(_0x43868d,[_0x2ef6c3(0x90),_0x2ef6c3(0xd5)],_0x2ef6c3(0x9c),_0x2ef6c3(0xad));}async function sticker5(_0x43e574,_0x57e600,_0x27d00d,_0x2f8ce3,_0x38ddbe=[''],_0x47b27e={}){const _0xca8033=a0_0x18d0e2,{Sticker:_0x56bdb5}=await import(_0xca8033(0x89)),_0x3b4a8b={'type':_0xca8033(0xb9),'pack':_0x27d00d,'author':_0x2f8ce3,'categories':_0x38ddbe,..._0x47b27e};return new _0x56bdb5(_0x43e574?_0x43e574:_0x57e600,_0x3b4a8b)[_0xca8033(0xc6)]();}function sticker6(_0x4181e5,_0x61003b){return new Promise(async(_0x4247cf,_0x1b2e9a)=>{const _0x314fb0=a0_0x3d43;if(_0x61003b){const _0x370143=await a0_0x3d69f5(_0x61003b);if(_0x370143[_0x314fb0(0x8a)]!==0xc8)throw await _0x370143[_0x314fb0(0xb6)]();_0x4181e5=await _0x370143[_0x314fb0(0xa6)]();}const _0x4f30c9=await fileTypeFromBuffer(_0x4181e5)||{'mime':'application/octet-stream','ext':_0x314fb0(0xc7)};if(_0x4f30c9[_0x314fb0(0xbe)]==_0x314fb0(0xc7))_0x1b2e9a(_0x4181e5);const _0x317fa9=a0_0x5bfce3['join'](__dirname,_0x314fb0(0xd4)+ +new Date()+'.'+_0x4f30c9[_0x314fb0(0xbe)]),_0x44fdb9=a0_0x5bfce3[_0x314fb0(0x99)](_0x317fa9+_0x314fb0(0xb1));await a0_0x108bc0[_0x314fb0(0xce)]['writeFile'](_0x317fa9,_0x4181e5);const _0x3fe417=/video/i[_0x314fb0(0xcc)](_0x4f30c9[_0x314fb0(0x8f)])?a0_0x99beff(_0x317fa9)[_0x314fb0(0xd3)](_0x4f30c9[_0x314fb0(0xbe)]):a0_0x99beff(_0x317fa9)['input'](_0x317fa9);_0x3fe417['on']('error',function(_0x2cc76c){const _0x1f9d14=_0x314fb0;console['error'](_0x2cc76c),a0_0x108bc0[_0x1f9d14(0xce)][_0x1f9d14(0x96)](_0x317fa9),_0x1b2e9a(_0x4181e5);})['on'](_0x314fb0(0xd2),async function(){const _0x35a314=_0x314fb0;a0_0x108bc0['promises'][_0x35a314(0x96)](_0x317fa9),_0x4247cf(await a0_0x108bc0['promises'][_0x35a314(0xb7)](_0x44fdb9));})[_0x314fb0(0x9d)]([_0x314fb0(0xa0),_0x314fb0(0x8b),_0x314fb0(0x90),_0x314fb0(0xa9)])['toFormat'](_0x314fb0(0xad))[_0x314fb0(0xbc)](_0x44fdb9);});}async function addExif(_0x37af18,_0x1b9cc4,_0x5d717a,_0x36e4b5=[''],_0x4964cc){const _0x2db911=a0_0x18d0e2,_0x27ff15=new a0_0x4cdf31['Image'](),_0x59671e='MYSTIC'+a0_0x2c06b9[_0x2db911(0xd6)](0xc)['toString']('hex')[_0x2db911(0x97)](),_0x2b69d2={'sticker-pack-id':_0x4964cc[_0x2db911(0xc5)]?_0x4964cc[_0x2db911(0xc5)]:''+_0x59671e,'sticker-pack-name':_0x1b9cc4?_0x1b9cc4:undefined,'sticker-pack-publisher':_0x5d717a?_0x5d717a:undefined,'android-app-store-link':_0x4964cc[_0x2db911(0x94)]?_0x4964cc['androidAppStoreLink']:undefined,'ios-app-store-link':_0x4964cc[_0x2db911(0x93)]?_0x4964cc[_0x2db911(0x93)]:undefined,'is-ai-sticker':_0x4964cc[_0x2db911(0xaa)]?0x1:undefined,'is-first-party-sticker':_0x4964cc[_0x2db911(0x9b)]?0x1:undefined,'accessibility-text':_0x4964cc[_0x2db911(0xb5)]?_0x4964cc['accessibilityText']:undefined,'avatar-sticker-template-id':_0x4964cc[_0x2db911(0xb8)]?_0x4964cc[_0x2db911(0xb8)]:undefined,'is-avatar-sticker':_0x4964cc[_0x2db911(0xac)]?0x1:undefined,'sticker-maker-source-type':_0x4964cc[_0x2db911(0x8d)]?_0x4964cc[_0x2db911(0x8d)]:undefined,'emojis':_0x36e4b5?_0x36e4b5:undefined},_0x509076=Buffer[_0x2db911(0xae)]([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x156ff4=Buffer[_0x2db911(0xae)](JSON[_0x2db911(0xa4)](_0x2b69d2),_0x2db911(0xab)),_0x5ad15e=Buffer[_0x2db911(0xcf)]([_0x509076,_0x156ff4]);return _0x5ad15e[_0x2db911(0x9e)](_0x156ff4[_0x2db911(0xbd)],0xe,0x4),await _0x27ff15['load'](_0x37af18),_0x27ff15[_0x2db911(0xc8)]=_0x5ad15e,await _0x27ff15[_0x2db911(0xbc)](null);}async function sticker(_0x15aed9,_0x3c1d34,..._0x4c08d5){const _0x5145cd=a0_0x18d0e2;let _0x5d6921,_0x3cc86b;for(const _0x1edacd of[sticker3,global['support']['ffmpeg']&&sticker6,sticker5,global[_0x5145cd(0xbb)][_0x5145cd(0xa1)]&&global[_0x5145cd(0xbb)][_0x5145cd(0xca)]&&sticker4,global['support'][_0x5145cd(0xa1)]&&(global[_0x5145cd(0xbb)][_0x5145cd(0xc0)]||global['support'][_0x5145cd(0x92)]||global['support']['gm'])&&sticker2][_0x5145cd(0x95)](_0x5888fc=>_0x5888fc)){try{_0x3cc86b=await _0x1edacd(_0x15aed9,_0x3c1d34,..._0x4c08d5);if(_0x3cc86b['includes']('html'))continue;if(_0x3cc86b[_0x5145cd(0xd0)]('WEBP'))try{return await addExif(_0x3cc86b,..._0x4c08d5);}catch(_0x288bd4){return console['error'](_0x288bd4),_0x3cc86b;}throw _0x3cc86b[_0x5145cd(0x9a)]();}catch(_0x576167){_0x5d6921=_0x576167;continue;}}return console[_0x5145cd(0xa8)](_0x5d6921),_0x5d6921;}const support={'ffmpeg':!![],'ffprobe':!![],'ffmpegWebp':!![],'convert':!![],'magick':![],'gm':![],'find':![]};export{sticker,sticker2,sticker3,sticker4,sticker6,addExif,support};