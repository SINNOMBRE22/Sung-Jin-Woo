const a0_0x180093=a0_0x1f44;(function(_0x54a465,_0x59255a){const _0x1bde57=a0_0x1f44,_0x5892fe=_0x54a465();while(!![]){try{const _0x163759=parseInt(_0x1bde57(0x1f5))/0x1*(parseInt(_0x1bde57(0x1d6))/0x2)+parseInt(_0x1bde57(0x1e7))/0x3*(parseInt(_0x1bde57(0x1c4))/0x4)+parseInt(_0x1bde57(0x1d5))/0x5+-parseInt(_0x1bde57(0x1ff))/0x6+parseInt(_0x1bde57(0x1db))/0x7+parseInt(_0x1bde57(0x1fa))/0x8+-parseInt(_0x1bde57(0x200))/0x9*(parseInt(_0x1bde57(0x1bf))/0xa);if(_0x163759===_0x59255a)break;else _0x5892fe['push'](_0x5892fe['shift']());}catch(_0x4524f9){_0x5892fe['push'](_0x5892fe['shift']());}}}(a0_0x1b24,0x576c1));import{dirname}from'path';import{fileURLToPath}from'url';import*as a0_0x145483 from'fs';import*as a0_0x1a3d80 from'path';import*as a0_0x5ccd23 from'crypto';function a0_0x1b24(){const _0x32962e=['bin','application/octet-stream','load','exit','from','-vf','../tmp','24190pPppUM','packId','toFormat','test','length','4miTdwV','buffer','pipe','ext','join','support','stdin','ffmpegWebp','.webp','hex','end','wa-sticker-formatter','html','Image','stdout','androidAppStoreLink','status','2039445tSIiBG','988426CdixPw','exports','writeUIntLE','error','../tmp/','2602453NZlQve','input','WEBP','iosAppStoreLink','includes','jpeg','scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','writeFile','exif','chat','scale=\x27min(320,iw)\x27:min\x27(320,ih)\x27:force_original_aspect_ratio=decrease,fps=15,\x20pad=320:320:-1:-1:color=white@0.0,\x20split\x20[a][b];\x20[a]\x20palettegen=reserve_transparent=on:transparency_color=ffffff\x20[p];\x20[b][p]\x20paletteuse','promises','610455GBlhNb','save','isFirstPartySticker','magick','randomBytes','addOutputOptions','-vcodec','text','convert','MYSTIC','reply','mime','data','isAvatarSticker','1mrEQoA','unlink','toString','toBuffer','default','5690048IIVyJS','webp:-','close','readFile','templateId','1737828euQRei','5733NsIxYV','https://api.xteam.xyz/sticker/wm?','webp','entries','ffmpeg','format'];a0_0x1b24=function(){return _0x32962e;};return a0_0x1b24();}import{ffmpeg}from'./converter.js';function a0_0x1f44(_0x140c0d,_0x503dcf){const _0x1b2414=a0_0x1b24();return a0_0x1f44=function(_0x1f44e0,_0x582937){_0x1f44e0=_0x1f44e0-0x1b9;let _0x1d1d33=_0x1b2414[_0x1f44e0];return _0x1d1d33;},a0_0x1f44(_0x140c0d,_0x503dcf);}import a0_0xc6a25e from'fluent-ffmpeg';import{spawn}from'child_process';import a0_0x33b00a from'./uploadFile.js';import a0_0xae5596 from'./uploadImage.js';import{fileTypeFromBuffer}from'file-type';import a0_0x27d932 from'node-webpmux';import a0_0x53f6d1 from'node-fetch';const __dirname=dirname(fileURLToPath(import.meta['url'])),tmp=a0_0x1a3d80['join'](__dirname,a0_0x180093(0x1be));function sticker2(_0x3251cf,_0x3dacf0){return new Promise(async(_0x44901b,_0x2f3424)=>{const _0x7f074b=a0_0x1f44;try{if(_0x3dacf0){const _0x286fff=await a0_0x53f6d1(_0x3dacf0);if(_0x286fff['status']!==0xc8)throw await _0x286fff['text']();_0x3251cf=await _0x286fff['buffer']();}const _0x25fa64=a0_0x1a3d80[_0x7f074b(0x1c8)](tmp,+new Date()+'.jpeg');await a0_0x145483[_0x7f074b(0x1e6)][_0x7f074b(0x1e2)](_0x25fa64,_0x3251cf);const _0x26a2b6=spawn(_0x7f074b(0x204),['-y','-i',_0x25fa64,_0x7f074b(0x1bd),_0x7f074b(0x1e1),'-f','png','-']);_0x26a2b6['on'](_0x7f074b(0x1d9),_0x2f3424),_0x26a2b6['on'](_0x7f074b(0x1fc),async()=>{const _0x59e167=_0x7f074b;await a0_0x145483['promises'][_0x59e167(0x1f6)](_0x25fa64);});const _0x343692=[],[_0x341a0a,..._0x5ea6c7]=[...module[_0x7f074b(0x1d7)][_0x7f074b(0x1c9)]['gm']?['gm']:module[_0x7f074b(0x1d7)][_0x7f074b(0x1ea)]?[_0x7f074b(0x1ea)]:[],_0x7f074b(0x1ef),'png:-',_0x7f074b(0x1fb)],_0x5428dc=spawn(_0x341a0a,_0x5ea6c7);_0x5428dc['on']('error',_0x3d2cab=>conn[_0x7f074b(0x1f1)](m[_0x7f074b(0x1e4)],util[_0x7f074b(0x205)](_0x3d2cab),m)),_0x5428dc[_0x7f074b(0x1d2)]['on'](_0x7f074b(0x1f3),_0x56877a=>_0x343692['push'](_0x56877a)),_0x26a2b6[_0x7f074b(0x1d2)][_0x7f074b(0x1c6)](_0x5428dc[_0x7f074b(0x1ca)]),_0x5428dc['on'](_0x7f074b(0x1bb),()=>{_0x44901b(Buffer['concat'](_0x343692));});}catch(_0x1495a5){_0x2f3424(_0x1495a5);}});}async function sticker3(_0x1f2d9a,_0x2a2ba8,_0x146e71,_0x4f1b54){const _0x5ac716=a0_0x180093;_0x2a2ba8=_0x2a2ba8?_0x2a2ba8:await a0_0x33b00a(_0x1f2d9a);const _0x29b4b2=await a0_0x53f6d1(_0x5ac716(0x201)+new URLSearchParams(Object[_0x5ac716(0x203)]({'url':_0x2a2ba8,'packname':_0x146e71,'author':_0x4f1b54})));return await _0x29b4b2['buffer']();}async function sticker4(_0x3f1549,_0x910970){const _0x3eaee3=a0_0x180093;if(_0x910970){const _0x1ff937=await a0_0x53f6d1(_0x910970);if(_0x1ff937['status']!==0xc8)throw await _0x1ff937[_0x3eaee3(0x1ee)]();_0x3f1549=await _0x1ff937[_0x3eaee3(0x1c5)]();}return await ffmpeg(_0x3f1549,[_0x3eaee3(0x1bd),'scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1'],_0x3eaee3(0x1e0),_0x3eaee3(0x202));}async function sticker5(_0x241b8e,_0x7ce305,_0x4ee0de,_0x107e28,_0x55fa38=[''],_0x3fc00a={}){const _0x5e56a1=a0_0x180093,{Sticker:_0x1c00ec}=await import(_0x5e56a1(0x1cf)),_0x382ce6={'type':_0x5e56a1(0x1f9),'pack':_0x4ee0de,'author':_0x107e28,'categories':_0x55fa38,..._0x3fc00a};return new _0x1c00ec(_0x241b8e?_0x241b8e:_0x7ce305,_0x382ce6)[_0x5e56a1(0x1f8)]();}function sticker6(_0x133a91,_0x41dd81){return new Promise(async(_0x62a500,_0x3f8e21)=>{const _0x490e3f=a0_0x1f44;if(_0x41dd81){const _0x50694b=await a0_0x53f6d1(_0x41dd81);if(_0x50694b[_0x490e3f(0x1d4)]!==0xc8)throw await _0x50694b[_0x490e3f(0x1ee)]();_0x133a91=await _0x50694b[_0x490e3f(0x1c5)]();}const _0x444540=await fileTypeFromBuffer(_0x133a91)||{'mime':_0x490e3f(0x1b9),'ext':_0x490e3f(0x206)};if(_0x444540[_0x490e3f(0x1c7)]==_0x490e3f(0x206))_0x3f8e21(_0x133a91);const _0x2e6668=a0_0x1a3d80[_0x490e3f(0x1c8)](__dirname,_0x490e3f(0x1da)+ +new Date()+'.'+_0x444540[_0x490e3f(0x1c7)]),_0x1f0f38=a0_0x1a3d80['join'](_0x2e6668+_0x490e3f(0x1cc));await a0_0x145483['promises'][_0x490e3f(0x1e2)](_0x2e6668,_0x133a91);const _0x5ca53a=/video/i[_0x490e3f(0x1c2)](_0x444540[_0x490e3f(0x1f2)])?a0_0xc6a25e(_0x2e6668)['inputFormat'](_0x444540['ext']):a0_0xc6a25e(_0x2e6668)[_0x490e3f(0x1dc)](_0x2e6668);_0x5ca53a['on'](_0x490e3f(0x1d9),function(_0x174302){const _0x4439e0=_0x490e3f;console['error'](_0x174302),a0_0x145483[_0x4439e0(0x1e6)][_0x4439e0(0x1f6)](_0x2e6668),_0x3f8e21(_0x133a91);})['on'](_0x490e3f(0x1ce),async function(){const _0x322a74=_0x490e3f;a0_0x145483[_0x322a74(0x1e6)][_0x322a74(0x1f6)](_0x2e6668),_0x62a500(await a0_0x145483['promises'][_0x322a74(0x1fd)](_0x1f0f38));})[_0x490e3f(0x1ec)]([_0x490e3f(0x1ed),'libwebp','-vf',_0x490e3f(0x1e5)])[_0x490e3f(0x1c1)](_0x490e3f(0x202))[_0x490e3f(0x1e8)](_0x1f0f38);});}async function addExif(_0x5e0c3b,_0x13dd92,_0x4b4891,_0x1dfc67=[''],_0x4623fd){const _0x48d2d9=a0_0x180093,_0x1e6148=new a0_0x27d932[(_0x48d2d9(0x1d1))](),_0xf84722=_0x48d2d9(0x1f0)+a0_0x5ccd23[_0x48d2d9(0x1eb)](0xc)[_0x48d2d9(0x1f7)](_0x48d2d9(0x1cd))['toUpperCase'](),_0x5a169d={'sticker-pack-id':_0x4623fd[_0x48d2d9(0x1c0)]?_0x4623fd[_0x48d2d9(0x1c0)]:''+_0xf84722,'sticker-pack-name':_0x13dd92?_0x13dd92:undefined,'sticker-pack-publisher':_0x4b4891?_0x4b4891:undefined,'android-app-store-link':_0x4623fd[_0x48d2d9(0x1d3)]?_0x4623fd[_0x48d2d9(0x1d3)]:undefined,'ios-app-store-link':_0x4623fd[_0x48d2d9(0x1de)]?_0x4623fd[_0x48d2d9(0x1de)]:undefined,'is-ai-sticker':_0x4623fd['isAiSticker']?0x1:undefined,'is-first-party-sticker':_0x4623fd[_0x48d2d9(0x1e9)]?0x1:undefined,'accessibility-text':_0x4623fd['accessibilityText']?_0x4623fd['accessibilityText']:undefined,'avatar-sticker-template-id':_0x4623fd[_0x48d2d9(0x1fe)]?_0x4623fd[_0x48d2d9(0x1fe)]:undefined,'is-avatar-sticker':_0x4623fd[_0x48d2d9(0x1f4)]?0x1:undefined,'sticker-maker-source-type':_0x4623fd['stickerMakerSourceType']?_0x4623fd['stickerMakerSourceType']:undefined,'emojis':_0x1dfc67?_0x1dfc67:undefined},_0x15aa84=Buffer[_0x48d2d9(0x1bc)]([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x1da58a=Buffer['from'](JSON['stringify'](_0x5a169d),'utf8'),_0x19a246=Buffer['concat']([_0x15aa84,_0x1da58a]);return _0x19a246[_0x48d2d9(0x1d8)](_0x1da58a[_0x48d2d9(0x1c3)],0xe,0x4),await _0x1e6148[_0x48d2d9(0x1ba)](_0x5e0c3b),_0x1e6148[_0x48d2d9(0x1e3)]=_0x19a246,await _0x1e6148[_0x48d2d9(0x1e8)](null);}async function sticker(_0x4b8c89,_0x2b7214,..._0x11e6e8){const _0x451f6b=a0_0x180093;let _0x35c4a0,_0x1e6a37;for(const _0x4305fb of[sticker3,global['support'][_0x451f6b(0x204)]&&sticker6,sticker5,global[_0x451f6b(0x1c9)][_0x451f6b(0x204)]&&global['support'][_0x451f6b(0x1cb)]&&sticker4,global[_0x451f6b(0x1c9)][_0x451f6b(0x204)]&&(global['support'][_0x451f6b(0x1ef)]||global['support'][_0x451f6b(0x1ea)]||global[_0x451f6b(0x1c9)]['gm'])&&sticker2]['filter'](_0xcca450=>_0xcca450)){try{_0x1e6a37=await _0x4305fb(_0x4b8c89,_0x2b7214,..._0x11e6e8);if(_0x1e6a37[_0x451f6b(0x1df)](_0x451f6b(0x1d0)))continue;if(_0x1e6a37['includes'](_0x451f6b(0x1dd)))try{return await addExif(_0x1e6a37,..._0x11e6e8);}catch(_0x1137f4){return console[_0x451f6b(0x1d9)](_0x1137f4),_0x1e6a37;}throw _0x1e6a37[_0x451f6b(0x1f7)]();}catch(_0x24f310){_0x35c4a0=_0x24f310;continue;}}return console[_0x451f6b(0x1d9)](_0x35c4a0),_0x35c4a0;}const support={'ffmpeg':!![],'ffprobe':!![],'ffmpegWebp':!![],'convert':!![],'magick':![],'gm':![],'find':![]};export{sticker,sticker2,sticker3,sticker4,sticker6,addExif,support};