const a0_0x25777d=a0_0x4c1a;(function(_0x4bf206,_0x45ff78){const _0x5eae2f=a0_0x4c1a,_0x34946b=_0x4bf206();while(!![]){try{const _0x109aa4=parseInt(_0x5eae2f(0xc3))/0x1*(parseInt(_0x5eae2f(0xbc))/0x2)+parseInt(_0x5eae2f(0x85))/0x3+-parseInt(_0x5eae2f(0xa7))/0x4+-parseInt(_0x5eae2f(0xc1))/0x5+parseInt(_0x5eae2f(0xb6))/0x6+-parseInt(_0x5eae2f(0x87))/0x7+parseInt(_0x5eae2f(0x8b))/0x8;if(_0x109aa4===_0x45ff78)break;else _0x34946b['push'](_0x34946b['shift']());}catch(_0xd03625){_0x34946b['push'](_0x34946b['shift']());}}}(a0_0x1355,0xa575b));import{dirname}from'path';import{fileURLToPath}from'url';import*as a0_0x38eb14 from'fs';function a0_0x4c1a(_0x412f8a,_0x43fb57){const _0x135567=a0_0x1355();return a0_0x4c1a=function(_0x4c1aa1,_0x9d0e29){_0x4c1aa1=_0x4c1aa1-0x7a;let _0x30de23=_0x135567[_0x4c1aa1];return _0x30de23;},a0_0x4c1a(_0x412f8a,_0x43fb57);}import*as a0_0x3d01cc from'path';import*as a0_0x41e29b from'crypto';import{ffmpeg}from'./converter.js';import a0_0x59a5b5 from'fluent-ffmpeg';import{spawn}from'child_process';import a0_0x31daf6 from'./uploadFile.js';import a0_0x144e31 from'./uploadImage.js';import{fileTypeFromBuffer}from'file-type';import a0_0x5b53e2 from'node-webpmux';import a0_0x524017 from'node-fetch';const __dirname=dirname(fileURLToPath(import.meta['url'])),tmp=a0_0x3d01cc[a0_0x25777d(0xc6)](__dirname,a0_0x25777d(0xa5));function sticker2(_0x1c8c58,_0x477cb0){return new Promise(async(_0x55bff7,_0x4d8b5d)=>{const _0x320f4d=a0_0x4c1a;try{if(_0x477cb0){const _0x91d4f2=await a0_0x524017(_0x477cb0);if(_0x91d4f2[_0x320f4d(0xaf)]!==0xc8)throw await _0x91d4f2[_0x320f4d(0xba)]();_0x1c8c58=await _0x91d4f2[_0x320f4d(0x84)]();}const _0x1f78ec=a0_0x3d01cc['join'](tmp,+new Date()+_0x320f4d(0x92));await a0_0x38eb14[_0x320f4d(0xb7)]['writeFile'](_0x1f78ec,_0x1c8c58);const _0x29f5d3=spawn(_0x320f4d(0x99),['-y','-i',_0x1f78ec,_0x320f4d(0xa2),'scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','-f',_0x320f4d(0xc5),'-']);_0x29f5d3['on'](_0x320f4d(0x7c),_0x4d8b5d),_0x29f5d3['on'](_0x320f4d(0x97),async()=>{const _0x53519c=_0x320f4d;await a0_0x38eb14[_0x53519c(0xb7)][_0x53519c(0xa3)](_0x1f78ec);});const _0x28892f=[],[_0x505df5,..._0x162020]=[...module[_0x320f4d(0x94)][_0x320f4d(0xae)]['gm']?['gm']:module[_0x320f4d(0x94)][_0x320f4d(0x8a)]?['magick']:[],'convert',_0x320f4d(0x8d),_0x320f4d(0xa8)],_0x5b839f=spawn(_0x505df5,_0x162020);_0x5b839f['on'](_0x320f4d(0x7c),_0x5b8cf0=>conn[_0x320f4d(0xc0)](m['chat'],util[_0x320f4d(0xb1)](_0x5b8cf0),m)),_0x5b839f['stdout']['on'](_0x320f4d(0xa6),_0x54a410=>_0x28892f[_0x320f4d(0xa9)](_0x54a410)),_0x29f5d3[_0x320f4d(0xb9)][_0x320f4d(0x9c)](_0x5b839f['stdin']),_0x5b839f['on'](_0x320f4d(0xa1),()=>{const _0x3a7ffa=_0x320f4d;_0x55bff7(Buffer[_0x3a7ffa(0x7e)](_0x28892f));});}catch(_0xd46376){_0x4d8b5d(_0xd46376);}});}async function sticker3(_0x29c1db,_0x24399a,_0x404b70,_0x308f04){const _0x3fac69=a0_0x25777d;_0x24399a=_0x24399a?_0x24399a:await a0_0x31daf6(_0x29c1db);const _0x36002b=await a0_0x524017(_0x3fac69(0xb0)+new URLSearchParams(Object[_0x3fac69(0xb8)]({'url':_0x24399a,'packname':_0x404b70,'author':_0x308f04})));return await _0x36002b[_0x3fac69(0x84)]();}async function sticker4(_0x5da97b,_0x59c291){const _0x249e9e=a0_0x25777d;if(_0x59c291){const _0x77bcc9=await a0_0x524017(_0x59c291);if(_0x77bcc9[_0x249e9e(0xaf)]!==0xc8)throw await _0x77bcc9[_0x249e9e(0xba)]();_0x5da97b=await _0x77bcc9[_0x249e9e(0x84)]();}return await ffmpeg(_0x5da97b,[_0x249e9e(0xa2),_0x249e9e(0xb2)],_0x249e9e(0xac),_0x249e9e(0xb3));}async function sticker5(_0x20ae23,_0x1f7ad3,_0xc6f723,_0x867aa,_0x21b267=[''],_0xfe8ca2={}){const _0x70094d=a0_0x25777d,{Sticker:_0x3d783c}=await import(_0x70094d(0x8f)),_0x1ff375={'type':'default','pack':_0xc6f723,'author':_0x867aa,'categories':_0x21b267,..._0xfe8ca2};return new _0x3d783c(_0x20ae23?_0x20ae23:_0x1f7ad3,_0x1ff375)[_0x70094d(0xaa)]();}function sticker6(_0x46efe7,_0x3a1d01){return new Promise(async(_0x42e600,_0x59b754)=>{const _0x3da427=a0_0x4c1a;if(_0x3a1d01){const _0x503c14=await a0_0x524017(_0x3a1d01);if(_0x503c14['status']!==0xc8)throw await _0x503c14[_0x3da427(0xba)]();_0x46efe7=await _0x503c14[_0x3da427(0x84)]();}const _0x19a5ca=await fileTypeFromBuffer(_0x46efe7)||{'mime':'application/octet-stream','ext':_0x3da427(0xc2)};if(_0x19a5ca[_0x3da427(0x9a)]==_0x3da427(0xc2))_0x59b754(_0x46efe7);const _0x6be1b1=a0_0x3d01cc[_0x3da427(0xc6)](__dirname,_0x3da427(0xab)+ +new Date()+'.'+_0x19a5ca[_0x3da427(0x9a)]),_0x4b362e=a0_0x3d01cc[_0x3da427(0xc6)](_0x6be1b1+'.webp');await a0_0x38eb14['promises'][_0x3da427(0xbe)](_0x6be1b1,_0x46efe7);const _0x54b48b=/video/i[_0x3da427(0x90)](_0x19a5ca[_0x3da427(0x7b)])?a0_0x59a5b5(_0x6be1b1)[_0x3da427(0xb5)](_0x19a5ca[_0x3da427(0x9a)]):a0_0x59a5b5(_0x6be1b1)[_0x3da427(0x8c)](_0x6be1b1);_0x54b48b['on'](_0x3da427(0x7c),function(_0x148cef){const _0x5c7c7b=_0x3da427;console[_0x5c7c7b(0x7c)](_0x148cef),a0_0x38eb14[_0x5c7c7b(0xb7)][_0x5c7c7b(0xa3)](_0x6be1b1),_0x59b754(_0x46efe7);})['on'](_0x3da427(0xbf),async function(){const _0x5edde0=_0x3da427;a0_0x38eb14[_0x5edde0(0xb7)]['unlink'](_0x6be1b1),_0x42e600(await a0_0x38eb14[_0x5edde0(0xb7)]['readFile'](_0x4b362e));})['addOutputOptions']([_0x3da427(0xa0),_0x3da427(0x7d),_0x3da427(0xa2),_0x3da427(0x9e)])[_0x3da427(0x98)](_0x3da427(0xb3))['save'](_0x4b362e);});}async function addExif(_0xcd056e,_0x35d61b,_0x3c782e,_0xc082d2=[''],_0x378f0c){const _0x4878c0=a0_0x25777d,_0x369ab6=new a0_0x5b53e2[(_0x4878c0(0x9d))](),_0x2b848c=_0x4878c0(0xb4)+a0_0x41e29b[_0x4878c0(0x9b)](0xc)[_0x4878c0(0xbd)](_0x4878c0(0x81))['toUpperCase'](),_0x35b34a={'sticker-pack-id':_0x378f0c[_0x4878c0(0x93)]?_0x378f0c[_0x4878c0(0x93)]:''+_0x2b848c,'sticker-pack-name':_0x35d61b?_0x35d61b:undefined,'sticker-pack-publisher':_0x3c782e?_0x3c782e:undefined,'android-app-store-link':_0x378f0c[_0x4878c0(0x8e)]?_0x378f0c[_0x4878c0(0x8e)]:undefined,'ios-app-store-link':_0x378f0c[_0x4878c0(0x9f)]?_0x378f0c[_0x4878c0(0x9f)]:undefined,'is-ai-sticker':_0x378f0c[_0x4878c0(0x96)]?0x1:undefined,'is-first-party-sticker':_0x378f0c[_0x4878c0(0x83)]?0x1:undefined,'accessibility-text':_0x378f0c[_0x4878c0(0x7f)]?_0x378f0c[_0x4878c0(0x7f)]:undefined,'avatar-sticker-template-id':_0x378f0c['templateId']?_0x378f0c['templateId']:undefined,'is-avatar-sticker':_0x378f0c[_0x4878c0(0x80)]?0x1:undefined,'sticker-maker-source-type':_0x378f0c['stickerMakerSourceType']?_0x378f0c[_0x4878c0(0x88)]:undefined,'emojis':_0xc082d2?_0xc082d2:undefined},_0x2c4fce=Buffer['from']([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x19bba8=Buffer['from'](JSON['stringify'](_0x35b34a),_0x4878c0(0xa4)),_0x4da2d8=Buffer[_0x4878c0(0x7e)]([_0x2c4fce,_0x19bba8]);return _0x4da2d8[_0x4878c0(0x86)](_0x19bba8[_0x4878c0(0x7a)],0xe,0x4),await _0x369ab6[_0x4878c0(0xc4)](_0xcd056e),_0x369ab6[_0x4878c0(0x82)]=_0x4da2d8,await _0x369ab6[_0x4878c0(0xad)](null);}async function sticker(_0x2aad86,_0x18ae76,..._0x301f78){const _0x3b54f1=a0_0x25777d;let _0x28ff3c,_0x5650e5;for(const _0x5cc858 of[sticker3,global[_0x3b54f1(0xae)][_0x3b54f1(0x99)]&&sticker6,sticker5,global['support'][_0x3b54f1(0x99)]&&global[_0x3b54f1(0xae)]['ffmpegWebp']&&sticker4,global[_0x3b54f1(0xae)][_0x3b54f1(0x99)]&&(global['support'][_0x3b54f1(0x89)]||global[_0x3b54f1(0xae)][_0x3b54f1(0x8a)]||global[_0x3b54f1(0xae)]['gm'])&&sticker2][_0x3b54f1(0xbb)](_0x4dee85=>_0x4dee85)){try{_0x5650e5=await _0x5cc858(_0x2aad86,_0x18ae76,..._0x301f78);if(_0x5650e5[_0x3b54f1(0x95)]('html'))continue;if(_0x5650e5[_0x3b54f1(0x95)](_0x3b54f1(0x91)))try{return await addExif(_0x5650e5,..._0x301f78);}catch(_0x27aa8c){return console[_0x3b54f1(0x7c)](_0x27aa8c),_0x5650e5;}throw _0x5650e5[_0x3b54f1(0xbd)]();}catch(_0x4345d0){_0x28ff3c=_0x4345d0;continue;}}return console['error'](_0x28ff3c),_0x28ff3c;}const support={'ffmpeg':!![],'ffprobe':!![],'ffmpegWebp':!![],'convert':!![],'magick':![],'gm':![],'find':![]};function a0_0x1355(){const _0x4eee32=['wa-sticker-formatter','test','WEBP','.jpeg','packId','exports','includes','isAiSticker','close','toFormat','ffmpeg','ext','randomBytes','pipe','Image','scale=\x27min(320,iw)\x27:min\x27(320,ih)\x27:force_original_aspect_ratio=decrease,fps=15,\x20pad=320:320:-1:-1:color=white@0.0,\x20split\x20[a][b];\x20[a]\x20palettegen=reserve_transparent=on:transparency_color=ffffff\x20[p];\x20[b][p]\x20paletteuse','iosAppStoreLink','-vcodec','exit','-vf','unlink','utf8','../tmp','data','3585476wZocbc','webp:-','push','toBuffer','../tmp/','jpeg','save','support','status','https://api.xteam.xyz/sticker/wm?','format','scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','webp','MYSTIC','inputFormat','1320078qSftQT','promises','entries','stdout','text','filter','6FMoTDA','toString','writeFile','end','reply','2381080JCRZLt','bin','324395AgLWGV','load','png','join','length','mime','error','libwebp','concat','accessibilityText','isAvatarSticker','hex','exif','isFirstPartySticker','buffer','238626xwIYKw','writeUIntLE','588658hLjnDO','stickerMakerSourceType','convert','magick','6893296raObWt','input','png:-','androidAppStoreLink'];a0_0x1355=function(){return _0x4eee32;};return a0_0x1355();}export{sticker,sticker2,sticker3,sticker4,sticker6,addExif,support};