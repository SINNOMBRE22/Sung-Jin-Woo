const a0_0x9d2c83=a0_0x5a9c;(function(_0x476410,_0x3977dc){const _0x22aca3=a0_0x5a9c,_0xb75934=_0x476410();while(!![]){try{const _0x15a49a=parseInt(_0x22aca3(0x13c))/0x1*(-parseInt(_0x22aca3(0x116))/0x2)+-parseInt(_0x22aca3(0x146))/0x3+-parseInt(_0x22aca3(0x11d))/0x4*(-parseInt(_0x22aca3(0x124))/0x5)+parseInt(_0x22aca3(0x149))/0x6+parseInt(_0x22aca3(0x153))/0x7*(parseInt(_0x22aca3(0x145))/0x8)+parseInt(_0x22aca3(0x117))/0x9+-parseInt(_0x22aca3(0x133))/0xa;if(_0x15a49a===_0x3977dc)break;else _0xb75934['push'](_0xb75934['shift']());}catch(_0x122421){_0xb75934['push'](_0xb75934['shift']());}}}(a0_0x41da,0x4e6ba));import{dirname}from'path';import{fileURLToPath}from'url';import*as a0_0x542a9f from'fs';import*as a0_0x28f0b5 from'path';import*as a0_0x3383c5 from'crypto';import{ffmpeg}from'./converter.js';import a0_0x3ac0fe from'fluent-ffmpeg';import{spawn}from'child_process';import a0_0x21da99 from'./uploadFile.js';import a0_0x4e23a6 from'./uploadImage.js';import{fileTypeFromBuffer}from'file-type';import a0_0x305d79 from'node-webpmux';import a0_0x46ee58 from'node-fetch';const __dirname=dirname(fileURLToPath(import.meta['url'])),tmp=a0_0x28f0b5[a0_0x9d2c83(0x14b)](__dirname,a0_0x9d2c83(0x150));function a0_0x41da(){const _0x5d75ef=['entries','iosAppStoreLink','scale=\x27min(320,iw)\x27:min\x27(320,ih)\x27:force_original_aspect_ratio=decrease,fps=15,\x20pad=320:320:-1:-1:color=white@0.0,\x20split\x20[a][b];\x20[a]\x20palettegen=reserve_transparent=on:transparency_color=ffffff\x20[p];\x20[b][p]\x20paletteuse','ffmpegWebp','5519480MFNcfK','promises','packId','filter','exports','concat','wa-sticker-formatter','status','format','352635gTNPBg','mime','-vcodec','support','writeUIntLE','webp:-','isAiSticker','toUpperCase','stickerMakerSourceType','428304LFsOxd','1239204BYGwLI','includes','inputFormat','2077122sYmtQJ','utf8','join','stdout','data','application/octet-stream','scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','../tmp','writeFile','bin','63hzROyT','html','../tmp/','exit','buffer','accessibilityText','chat','save','default','text','readFile','webp','MYSTIC','ffmpeg','WEBP','2EhbxKF','3318327eudcsu','unlink','convert','ext','end','https://api.xteam.xyz/sticker/wm?','76892VtXaUP','hex','randomBytes','androidAppStoreLink','close','.jpeg','length','115iWEmFW','jpeg','toBuffer','Image','png:-','error','toString','-vf','from','templateId','magick'];a0_0x41da=function(){return _0x5d75ef;};return a0_0x41da();}function sticker2(_0xf12f81,_0x5cee1a){return new Promise(async(_0x2498f5,_0x13b4b7)=>{const _0xe1c798=a0_0x5a9c;try{if(_0x5cee1a){const _0x85c0ee=await a0_0x46ee58(_0x5cee1a);if(_0x85c0ee[_0xe1c798(0x13a)]!==0xc8)throw await _0x85c0ee['text']();_0xf12f81=await _0x85c0ee[_0xe1c798(0x157)]();}const _0xd44502=a0_0x28f0b5[_0xe1c798(0x14b)](tmp,+new Date()+_0xe1c798(0x122));await a0_0x542a9f[_0xe1c798(0x134)][_0xe1c798(0x151)](_0xd44502,_0xf12f81);const _0x16cb4e=spawn(_0xe1c798(0x114),['-y','-i',_0xd44502,_0xe1c798(0x12b),'scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','-f','png','-']);_0x16cb4e['on'](_0xe1c798(0x129),_0x13b4b7),_0x16cb4e['on'](_0xe1c798(0x121),async()=>{const _0x14ef1d=_0xe1c798;await a0_0x542a9f[_0x14ef1d(0x134)][_0x14ef1d(0x118)](_0xd44502);});const _0x5052be=[],[_0x214151,..._0xf8992b]=[...module[_0xe1c798(0x137)][_0xe1c798(0x13f)]['gm']?['gm']:module['exports'][_0xe1c798(0x12e)]?[_0xe1c798(0x12e)]:[],_0xe1c798(0x119),_0xe1c798(0x128),_0xe1c798(0x141)],_0x1d50b4=spawn(_0x214151,_0xf8992b);_0x1d50b4['on']('error',_0x138194=>conn['reply'](m[_0xe1c798(0x10d)],util[_0xe1c798(0x13b)](_0x138194),m)),_0x1d50b4[_0xe1c798(0x14c)]['on'](_0xe1c798(0x14d),_0x345662=>_0x5052be['push'](_0x345662)),_0x16cb4e[_0xe1c798(0x14c)]['pipe'](_0x1d50b4['stdin']),_0x1d50b4['on'](_0xe1c798(0x156),()=>{const _0x294c8a=_0xe1c798;_0x2498f5(Buffer[_0x294c8a(0x138)](_0x5052be));});}catch(_0x32aa29){_0x13b4b7(_0x32aa29);}});}async function sticker3(_0x479a7b,_0x3716fc,_0x57c0ba,_0x496ed9){const _0x14035d=a0_0x9d2c83;_0x3716fc=_0x3716fc?_0x3716fc:await a0_0x21da99(_0x479a7b);const _0x5eaf7b=await a0_0x46ee58(_0x14035d(0x11c)+new URLSearchParams(Object[_0x14035d(0x12f)]({'url':_0x3716fc,'packname':_0x57c0ba,'author':_0x496ed9})));return await _0x5eaf7b[_0x14035d(0x157)]();}async function sticker4(_0x436ad9,_0x499bcc){const _0x1e1e6d=a0_0x9d2c83;if(_0x499bcc){const _0x260199=await a0_0x46ee58(_0x499bcc);if(_0x260199[_0x1e1e6d(0x13a)]!==0xc8)throw await _0x260199['text']();_0x436ad9=await _0x260199[_0x1e1e6d(0x157)]();}return await ffmpeg(_0x436ad9,[_0x1e1e6d(0x12b),_0x1e1e6d(0x14f)],_0x1e1e6d(0x125),_0x1e1e6d(0x112));}async function sticker5(_0x105c67,_0x319ce8,_0x75faed,_0x23e950,_0x2a36ff=[''],_0xb331d0={}){const _0x492b19=a0_0x9d2c83,{Sticker:_0x5dc6de}=await import(_0x492b19(0x139)),_0x587fec={'type':_0x492b19(0x10f),'pack':_0x75faed,'author':_0x23e950,'categories':_0x2a36ff,..._0xb331d0};return new _0x5dc6de(_0x105c67?_0x105c67:_0x319ce8,_0x587fec)[_0x492b19(0x126)]();}function sticker6(_0x34cc95,_0x56c485){return new Promise(async(_0x300948,_0x9c3be9)=>{const _0x6188c9=a0_0x5a9c;if(_0x56c485){const _0x5cfad4=await a0_0x46ee58(_0x56c485);if(_0x5cfad4[_0x6188c9(0x13a)]!==0xc8)throw await _0x5cfad4[_0x6188c9(0x110)]();_0x34cc95=await _0x5cfad4[_0x6188c9(0x157)]();}const _0x15c51a=await fileTypeFromBuffer(_0x34cc95)||{'mime':_0x6188c9(0x14e),'ext':_0x6188c9(0x152)};if(_0x15c51a[_0x6188c9(0x11a)]=='bin')_0x9c3be9(_0x34cc95);const _0x528687=a0_0x28f0b5['join'](__dirname,_0x6188c9(0x155)+ +new Date()+'.'+_0x15c51a[_0x6188c9(0x11a)]),_0x5022d1=a0_0x28f0b5[_0x6188c9(0x14b)](_0x528687+'.webp');await a0_0x542a9f[_0x6188c9(0x134)][_0x6188c9(0x151)](_0x528687,_0x34cc95);const _0x1f8454=/video/i['test'](_0x15c51a[_0x6188c9(0x13d)])?a0_0x3ac0fe(_0x528687)[_0x6188c9(0x148)](_0x15c51a[_0x6188c9(0x11a)]):a0_0x3ac0fe(_0x528687)['input'](_0x528687);_0x1f8454['on'](_0x6188c9(0x129),function(_0x3a9aa2){const _0x3a4783=_0x6188c9;console[_0x3a4783(0x129)](_0x3a9aa2),a0_0x542a9f['promises'][_0x3a4783(0x118)](_0x528687),_0x9c3be9(_0x34cc95);})['on'](_0x6188c9(0x11b),async function(){const _0x1bae90=_0x6188c9;a0_0x542a9f[_0x1bae90(0x134)]['unlink'](_0x528687),_0x300948(await a0_0x542a9f[_0x1bae90(0x134)][_0x1bae90(0x111)](_0x5022d1));})['addOutputOptions']([_0x6188c9(0x13e),'libwebp',_0x6188c9(0x12b),_0x6188c9(0x131)])['toFormat'](_0x6188c9(0x112))[_0x6188c9(0x10e)](_0x5022d1);});}async function addExif(_0x773295,_0x33264b,_0x4113c1,_0x2ecc85=[''],_0x24ac8f){const _0x4f3a3f=a0_0x9d2c83,_0x325b76=new a0_0x305d79[(_0x4f3a3f(0x127))](),_0x3d264a=_0x4f3a3f(0x113)+a0_0x3383c5[_0x4f3a3f(0x11f)](0xc)[_0x4f3a3f(0x12a)](_0x4f3a3f(0x11e))[_0x4f3a3f(0x143)](),_0x495f72={'sticker-pack-id':_0x24ac8f[_0x4f3a3f(0x135)]?_0x24ac8f['packId']:''+_0x3d264a,'sticker-pack-name':_0x33264b?_0x33264b:undefined,'sticker-pack-publisher':_0x4113c1?_0x4113c1:undefined,'android-app-store-link':_0x24ac8f[_0x4f3a3f(0x120)]?_0x24ac8f['androidAppStoreLink']:undefined,'ios-app-store-link':_0x24ac8f[_0x4f3a3f(0x130)]?_0x24ac8f['iosAppStoreLink']:undefined,'is-ai-sticker':_0x24ac8f[_0x4f3a3f(0x142)]?0x1:undefined,'is-first-party-sticker':_0x24ac8f['isFirstPartySticker']?0x1:undefined,'accessibility-text':_0x24ac8f[_0x4f3a3f(0x10c)]?_0x24ac8f[_0x4f3a3f(0x10c)]:undefined,'avatar-sticker-template-id':_0x24ac8f['templateId']?_0x24ac8f[_0x4f3a3f(0x12d)]:undefined,'is-avatar-sticker':_0x24ac8f['isAvatarSticker']?0x1:undefined,'sticker-maker-source-type':_0x24ac8f[_0x4f3a3f(0x144)]?_0x24ac8f[_0x4f3a3f(0x144)]:undefined,'emojis':_0x2ecc85?_0x2ecc85:undefined},_0x4065d7=Buffer[_0x4f3a3f(0x12c)]([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x53e7bd=Buffer[_0x4f3a3f(0x12c)](JSON['stringify'](_0x495f72),_0x4f3a3f(0x14a)),_0xcd37b6=Buffer['concat']([_0x4065d7,_0x53e7bd]);return _0xcd37b6[_0x4f3a3f(0x140)](_0x53e7bd[_0x4f3a3f(0x123)],0xe,0x4),await _0x325b76['load'](_0x773295),_0x325b76['exif']=_0xcd37b6,await _0x325b76['save'](null);}async function sticker(_0x309197,_0x13ff4e,..._0x34714f){const _0x3474ae=a0_0x9d2c83;let _0x5c0de7,_0xa38e3b;for(const _0x1fdddf of[sticker3,global['support'][_0x3474ae(0x114)]&&sticker6,sticker5,global[_0x3474ae(0x13f)]['ffmpeg']&&global['support'][_0x3474ae(0x132)]&&sticker4,global[_0x3474ae(0x13f)][_0x3474ae(0x114)]&&(global['support'][_0x3474ae(0x119)]||global[_0x3474ae(0x13f)][_0x3474ae(0x12e)]||global[_0x3474ae(0x13f)]['gm'])&&sticker2][_0x3474ae(0x136)](_0x4985ea=>_0x4985ea)){try{_0xa38e3b=await _0x1fdddf(_0x309197,_0x13ff4e,..._0x34714f);if(_0xa38e3b[_0x3474ae(0x147)](_0x3474ae(0x154)))continue;if(_0xa38e3b['includes'](_0x3474ae(0x115)))try{return await addExif(_0xa38e3b,..._0x34714f);}catch(_0x162c27){return console[_0x3474ae(0x129)](_0x162c27),_0xa38e3b;}throw _0xa38e3b['toString']();}catch(_0xa7c9ef){_0x5c0de7=_0xa7c9ef;continue;}}return console[_0x3474ae(0x129)](_0x5c0de7),_0x5c0de7;}const support={'ffmpeg':!![],'ffprobe':!![],'ffmpegWebp':!![],'convert':!![],'magick':![],'gm':![],'find':![]};function a0_0x5a9c(_0x468230,_0x16f2be){const _0x41da98=a0_0x41da();return a0_0x5a9c=function(_0x5a9c80,_0x3b0473){_0x5a9c80=_0x5a9c80-0x10c;let _0x555b65=_0x41da98[_0x5a9c80];return _0x555b65;},a0_0x5a9c(_0x468230,_0x16f2be);}export{sticker,sticker2,sticker3,sticker4,sticker6,addExif,support};