const a0_0x33993c=a0_0x524d;(function(_0x58931a,_0x973ff6){const _0x45d7de=a0_0x524d,_0x4de0e1=_0x58931a();while(!![]){try{const _0xa0bbaf=parseInt(_0x45d7de(0x21a))/0x1*(-parseInt(_0x45d7de(0x208))/0x2)+parseInt(_0x45d7de(0x1eb))/0x3+parseInt(_0x45d7de(0x20a))/0x4+parseInt(_0x45d7de(0x22a))/0x5*(parseInt(_0x45d7de(0x1ed))/0x6)+parseInt(_0x45d7de(0x20d))/0x7*(parseInt(_0x45d7de(0x1d9))/0x8)+parseInt(_0x45d7de(0x229))/0x9+-parseInt(_0x45d7de(0x1ee))/0xa;if(_0xa0bbaf===_0x973ff6)break;else _0x4de0e1['push'](_0x4de0e1['shift']());}catch(_0x5e2fbe){_0x4de0e1['push'](_0x4de0e1['shift']());}}}(a0_0x33b3,0x9d315));import{dirname}from'path';import{fileURLToPath}from'url';import*as a0_0x30e193 from'fs';import*as a0_0x4f8b7a from'path';import*as a0_0x4eab70 from'crypto';import{ffmpeg}from'./converter.js';import a0_0x48048b from'fluent-ffmpeg';import{spawn}from'child_process';import a0_0x341739 from'./uploadFile.js';import a0_0x528667 from'./uploadImage.js';import{fileTypeFromBuffer}from'file-type';import a0_0x22e237 from'node-webpmux';import a0_0x5253f6 from'node-fetch';const __dirname=dirname(fileURLToPath(import.meta[a0_0x33993c(0x215)])),tmp=a0_0x4f8b7a[a0_0x33993c(0x217)](__dirname,a0_0x33993c(0x21c));function sticker2(_0x154220,_0x5e7791){return new Promise(async(_0xa29e91,_0x29e3be)=>{const _0x3e6154=a0_0x524d;try{if(_0x5e7791){const _0x6c9aab=await a0_0x5253f6(_0x5e7791);if(_0x6c9aab[_0x3e6154(0x201)]!==0xc8)throw await _0x6c9aab[_0x3e6154(0x209)]();_0x154220=await _0x6c9aab['buffer']();}const _0x5c9588=a0_0x4f8b7a[_0x3e6154(0x217)](tmp,+new Date()+_0x3e6154(0x221));await a0_0x30e193[_0x3e6154(0x1de)][_0x3e6154(0x21f)](_0x5c9588,_0x154220);const _0x279a85=spawn(_0x3e6154(0x1fa),['-y','-i',_0x5c9588,_0x3e6154(0x1e4),_0x3e6154(0x1f5),'-f',_0x3e6154(0x207),'-']);_0x279a85['on'](_0x3e6154(0x1df),_0x29e3be),_0x279a85['on'](_0x3e6154(0x1fb),async()=>{const _0x4b4955=_0x3e6154;await a0_0x30e193['promises'][_0x4b4955(0x1e9)](_0x5c9588);});const _0x64664e=[],[_0x10d157,..._0x289f3c]=[...module[_0x3e6154(0x1fc)]['support']['gm']?['gm']:module[_0x3e6154(0x1fc)][_0x3e6154(0x1f2)]?[_0x3e6154(0x1f2)]:[],_0x3e6154(0x1d8),_0x3e6154(0x213),'webp:-'],_0x571884=spawn(_0x10d157,_0x289f3c);_0x571884['on']('error',_0x224479=>conn[_0x3e6154(0x20c)](m[_0x3e6154(0x1f9)],util[_0x3e6154(0x1ef)](_0x224479),m)),_0x571884[_0x3e6154(0x210)]['on'](_0x3e6154(0x1f4),_0x375af0=>_0x64664e[_0x3e6154(0x22b)](_0x375af0)),_0x279a85[_0x3e6154(0x210)]['pipe'](_0x571884[_0x3e6154(0x1f8)]),_0x571884['on'](_0x3e6154(0x1ff),()=>{const _0x15310c=_0x3e6154;_0xa29e91(Buffer[_0x15310c(0x1e6)](_0x64664e));});}catch(_0x2a0df8){_0x29e3be(_0x2a0df8);}});}async function sticker3(_0xc3ea1c,_0x1f4607,_0x1d1d5f,_0x42875d){const _0x21c8b0=a0_0x33993c;_0x1f4607=_0x1f4607?_0x1f4607:await a0_0x341739(_0xc3ea1c);const _0x90cdd0=await a0_0x5253f6(_0x21c8b0(0x1d4)+new URLSearchParams(Object[_0x21c8b0(0x1dd)]({'url':_0x1f4607,'packname':_0x1d1d5f,'author':_0x42875d})));return await _0x90cdd0[_0x21c8b0(0x1e8)]();}async function sticker4(_0x3d6cc1,_0x2e9741){const _0x3bfa15=a0_0x33993c;if(_0x2e9741){const _0x126734=await a0_0x5253f6(_0x2e9741);if(_0x126734[_0x3bfa15(0x201)]!==0xc8)throw await _0x126734[_0x3bfa15(0x209)]();_0x3d6cc1=await _0x126734['buffer']();}return await ffmpeg(_0x3d6cc1,[_0x3bfa15(0x1e4),_0x3bfa15(0x1f5)],_0x3bfa15(0x206),_0x3bfa15(0x21b));}function a0_0x524d(_0x509943,_0x106d38){const _0x33b305=a0_0x33b3();return a0_0x524d=function(_0x524d35,_0x3e1012){_0x524d35=_0x524d35-0x1d4;let _0x23b9ad=_0x33b305[_0x524d35];return _0x23b9ad;},a0_0x524d(_0x509943,_0x106d38);}async function sticker5(_0x2046e1,_0x47439d,_0x29ad70,_0x15b383,_0x54498b=[''],_0x572f4d={}){const _0x3d7468=a0_0x33993c,{Sticker:_0x2f1e2e}=await import(_0x3d7468(0x1d6)),_0x3e23db={'type':_0x3d7468(0x1db),'pack':_0x29ad70,'author':_0x15b383,'categories':_0x54498b,..._0x572f4d};return new _0x2f1e2e(_0x2046e1?_0x2046e1:_0x47439d,_0x3e23db)[_0x3d7468(0x228)]();}function sticker6(_0x3eda58,_0x4d84a1){return new Promise(async(_0x273a95,_0x2fc488)=>{const _0x6404b5=a0_0x524d;if(_0x4d84a1){const _0x15a083=await a0_0x5253f6(_0x4d84a1);if(_0x15a083['status']!==0xc8)throw await _0x15a083[_0x6404b5(0x209)]();_0x3eda58=await _0x15a083[_0x6404b5(0x1e8)]();}const _0x30992c=await fileTypeFromBuffer(_0x3eda58)||{'mime':_0x6404b5(0x225),'ext':_0x6404b5(0x1e1)};if(_0x30992c[_0x6404b5(0x205)]=='bin')_0x2fc488(_0x3eda58);const _0x4400f2=a0_0x4f8b7a[_0x6404b5(0x217)](__dirname,_0x6404b5(0x216)+ +new Date()+'.'+_0x30992c[_0x6404b5(0x205)]),_0x5eec3b=a0_0x4f8b7a[_0x6404b5(0x217)](_0x4400f2+'.webp');await a0_0x30e193['promises']['writeFile'](_0x4400f2,_0x3eda58);const _0x421788=/video/i[_0x6404b5(0x20e)](_0x30992c[_0x6404b5(0x1e3)])?a0_0x48048b(_0x4400f2)[_0x6404b5(0x214)](_0x30992c[_0x6404b5(0x205)]):a0_0x48048b(_0x4400f2)[_0x6404b5(0x1e0)](_0x4400f2);_0x421788['on'](_0x6404b5(0x1df),function(_0x567ed7){const _0x3a1b2e=_0x6404b5;console['error'](_0x567ed7),a0_0x30e193[_0x3a1b2e(0x1de)][_0x3a1b2e(0x1e9)](_0x4400f2),_0x2fc488(_0x3eda58);})['on'](_0x6404b5(0x218),async function(){const _0x21b0d4=_0x6404b5;a0_0x30e193['promises'][_0x21b0d4(0x1e9)](_0x4400f2),_0x273a95(await a0_0x30e193[_0x21b0d4(0x1de)][_0x21b0d4(0x226)](_0x5eec3b));})[_0x6404b5(0x1e2)]([_0x6404b5(0x211),'libwebp',_0x6404b5(0x1e4),_0x6404b5(0x224)])[_0x6404b5(0x220)](_0x6404b5(0x21b))[_0x6404b5(0x1e7)](_0x5eec3b);});}function a0_0x33b3(){const _0x3349ca=['mime','-vf','stringify','concat','save','buffer','unlink','html','2004696HAhdWK','load','54Hcmvsx','22317180rRDYTn','format','isAiSticker','support','magick','exif','data','scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','iosAppStoreLink','hex','stdin','chat','ffmpeg','close','exports','stickerMakerSourceType','length','exit','isAvatarSticker','status','filter','isFirstPartySticker','WEBP','ext','jpeg','png','2074OcQkBB','text','1339524ZruDYJ','randomBytes','reply','49cDnvNO','test','includes','stdout','-vcodec','writeUIntLE','png:-','inputFormat','url','../tmp/','join','end','Image','65GMvxkc','webp','../tmp','packId','utf8','writeFile','toFormat','.jpeg','from','accessibilityText','scale=\x27min(320,iw)\x27:min\x27(320,ih)\x27:force_original_aspect_ratio=decrease,fps=15,\x20pad=320:320:-1:-1:color=white@0.0,\x20split\x20[a][b];\x20[a]\x20palettegen=reserve_transparent=on:transparency_color=ffffff\x20[p];\x20[b][p]\x20paletteuse','application/octet-stream','readFile','toUpperCase','toBuffer','705033ZYgxQS','490725yJnocv','push','https://api.xteam.xyz/sticker/wm?','templateId','wa-sticker-formatter','MYSTIC','convert','1117976ouipqO','toString','default','androidAppStoreLink','entries','promises','error','input','bin','addOutputOptions'];a0_0x33b3=function(){return _0x3349ca;};return a0_0x33b3();}async function addExif(_0x34939f,_0x363b17,_0x4d47bd,_0x1a724d=[''],_0x43c8a3){const _0x455c8f=a0_0x33993c,_0xcdcc5e=new a0_0x22e237[(_0x455c8f(0x219))](),_0xe8227a=_0x455c8f(0x1d7)+a0_0x4eab70[_0x455c8f(0x20b)](0xc)[_0x455c8f(0x1da)](_0x455c8f(0x1f7))[_0x455c8f(0x227)](),_0x393481={'sticker-pack-id':_0x43c8a3[_0x455c8f(0x21d)]?_0x43c8a3[_0x455c8f(0x21d)]:''+_0xe8227a,'sticker-pack-name':_0x363b17?_0x363b17:undefined,'sticker-pack-publisher':_0x4d47bd?_0x4d47bd:undefined,'android-app-store-link':_0x43c8a3[_0x455c8f(0x1dc)]?_0x43c8a3['androidAppStoreLink']:undefined,'ios-app-store-link':_0x43c8a3[_0x455c8f(0x1f6)]?_0x43c8a3['iosAppStoreLink']:undefined,'is-ai-sticker':_0x43c8a3[_0x455c8f(0x1f0)]?0x1:undefined,'is-first-party-sticker':_0x43c8a3[_0x455c8f(0x203)]?0x1:undefined,'accessibility-text':_0x43c8a3[_0x455c8f(0x223)]?_0x43c8a3[_0x455c8f(0x223)]:undefined,'avatar-sticker-template-id':_0x43c8a3[_0x455c8f(0x1d5)]?_0x43c8a3[_0x455c8f(0x1d5)]:undefined,'is-avatar-sticker':_0x43c8a3[_0x455c8f(0x200)]?0x1:undefined,'sticker-maker-source-type':_0x43c8a3[_0x455c8f(0x1fd)]?_0x43c8a3[_0x455c8f(0x1fd)]:undefined,'emojis':_0x1a724d?_0x1a724d:undefined},_0x18cfa5=Buffer[_0x455c8f(0x222)]([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x42a45c=Buffer[_0x455c8f(0x222)](JSON[_0x455c8f(0x1e5)](_0x393481),_0x455c8f(0x21e)),_0x3fdc37=Buffer[_0x455c8f(0x1e6)]([_0x18cfa5,_0x42a45c]);return _0x3fdc37[_0x455c8f(0x212)](_0x42a45c[_0x455c8f(0x1fe)],0xe,0x4),await _0xcdcc5e[_0x455c8f(0x1ec)](_0x34939f),_0xcdcc5e[_0x455c8f(0x1f3)]=_0x3fdc37,await _0xcdcc5e[_0x455c8f(0x1e7)](null);}async function sticker(_0x436eaa,_0x3f05a7,..._0x53ef3f){const _0xad6034=a0_0x33993c;let _0x3364aa,_0x46fb91;for(const _0x5a74be of[sticker3,global[_0xad6034(0x1f1)][_0xad6034(0x1fa)]&&sticker6,sticker5,global['support']['ffmpeg']&&global['support']['ffmpegWebp']&&sticker4,global['support']['ffmpeg']&&(global[_0xad6034(0x1f1)][_0xad6034(0x1d8)]||global[_0xad6034(0x1f1)][_0xad6034(0x1f2)]||global['support']['gm'])&&sticker2][_0xad6034(0x202)](_0x24a687=>_0x24a687)){try{_0x46fb91=await _0x5a74be(_0x436eaa,_0x3f05a7,..._0x53ef3f);if(_0x46fb91['includes'](_0xad6034(0x1ea)))continue;if(_0x46fb91[_0xad6034(0x20f)](_0xad6034(0x204)))try{return await addExif(_0x46fb91,..._0x53ef3f);}catch(_0x5ea809){return console[_0xad6034(0x1df)](_0x5ea809),_0x46fb91;}throw _0x46fb91[_0xad6034(0x1da)]();}catch(_0x54c137){_0x3364aa=_0x54c137;continue;}}return console['error'](_0x3364aa),_0x3364aa;}const support={'ffmpeg':!![],'ffprobe':!![],'ffmpegWebp':!![],'convert':!![],'magick':![],'gm':![],'find':![]};export{sticker,sticker2,sticker3,sticker4,sticker6,addExif,support};