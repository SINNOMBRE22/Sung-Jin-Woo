const a0_0x26038e=a0_0xa0f1;(function(_0xd00911,_0x40a2e0){const _0x185c3f=a0_0xa0f1,_0x15b272=_0xd00911();while(!![]){try{const _0x195882=-parseInt(_0x185c3f(0x1be))/0x1*(-parseInt(_0x185c3f(0x178))/0x2)+-parseInt(_0x185c3f(0x179))/0x3*(-parseInt(_0x185c3f(0x189))/0x4)+-parseInt(_0x185c3f(0x18c))/0x5*(parseInt(_0x185c3f(0x1b4))/0x6)+parseInt(_0x185c3f(0x1b2))/0x7+-parseInt(_0x185c3f(0x183))/0x8*(-parseInt(_0x185c3f(0x1af))/0x9)+-parseInt(_0x185c3f(0x1a1))/0xa*(-parseInt(_0x185c3f(0x1a2))/0xb)+-parseInt(_0x185c3f(0x195))/0xc*(parseInt(_0x185c3f(0x176))/0xd);if(_0x195882===_0x40a2e0)break;else _0x15b272['push'](_0x15b272['shift']());}catch(_0xbca2d7){_0x15b272['push'](_0x15b272['shift']());}}}(a0_0x5acb,0x553c1));import{dirname}from'path';import{fileURLToPath}from'url';import*as a0_0x2bfbde from'fs';import*as a0_0x3db08e from'path';import*as a0_0x4ff080 from'crypto';import{ffmpeg}from'./converter.js';import a0_0x24ef5a from'fluent-ffmpeg';import{spawn}from'child_process';import a0_0x71fc80 from'./uploadFile.js';import a0_0x247e83 from'./uploadImage.js';import{fileTypeFromBuffer}from'file-type';import a0_0x3bda02 from'node-webpmux';import a0_0x4fcbe0 from'node-fetch';function a0_0x5acb(){const _0x46bd21=['stdout','join','stickerMakerSourceType','buffer','../tmp','scale=\x27min(320,iw)\x27:min\x27(320,ih)\x27:force_original_aspect_ratio=decrease,fps=15,\x20pad=320:320:-1:-1:color=white@0.0,\x20split\x20[a][b];\x20[a]\x20palettegen=reserve_transparent=on:transparency_color=ffffff\x20[p];\x20[b][p]\x20paletteuse','Image','load','wa-sticker-formatter','toBuffer','596900MqZGMl','22DjBfnn','format','support','.jpeg','writeUIntLE','input','readFile','toFormat','default','https://api.xteam.xyz/sticker/wm?','stringify','magick','webp','4059873THJOyF','-vf','addOutputOptions','517097PDoDuv','isFirstPartySticker','6240gUomsR','WEBP','close','save','promises','templateId','reply','entries','from','error','4140fQfaOG','webp:-','convert','exif','packId','scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','test','concat','filter','ffmpeg','writeFile','324467VKpWmv','iosAppStoreLink','268RxChjC','8406fHlsWi','inputFormat','isAvatarSticker','ffmpegWebp','MYSTIC','data','length','pipe','html','unlink','8gQmUjl','png','jpeg','isAiSticker','../tmp/','stdin','4sQcaWL','includes','exports','2780CSTGnk','status','-vcodec','end','text','exit','toString','ext','androidAppStoreLink','132rVoKyi','accessibilityText'];a0_0x5acb=function(){return _0x46bd21;};return a0_0x5acb();}const __dirname=dirname(fileURLToPath(import.meta['url'])),tmp=a0_0x3db08e['join'](__dirname,a0_0x26038e(0x19b));function sticker2(_0x1addf4,_0x2e9605){return new Promise(async(_0x3dc77b,_0x2df85f)=>{const _0x2fc6c=a0_0xa0f1;try{if(_0x2e9605){const _0x10529f=await a0_0x4fcbe0(_0x2e9605);if(_0x10529f[_0x2fc6c(0x18d)]!==0xc8)throw await _0x10529f[_0x2fc6c(0x190)]();_0x1addf4=await _0x10529f['buffer']();}const _0x2e2a26=a0_0x3db08e[_0x2fc6c(0x198)](tmp,+new Date()+_0x2fc6c(0x1a5));await a0_0x2bfbde['promises'][_0x2fc6c(0x175)](_0x2e2a26,_0x1addf4);const _0x321a39=spawn(_0x2fc6c(0x174),['-y','-i',_0x2e2a26,_0x2fc6c(0x1b0),_0x2fc6c(0x170),'-f',_0x2fc6c(0x184),'-']);_0x321a39['on'](_0x2fc6c(0x1bd),_0x2df85f),_0x321a39['on'](_0x2fc6c(0x1b6),async()=>{const _0x2335aa=_0x2fc6c;await a0_0x2bfbde['promises'][_0x2335aa(0x182)](_0x2e2a26);});const _0x4ad586=[],[_0x1a8141,..._0x3fd1e0]=[...module['exports'][_0x2fc6c(0x1a4)]['gm']?['gm']:module[_0x2fc6c(0x18b)][_0x2fc6c(0x1ad)]?[_0x2fc6c(0x1ad)]:[],_0x2fc6c(0x16d),'png:-',_0x2fc6c(0x1bf)],_0xeef809=spawn(_0x1a8141,_0x3fd1e0);_0xeef809['on']('error',_0x82f71a=>conn[_0x2fc6c(0x1ba)](m['chat'],util[_0x2fc6c(0x1a3)](_0x82f71a),m)),_0xeef809[_0x2fc6c(0x197)]['on'](_0x2fc6c(0x17e),_0x408272=>_0x4ad586['push'](_0x408272)),_0x321a39[_0x2fc6c(0x197)][_0x2fc6c(0x180)](_0xeef809[_0x2fc6c(0x188)]),_0xeef809['on'](_0x2fc6c(0x191),()=>{const _0x32ae4e=_0x2fc6c;_0x3dc77b(Buffer[_0x32ae4e(0x172)](_0x4ad586));});}catch(_0x2253ce){_0x2df85f(_0x2253ce);}});}async function sticker3(_0x4a384e,_0x19a12c,_0x509639,_0x72e234){const _0x4a75ce=a0_0x26038e;_0x19a12c=_0x19a12c?_0x19a12c:await a0_0x71fc80(_0x4a384e);const _0x5b560e=await a0_0x4fcbe0(_0x4a75ce(0x1ab)+new URLSearchParams(Object[_0x4a75ce(0x1bb)]({'url':_0x19a12c,'packname':_0x509639,'author':_0x72e234})));return await _0x5b560e[_0x4a75ce(0x19a)]();}async function sticker4(_0xd68872,_0x536b94){const _0x2bbda1=a0_0x26038e;if(_0x536b94){const _0x1c7003=await a0_0x4fcbe0(_0x536b94);if(_0x1c7003['status']!==0xc8)throw await _0x1c7003[_0x2bbda1(0x190)]();_0xd68872=await _0x1c7003[_0x2bbda1(0x19a)]();}return await ffmpeg(_0xd68872,['-vf',_0x2bbda1(0x170)],_0x2bbda1(0x185),_0x2bbda1(0x1ae));}async function sticker5(_0x1f0c5c,_0x45afa0,_0x1f0fd5,_0x2832c7,_0x315be0=[''],_0x508878={}){const _0x221d3d=a0_0x26038e,{Sticker:_0x2cdaed}=await import(_0x221d3d(0x19f)),_0x1dc1aa={'type':_0x221d3d(0x1aa),'pack':_0x1f0fd5,'author':_0x2832c7,'categories':_0x315be0,..._0x508878};return new _0x2cdaed(_0x1f0c5c?_0x1f0c5c:_0x45afa0,_0x1dc1aa)[_0x221d3d(0x1a0)]();}function sticker6(_0x7a0ced,_0x2d8657){return new Promise(async(_0x663b2f,_0x2ee954)=>{const _0x4127b3=a0_0xa0f1;if(_0x2d8657){const _0x4fa20f=await a0_0x4fcbe0(_0x2d8657);if(_0x4fa20f[_0x4127b3(0x18d)]!==0xc8)throw await _0x4fa20f[_0x4127b3(0x190)]();_0x7a0ced=await _0x4fa20f[_0x4127b3(0x19a)]();}const _0x41e6ab=await fileTypeFromBuffer(_0x7a0ced)||{'mime':'application/octet-stream','ext':'bin'};if(_0x41e6ab[_0x4127b3(0x193)]=='bin')_0x2ee954(_0x7a0ced);const _0x1c1e9b=a0_0x3db08e[_0x4127b3(0x198)](__dirname,_0x4127b3(0x187)+ +new Date()+'.'+_0x41e6ab[_0x4127b3(0x193)]),_0x1382a2=a0_0x3db08e[_0x4127b3(0x198)](_0x1c1e9b+'.webp');await a0_0x2bfbde[_0x4127b3(0x1b8)][_0x4127b3(0x175)](_0x1c1e9b,_0x7a0ced);const _0x510fb0=/video/i[_0x4127b3(0x171)](_0x41e6ab['mime'])?a0_0x24ef5a(_0x1c1e9b)[_0x4127b3(0x17a)](_0x41e6ab[_0x4127b3(0x193)]):a0_0x24ef5a(_0x1c1e9b)[_0x4127b3(0x1a7)](_0x1c1e9b);_0x510fb0['on'](_0x4127b3(0x1bd),function(_0x4ca155){const _0x89820b=_0x4127b3;console[_0x89820b(0x1bd)](_0x4ca155),a0_0x2bfbde[_0x89820b(0x1b8)]['unlink'](_0x1c1e9b),_0x2ee954(_0x7a0ced);})['on'](_0x4127b3(0x18f),async function(){const _0x1e6a74=_0x4127b3;a0_0x2bfbde['promises'][_0x1e6a74(0x182)](_0x1c1e9b),_0x663b2f(await a0_0x2bfbde['promises'][_0x1e6a74(0x1a8)](_0x1382a2));})[_0x4127b3(0x1b1)]([_0x4127b3(0x18e),'libwebp',_0x4127b3(0x1b0),_0x4127b3(0x19c)])[_0x4127b3(0x1a9)](_0x4127b3(0x1ae))[_0x4127b3(0x1b7)](_0x1382a2);});}function a0_0xa0f1(_0x44b368,_0xc48b1a){const _0x5acb00=a0_0x5acb();return a0_0xa0f1=function(_0xa0f12e,_0x7b27c2){_0xa0f12e=_0xa0f12e-0x16d;let _0x45cead=_0x5acb00[_0xa0f12e];return _0x45cead;},a0_0xa0f1(_0x44b368,_0xc48b1a);}async function addExif(_0x362e73,_0x3d11e5,_0x34d545,_0x3a0cbe=[''],_0x230f56){const _0x10c7c3=a0_0x26038e,_0x38fc5d=new a0_0x3bda02[(_0x10c7c3(0x19d))](),_0x35a6e9=_0x10c7c3(0x17d)+a0_0x4ff080['randomBytes'](0xc)['toString']('hex')['toUpperCase'](),_0x472fd7={'sticker-pack-id':_0x230f56['packId']?_0x230f56[_0x10c7c3(0x16f)]:''+_0x35a6e9,'sticker-pack-name':_0x3d11e5?_0x3d11e5:undefined,'sticker-pack-publisher':_0x34d545?_0x34d545:undefined,'android-app-store-link':_0x230f56[_0x10c7c3(0x194)]?_0x230f56[_0x10c7c3(0x194)]:undefined,'ios-app-store-link':_0x230f56[_0x10c7c3(0x177)]?_0x230f56[_0x10c7c3(0x177)]:undefined,'is-ai-sticker':_0x230f56[_0x10c7c3(0x186)]?0x1:undefined,'is-first-party-sticker':_0x230f56[_0x10c7c3(0x1b3)]?0x1:undefined,'accessibility-text':_0x230f56[_0x10c7c3(0x196)]?_0x230f56['accessibilityText']:undefined,'avatar-sticker-template-id':_0x230f56[_0x10c7c3(0x1b9)]?_0x230f56[_0x10c7c3(0x1b9)]:undefined,'is-avatar-sticker':_0x230f56[_0x10c7c3(0x17b)]?0x1:undefined,'sticker-maker-source-type':_0x230f56[_0x10c7c3(0x199)]?_0x230f56[_0x10c7c3(0x199)]:undefined,'emojis':_0x3a0cbe?_0x3a0cbe:undefined},_0x42ae8d=Buffer[_0x10c7c3(0x1bc)]([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x8d157a=Buffer[_0x10c7c3(0x1bc)](JSON[_0x10c7c3(0x1ac)](_0x472fd7),'utf8'),_0x49ac0c=Buffer[_0x10c7c3(0x172)]([_0x42ae8d,_0x8d157a]);return _0x49ac0c[_0x10c7c3(0x1a6)](_0x8d157a[_0x10c7c3(0x17f)],0xe,0x4),await _0x38fc5d[_0x10c7c3(0x19e)](_0x362e73),_0x38fc5d[_0x10c7c3(0x16e)]=_0x49ac0c,await _0x38fc5d[_0x10c7c3(0x1b7)](null);}async function sticker(_0x4e7d88,_0x40de1c,..._0x1bc050){const _0x4c0c56=a0_0x26038e;let _0x40d7f2,_0x1275d0;for(const _0x6ec302 of[sticker3,global[_0x4c0c56(0x1a4)][_0x4c0c56(0x174)]&&sticker6,sticker5,global['support'][_0x4c0c56(0x174)]&&global[_0x4c0c56(0x1a4)][_0x4c0c56(0x17c)]&&sticker4,global[_0x4c0c56(0x1a4)][_0x4c0c56(0x174)]&&(global[_0x4c0c56(0x1a4)]['convert']||global[_0x4c0c56(0x1a4)][_0x4c0c56(0x1ad)]||global[_0x4c0c56(0x1a4)]['gm'])&&sticker2][_0x4c0c56(0x173)](_0x13ef58=>_0x13ef58)){try{_0x1275d0=await _0x6ec302(_0x4e7d88,_0x40de1c,..._0x1bc050);if(_0x1275d0[_0x4c0c56(0x18a)](_0x4c0c56(0x181)))continue;if(_0x1275d0['includes'](_0x4c0c56(0x1b5)))try{return await addExif(_0x1275d0,..._0x1bc050);}catch(_0x237941){return console[_0x4c0c56(0x1bd)](_0x237941),_0x1275d0;}throw _0x1275d0[_0x4c0c56(0x192)]();}catch(_0x191daa){_0x40d7f2=_0x191daa;continue;}}return console[_0x4c0c56(0x1bd)](_0x40d7f2),_0x40d7f2;}const support={'ffmpeg':!![],'ffprobe':!![],'ffmpegWebp':!![],'convert':!![],'magick':![],'gm':![],'find':![]};export{sticker,sticker2,sticker3,sticker4,sticker6,addExif,support};