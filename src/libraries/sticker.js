const a0_0x5455d6=a0_0x4956;(function(_0x6c492d,_0x1e9462){const _0x23ab38=a0_0x4956,_0x35aeff=_0x6c492d();while(!![]){try{const _0x5ec5e9=-parseInt(_0x23ab38(0xf3))/0x1*(-parseInt(_0x23ab38(0x10b))/0x2)+-parseInt(_0x23ab38(0xf1))/0x3+parseInt(_0x23ab38(0x104))/0x4+-parseInt(_0x23ab38(0x101))/0x5+parseInt(_0x23ab38(0x103))/0x6*(parseInt(_0x23ab38(0xe4))/0x7)+parseInt(_0x23ab38(0xff))/0x8*(-parseInt(_0x23ab38(0xe5))/0x9)+parseInt(_0x23ab38(0xc8))/0xa*(parseInt(_0x23ab38(0xcd))/0xb);if(_0x5ec5e9===_0x1e9462)break;else _0x35aeff['push'](_0x35aeff['shift']());}catch(_0x401a22){_0x35aeff['push'](_0x35aeff['shift']());}}}(a0_0x4c21,0xdddf1));import{dirname}from'path';function a0_0x4c21(){const _0x20d31d=['exports','push','png:-','-vcodec','bin','format','hex','stdout','join','Image','application/octet-stream','promises','status','toString','scale=\x27min(320,iw)\x27:min\x27(320,ih)\x27:force_original_aspect_ratio=decrease,fps=15,\x20pad=320:320:-1:-1:color=white@0.0,\x20split\x20[a][b];\x20[a]\x20palettegen=reserve_transparent=on:transparency_color=ffffff\x20[p];\x20[b][p]\x20paletteuse','url','iosAppStoreLink','ffmpeg','chat','randomBytes','909244zYyaHt','9dPQXAk','scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','input','toUpperCase','save','exit','packId','stringify','isAvatarSticker','concat','WEBP','../tmp','2704839xjGyzD','stickerMakerSourceType','27WLsUkq','magick','unlink','reply','-vf','androidAppStoreLink','templateId','test','libwebp','isFirstPartySticker','../tmp/','ext','11371112vOoZuy','support','1784375MNOzHt','MYSTIC','78CGFxyi','549544kqMsax','utf8','end','from','.jpeg','ffmpegWebp','text','104638mQETac','addOutputOptions','toBuffer','data','webp','isAiSticker','buffer','length','https://api.xteam.xyz/sticker/wm?','convert','webp:-','3500670aDOhUy','writeFile','mime','jpeg','error','11uXNxRQ','exif','inputFormat'];a0_0x4c21=function(){return _0x20d31d;};return a0_0x4c21();}import{fileURLToPath}from'url';import*as a0_0x1ab251 from'fs';import*as a0_0x4813b3 from'path';import*as a0_0x13791d from'crypto';import{ffmpeg}from'./converter.js';import a0_0x4ad4ad from'fluent-ffmpeg';import{spawn}from'child_process';import a0_0x441765 from'./uploadFile.js';import a0_0x7b1984 from'./uploadImage.js';import{fileTypeFromBuffer}from'file-type';import a0_0xf073d5 from'node-webpmux';function a0_0x4956(_0x3cc7ef,_0xa7f8a7){const _0x4c2187=a0_0x4c21();return a0_0x4956=function(_0x49561c,_0x9b6468){_0x49561c=_0x49561c-0xc8;let _0x17692f=_0x4c2187[_0x49561c];return _0x17692f;},a0_0x4956(_0x3cc7ef,_0xa7f8a7);}import a0_0x426873 from'node-fetch';const __dirname=dirname(fileURLToPath(import.meta[a0_0x5455d6(0xdf)])),tmp=a0_0x4813b3['join'](__dirname,a0_0x5455d6(0xf0));function sticker2(_0x22a039,_0x38e351){return new Promise(async(_0x4080ef,_0x329e17)=>{const _0x49df5b=a0_0x4956;try{if(_0x38e351){const _0xbd61f5=await a0_0x426873(_0x38e351);if(_0xbd61f5[_0x49df5b(0xdc)]!==0xc8)throw await _0xbd61f5[_0x49df5b(0x10a)]();_0x22a039=await _0xbd61f5[_0x49df5b(0x111)]();}const _0x464575=a0_0x4813b3[_0x49df5b(0xd8)](tmp,+new Date()+_0x49df5b(0x108));await a0_0x1ab251[_0x49df5b(0xdb)][_0x49df5b(0xc9)](_0x464575,_0x22a039);const _0x31d18b=spawn('ffmpeg',['-y','-i',_0x464575,_0x49df5b(0xf7),_0x49df5b(0xe6),'-f','png','-']);_0x31d18b['on'](_0x49df5b(0xcc),_0x329e17),_0x31d18b['on']('close',async()=>{const _0x4f51fc=_0x49df5b;await a0_0x1ab251[_0x4f51fc(0xdb)]['unlink'](_0x464575);});const _0x2ec678=[],[_0x30e392,..._0x5341b2]=[...module[_0x49df5b(0xd0)][_0x49df5b(0x100)]['gm']?['gm']:module[_0x49df5b(0xd0)][_0x49df5b(0xf4)]?[_0x49df5b(0xf4)]:[],_0x49df5b(0x114),_0x49df5b(0xd2),_0x49df5b(0x115)],_0x4efee0=spawn(_0x30e392,_0x5341b2);_0x4efee0['on'](_0x49df5b(0xcc),_0x1dfdd3=>conn[_0x49df5b(0xf6)](m[_0x49df5b(0xe2)],util[_0x49df5b(0xd5)](_0x1dfdd3),m)),_0x4efee0[_0x49df5b(0xd7)]['on'](_0x49df5b(0x10e),_0x584d0e=>_0x2ec678[_0x49df5b(0xd1)](_0x584d0e)),_0x31d18b[_0x49df5b(0xd7)]['pipe'](_0x4efee0['stdin']),_0x4efee0['on'](_0x49df5b(0xea),()=>{const _0x34859e=_0x49df5b;_0x4080ef(Buffer[_0x34859e(0xee)](_0x2ec678));});}catch(_0x39c678){_0x329e17(_0x39c678);}});}async function sticker3(_0x2ebe5a,_0x3e120e,_0x3013c1,_0xef3fae){const _0x266a23=a0_0x5455d6;_0x3e120e=_0x3e120e?_0x3e120e:await a0_0x441765(_0x2ebe5a);const _0x180f44=await a0_0x426873(_0x266a23(0x113)+new URLSearchParams(Object['entries']({'url':_0x3e120e,'packname':_0x3013c1,'author':_0xef3fae})));return await _0x180f44['buffer']();}async function sticker4(_0x57e432,_0x530871){const _0x56acc8=a0_0x5455d6;if(_0x530871){const _0x2d7450=await a0_0x426873(_0x530871);if(_0x2d7450[_0x56acc8(0xdc)]!==0xc8)throw await _0x2d7450[_0x56acc8(0x10a)]();_0x57e432=await _0x2d7450[_0x56acc8(0x111)]();}return await ffmpeg(_0x57e432,['-vf',_0x56acc8(0xe6)],_0x56acc8(0xcb),'webp');}async function sticker5(_0x2ed419,_0x59d9f6,_0x2007ee,_0x44a199,_0x1dc909=[''],_0x375e8f={}){const _0xeebad3=a0_0x5455d6,{Sticker:_0x1ac54b}=await import('wa-sticker-formatter'),_0x32f16b={'type':'default','pack':_0x2007ee,'author':_0x44a199,'categories':_0x1dc909,..._0x375e8f};return new _0x1ac54b(_0x2ed419?_0x2ed419:_0x59d9f6,_0x32f16b)[_0xeebad3(0x10d)]();}function sticker6(_0x229e12,_0x445eed){return new Promise(async(_0x1a126f,_0x447883)=>{const _0x4474f7=a0_0x4956;if(_0x445eed){const _0x35918d=await a0_0x426873(_0x445eed);if(_0x35918d[_0x4474f7(0xdc)]!==0xc8)throw await _0x35918d[_0x4474f7(0x10a)]();_0x229e12=await _0x35918d[_0x4474f7(0x111)]();}const _0x257534=await fileTypeFromBuffer(_0x229e12)||{'mime':_0x4474f7(0xda),'ext':_0x4474f7(0xd4)};if(_0x257534[_0x4474f7(0xfe)]==_0x4474f7(0xd4))_0x447883(_0x229e12);const _0x468f9f=a0_0x4813b3['join'](__dirname,_0x4474f7(0xfd)+ +new Date()+'.'+_0x257534[_0x4474f7(0xfe)]),_0x403d20=a0_0x4813b3['join'](_0x468f9f+'.webp');await a0_0x1ab251[_0x4474f7(0xdb)]['writeFile'](_0x468f9f,_0x229e12);const _0x7e20c1=/video/i[_0x4474f7(0xfa)](_0x257534[_0x4474f7(0xca)])?a0_0x4ad4ad(_0x468f9f)[_0x4474f7(0xcf)](_0x257534['ext']):a0_0x4ad4ad(_0x468f9f)[_0x4474f7(0xe7)](_0x468f9f);_0x7e20c1['on'](_0x4474f7(0xcc),function(_0x12bd2f){const _0xaab6c7=_0x4474f7;console[_0xaab6c7(0xcc)](_0x12bd2f),a0_0x1ab251[_0xaab6c7(0xdb)][_0xaab6c7(0xf5)](_0x468f9f),_0x447883(_0x229e12);})['on'](_0x4474f7(0x106),async function(){const _0xcf338c=_0x4474f7;a0_0x1ab251[_0xcf338c(0xdb)][_0xcf338c(0xf5)](_0x468f9f),_0x1a126f(await a0_0x1ab251[_0xcf338c(0xdb)]['readFile'](_0x403d20));})[_0x4474f7(0x10c)]([_0x4474f7(0xd3),_0x4474f7(0xfb),_0x4474f7(0xf7),_0x4474f7(0xde)])['toFormat'](_0x4474f7(0x10f))[_0x4474f7(0xe9)](_0x403d20);});}async function addExif(_0x574c01,_0x2e2055,_0x2d432a,_0x27c783=[''],_0x2fdcba){const _0x2dfa46=a0_0x5455d6,_0x1f73fa=new a0_0xf073d5[(_0x2dfa46(0xd9))](),_0x5bd462=_0x2dfa46(0x102)+a0_0x13791d[_0x2dfa46(0xe3)](0xc)['toString'](_0x2dfa46(0xd6))[_0x2dfa46(0xe8)](),_0x2ea132={'sticker-pack-id':_0x2fdcba['packId']?_0x2fdcba[_0x2dfa46(0xeb)]:''+_0x5bd462,'sticker-pack-name':_0x2e2055?_0x2e2055:undefined,'sticker-pack-publisher':_0x2d432a?_0x2d432a:undefined,'android-app-store-link':_0x2fdcba[_0x2dfa46(0xf8)]?_0x2fdcba[_0x2dfa46(0xf8)]:undefined,'ios-app-store-link':_0x2fdcba[_0x2dfa46(0xe0)]?_0x2fdcba['iosAppStoreLink']:undefined,'is-ai-sticker':_0x2fdcba[_0x2dfa46(0x110)]?0x1:undefined,'is-first-party-sticker':_0x2fdcba[_0x2dfa46(0xfc)]?0x1:undefined,'accessibility-text':_0x2fdcba['accessibilityText']?_0x2fdcba['accessibilityText']:undefined,'avatar-sticker-template-id':_0x2fdcba[_0x2dfa46(0xf9)]?_0x2fdcba['templateId']:undefined,'is-avatar-sticker':_0x2fdcba[_0x2dfa46(0xed)]?0x1:undefined,'sticker-maker-source-type':_0x2fdcba['stickerMakerSourceType']?_0x2fdcba[_0x2dfa46(0xf2)]:undefined,'emojis':_0x27c783?_0x27c783:undefined},_0x513d6a=Buffer[_0x2dfa46(0x107)]([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x4fb9a8=Buffer[_0x2dfa46(0x107)](JSON[_0x2dfa46(0xec)](_0x2ea132),_0x2dfa46(0x105)),_0x4b6da1=Buffer[_0x2dfa46(0xee)]([_0x513d6a,_0x4fb9a8]);return _0x4b6da1['writeUIntLE'](_0x4fb9a8[_0x2dfa46(0x112)],0xe,0x4),await _0x1f73fa['load'](_0x574c01),_0x1f73fa[_0x2dfa46(0xce)]=_0x4b6da1,await _0x1f73fa[_0x2dfa46(0xe9)](null);}async function sticker(_0x36f789,_0x447753,..._0x22f7b7){const _0x566658=a0_0x5455d6;let _0x275a73,_0x5328a4;for(const _0x537b6f of[sticker3,global[_0x566658(0x100)][_0x566658(0xe1)]&&sticker6,sticker5,global[_0x566658(0x100)]['ffmpeg']&&global['support'][_0x566658(0x109)]&&sticker4,global['support'][_0x566658(0xe1)]&&(global['support'][_0x566658(0x114)]||global[_0x566658(0x100)][_0x566658(0xf4)]||global['support']['gm'])&&sticker2]['filter'](_0x2b1a3d=>_0x2b1a3d)){try{_0x5328a4=await _0x537b6f(_0x36f789,_0x447753,..._0x22f7b7);if(_0x5328a4['includes']('html'))continue;if(_0x5328a4['includes'](_0x566658(0xef)))try{return await addExif(_0x5328a4,..._0x22f7b7);}catch(_0x52214f){return console['error'](_0x52214f),_0x5328a4;}throw _0x5328a4[_0x566658(0xdd)]();}catch(_0x31eee5){_0x275a73=_0x31eee5;continue;}}return console[_0x566658(0xcc)](_0x275a73),_0x275a73;}const support={'ffmpeg':!![],'ffprobe':!![],'ffmpegWebp':!![],'convert':!![],'magick':![],'gm':![],'find':![]};export{sticker,sticker2,sticker3,sticker4,sticker6,addExif,support};