function a0_0xbb3f(){const _0x56ce29=['toFormat','ext','writeUIntLE','length','status','chat','38680gBVZaj','error','png','default','isAiSticker','includes','accessibilityText','text','iosAppStoreLink','randomBytes','application/octet-stream','androidAppStoreLink','stdout','WEBP','isAvatarSticker','webp:-','jpeg','unlink','ffmpegWebp','load','from','promises','pipe','236691QCZUTJ','test','input','MYSTIC','3569643avSRaK','-vf','mime','data','bin','magick','stickerMakerSourceType','entries','isFirstPartySticker','support','toUpperCase','Image','-vcodec','format','scale=\x27min(320,iw)\x27:min\x27(320,ih)\x27:force_original_aspect_ratio=decrease,fps=15,\x20pad=320:320:-1:-1:color=white@0.0,\x20split\x20[a][b];\x20[a]\x20palettegen=reserve_transparent=on:transparency_color=ffffff\x20[p];\x20[b][p]\x20paletteuse','webp','ffmpeg','save','81LckuGT','concat','inputFormat','templateId','buffer','.jpeg','596fOKgkU','exports','url','stringify','writeFile','join','toString','1866920aaLilu','https://api.xteam.xyz/sticker/wm?','push','4660fZxvaZ','wa-sticker-formatter','573CkWdbp','convert','png:-','2635818sPCijG','end','scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','3430DUuhKW','exit','packId'];a0_0xbb3f=function(){return _0x56ce29;};return a0_0xbb3f();}const a0_0x37c001=a0_0xf4ca;(function(_0x394858,_0x13efcf){const _0x33c36b=a0_0xf4ca,_0x1d06d7=_0x394858();while(!![]){try{const _0x22c445=-parseInt(_0x33c36b(0x1a4))/0x1+parseInt(_0x33c36b(0x184))/0x2*(parseInt(_0x33c36b(0x1cc))/0x3)+parseInt(_0x33c36b(0x1c0))/0x4*(parseInt(_0x33c36b(0x1ca))/0x5)+parseInt(_0x33c36b(0x181))/0x6+-parseInt(_0x33c36b(0x1a8))/0x7+-parseInt(_0x33c36b(0x18d))/0x8*(parseInt(_0x33c36b(0x1ba))/0x9)+parseInt(_0x33c36b(0x1c7))/0xa;if(_0x22c445===_0x13efcf)break;else _0x1d06d7['push'](_0x1d06d7['shift']());}catch(_0x3102e7){_0x1d06d7['push'](_0x1d06d7['shift']());}}}(a0_0xbb3f,0x49cc1));import{dirname}from'path';import{fileURLToPath}from'url';import*as a0_0x54ca61 from'fs';import*as a0_0x1a782f from'path';import*as a0_0x2cde60 from'crypto';import{ffmpeg}from'./converter.js';import a0_0x5d2df5 from'fluent-ffmpeg';import{spawn}from'child_process';import a0_0x5d3d33 from'./uploadFile.js';import a0_0x26ef21 from'./uploadImage.js';import{fileTypeFromBuffer}from'file-type';import a0_0x4f80c7 from'node-webpmux';import a0_0x13bb37 from'node-fetch';const __dirname=dirname(fileURLToPath(import.meta[a0_0x37c001(0x1c2)])),tmp=a0_0x1a782f[a0_0x37c001(0x1c5)](__dirname,'../tmp');function sticker2(_0x54b043,_0x8f6b6a){return new Promise(async(_0x5c85ff,_0xb9c88)=>{const _0x36d5b3=a0_0xf4ca;try{if(_0x8f6b6a){const _0x50f537=await a0_0x13bb37(_0x8f6b6a);if(_0x50f537[_0x36d5b3(0x18b)]!==0xc8)throw await _0x50f537[_0x36d5b3(0x194)]();_0x54b043=await _0x50f537[_0x36d5b3(0x1be)]();}const _0x260d0e=a0_0x1a782f[_0x36d5b3(0x1c5)](tmp,+new Date()+_0x36d5b3(0x1bf));await a0_0x54ca61[_0x36d5b3(0x1a2)]['writeFile'](_0x260d0e,_0x54b043);const _0x37155a=spawn('ffmpeg',['-y','-i',_0x260d0e,'-vf',_0x36d5b3(0x183),'-f',_0x36d5b3(0x18f),'-']);_0x37155a['on']('error',_0xb9c88),_0x37155a['on']('close',async()=>{const _0x44d433=_0x36d5b3;await a0_0x54ca61[_0x44d433(0x1a2)]['unlink'](_0x260d0e);});const _0x1d206e=[],[_0x468554,..._0x3044c2]=[...module['exports'][_0x36d5b3(0x1b1)]['gm']?['gm']:module[_0x36d5b3(0x1c1)][_0x36d5b3(0x1ad)]?[_0x36d5b3(0x1ad)]:[],_0x36d5b3(0x17f),_0x36d5b3(0x180),_0x36d5b3(0x19c)],_0x582c83=spawn(_0x468554,_0x3044c2);_0x582c83['on'](_0x36d5b3(0x18e),_0x26eb4e=>conn['reply'](m[_0x36d5b3(0x18c)],util[_0x36d5b3(0x1b5)](_0x26eb4e),m)),_0x582c83[_0x36d5b3(0x199)]['on'](_0x36d5b3(0x1ab),_0x512bff=>_0x1d206e[_0x36d5b3(0x1c9)](_0x512bff)),_0x37155a[_0x36d5b3(0x199)][_0x36d5b3(0x1a3)](_0x582c83['stdin']),_0x582c83['on'](_0x36d5b3(0x185),()=>{_0x5c85ff(Buffer['concat'](_0x1d206e));});}catch(_0x414fa1){_0xb9c88(_0x414fa1);}});}async function sticker3(_0x1e9e41,_0x20a8b3,_0x22fbe7,_0x3f2607){const _0x3b8c6b=a0_0x37c001;_0x20a8b3=_0x20a8b3?_0x20a8b3:await a0_0x5d3d33(_0x1e9e41);const _0x2ccf85=await a0_0x13bb37(_0x3b8c6b(0x1c8)+new URLSearchParams(Object[_0x3b8c6b(0x1af)]({'url':_0x20a8b3,'packname':_0x22fbe7,'author':_0x3f2607})));return await _0x2ccf85['buffer']();}async function sticker4(_0x23d19c,_0x3d1ea0){const _0x44fa88=a0_0x37c001;if(_0x3d1ea0){const _0x223d5f=await a0_0x13bb37(_0x3d1ea0);if(_0x223d5f[_0x44fa88(0x18b)]!==0xc8)throw await _0x223d5f['text']();_0x23d19c=await _0x223d5f['buffer']();}return await ffmpeg(_0x23d19c,[_0x44fa88(0x1a9),_0x44fa88(0x183)],_0x44fa88(0x19d),'webp');}async function sticker5(_0x2aaeab,_0xcf52f0,_0x3f17bf,_0x106eba,_0x25476f=[''],_0x54ae75={}){const _0x8b5661=a0_0x37c001,{Sticker:_0x29bf7a}=await import(_0x8b5661(0x1cb)),_0x3e7d1d={'type':_0x8b5661(0x190),'pack':_0x3f17bf,'author':_0x106eba,'categories':_0x25476f,..._0x54ae75};return new _0x29bf7a(_0x2aaeab?_0x2aaeab:_0xcf52f0,_0x3e7d1d)['toBuffer']();}function sticker6(_0x5ee0cb,_0xe4b63a){return new Promise(async(_0x3f3ae2,_0x598a37)=>{const _0x5d576d=a0_0xf4ca;if(_0xe4b63a){const _0x43359a=await a0_0x13bb37(_0xe4b63a);if(_0x43359a[_0x5d576d(0x18b)]!==0xc8)throw await _0x43359a['text']();_0x5ee0cb=await _0x43359a[_0x5d576d(0x1be)]();}const _0x39ada3=await fileTypeFromBuffer(_0x5ee0cb)||{'mime':_0x5d576d(0x197),'ext':_0x5d576d(0x1ac)};if(_0x39ada3[_0x5d576d(0x188)]=='bin')_0x598a37(_0x5ee0cb);const _0x7a026=a0_0x1a782f[_0x5d576d(0x1c5)](__dirname,'../tmp/'+ +new Date()+'.'+_0x39ada3['ext']),_0x1a269=a0_0x1a782f[_0x5d576d(0x1c5)](_0x7a026+'.webp');await a0_0x54ca61[_0x5d576d(0x1a2)][_0x5d576d(0x1c4)](_0x7a026,_0x5ee0cb);const _0x54adf5=/video/i[_0x5d576d(0x1a5)](_0x39ada3[_0x5d576d(0x1aa)])?a0_0x5d2df5(_0x7a026)[_0x5d576d(0x1bc)](_0x39ada3[_0x5d576d(0x188)]):a0_0x5d2df5(_0x7a026)[_0x5d576d(0x1a6)](_0x7a026);_0x54adf5['on'](_0x5d576d(0x18e),function(_0x289727){const _0x2e40a8=_0x5d576d;console['error'](_0x289727),a0_0x54ca61[_0x2e40a8(0x1a2)][_0x2e40a8(0x19e)](_0x7a026),_0x598a37(_0x5ee0cb);})['on'](_0x5d576d(0x182),async function(){const _0x1811c7=_0x5d576d;a0_0x54ca61['promises'][_0x1811c7(0x19e)](_0x7a026),_0x3f3ae2(await a0_0x54ca61['promises']['readFile'](_0x1a269));})['addOutputOptions']([_0x5d576d(0x1b4),'libwebp',_0x5d576d(0x1a9),_0x5d576d(0x1b6)])[_0x5d576d(0x187)](_0x5d576d(0x1b7))[_0x5d576d(0x1b9)](_0x1a269);});}async function addExif(_0x47571a,_0xac1995,_0x129bc5,_0x3a5149=[''],_0x293d0a){const _0x38a55b=a0_0x37c001,_0x326bd1=new a0_0x4f80c7[(_0x38a55b(0x1b3))](),_0x419456=_0x38a55b(0x1a7)+a0_0x2cde60[_0x38a55b(0x196)](0xc)['toString']('hex')[_0x38a55b(0x1b2)](),_0x48761a={'sticker-pack-id':_0x293d0a['packId']?_0x293d0a[_0x38a55b(0x186)]:''+_0x419456,'sticker-pack-name':_0xac1995?_0xac1995:undefined,'sticker-pack-publisher':_0x129bc5?_0x129bc5:undefined,'android-app-store-link':_0x293d0a[_0x38a55b(0x198)]?_0x293d0a[_0x38a55b(0x198)]:undefined,'ios-app-store-link':_0x293d0a[_0x38a55b(0x195)]?_0x293d0a[_0x38a55b(0x195)]:undefined,'is-ai-sticker':_0x293d0a[_0x38a55b(0x191)]?0x1:undefined,'is-first-party-sticker':_0x293d0a[_0x38a55b(0x1b0)]?0x1:undefined,'accessibility-text':_0x293d0a[_0x38a55b(0x193)]?_0x293d0a['accessibilityText']:undefined,'avatar-sticker-template-id':_0x293d0a[_0x38a55b(0x1bd)]?_0x293d0a[_0x38a55b(0x1bd)]:undefined,'is-avatar-sticker':_0x293d0a[_0x38a55b(0x19b)]?0x1:undefined,'sticker-maker-source-type':_0x293d0a[_0x38a55b(0x1ae)]?_0x293d0a[_0x38a55b(0x1ae)]:undefined,'emojis':_0x3a5149?_0x3a5149:undefined},_0x4026c4=Buffer[_0x38a55b(0x1a1)]([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x7b2b9e=Buffer[_0x38a55b(0x1a1)](JSON[_0x38a55b(0x1c3)](_0x48761a),'utf8'),_0x37666c=Buffer[_0x38a55b(0x1bb)]([_0x4026c4,_0x7b2b9e]);return _0x37666c[_0x38a55b(0x189)](_0x7b2b9e[_0x38a55b(0x18a)],0xe,0x4),await _0x326bd1[_0x38a55b(0x1a0)](_0x47571a),_0x326bd1['exif']=_0x37666c,await _0x326bd1['save'](null);}async function sticker(_0x2f2d72,_0x5bdb5e,..._0x3888b5){const _0x4e6bd5=a0_0x37c001;let _0xd4e64c,_0x478bb7;for(const _0x2892cd of[sticker3,global[_0x4e6bd5(0x1b1)]['ffmpeg']&&sticker6,sticker5,global[_0x4e6bd5(0x1b1)][_0x4e6bd5(0x1b8)]&&global[_0x4e6bd5(0x1b1)][_0x4e6bd5(0x19f)]&&sticker4,global[_0x4e6bd5(0x1b1)][_0x4e6bd5(0x1b8)]&&(global[_0x4e6bd5(0x1b1)][_0x4e6bd5(0x17f)]||global[_0x4e6bd5(0x1b1)][_0x4e6bd5(0x1ad)]||global['support']['gm'])&&sticker2]['filter'](_0x581ef9=>_0x581ef9)){try{_0x478bb7=await _0x2892cd(_0x2f2d72,_0x5bdb5e,..._0x3888b5);if(_0x478bb7[_0x4e6bd5(0x192)]('html'))continue;if(_0x478bb7[_0x4e6bd5(0x192)](_0x4e6bd5(0x19a)))try{return await addExif(_0x478bb7,..._0x3888b5);}catch(_0x4f5cbb){return console[_0x4e6bd5(0x18e)](_0x4f5cbb),_0x478bb7;}throw _0x478bb7[_0x4e6bd5(0x1c6)]();}catch(_0x3a23fa){_0xd4e64c=_0x3a23fa;continue;}}return console[_0x4e6bd5(0x18e)](_0xd4e64c),_0xd4e64c;}const support={'ffmpeg':!![],'ffprobe':!![],'ffmpegWebp':!![],'convert':!![],'magick':![],'gm':![],'find':![]};function a0_0xf4ca(_0x26131c,_0x54eee4){const _0xbb3f9b=a0_0xbb3f();return a0_0xf4ca=function(_0xf4cab,_0x296533){_0xf4cab=_0xf4cab-0x17f;let _0x2bd847=_0xbb3f9b[_0xf4cab];return _0x2bd847;},a0_0xf4ca(_0x26131c,_0x54eee4);}export{sticker,sticker2,sticker3,sticker4,sticker6,addExif,support};