const a0_0x30a080=a0_0x2c55;(function(_0x334cd0,_0x5d14eb){const _0x36f232=a0_0x2c55,_0x15f844=_0x334cd0();while(!![]){try{const _0x3afe8a=parseInt(_0x36f232(0x122))/0x1*(parseInt(_0x36f232(0x11a))/0x2)+-parseInt(_0x36f232(0x12a))/0x3+parseInt(_0x36f232(0xfb))/0x4*(parseInt(_0x36f232(0x101))/0x5)+-parseInt(_0x36f232(0x114))/0x6*(parseInt(_0x36f232(0x10e))/0x7)+parseInt(_0x36f232(0x108))/0x8*(parseInt(_0x36f232(0xf2))/0x9)+-parseInt(_0x36f232(0x11d))/0xa*(parseInt(_0x36f232(0xf4))/0xb)+parseInt(_0x36f232(0xe3))/0xc*(-parseInt(_0x36f232(0x12e))/0xd);if(_0x3afe8a===_0x5d14eb)break;else _0x15f844['push'](_0x15f844['shift']());}catch(_0x337ecd){_0x15f844['push'](_0x15f844['shift']());}}}(a0_0x2352,0xa26fc));import{dirname}from'path';import{fileURLToPath}from'url';import*as a0_0x49ea8d from'fs';function a0_0x2c55(_0x11e427,_0x360b40){const _0x235244=a0_0x2352();return a0_0x2c55=function(_0x2c55f9,_0x7d313c){_0x2c55f9=_0x2c55f9-0xe1;let _0x479015=_0x235244[_0x2c55f9];return _0x479015;},a0_0x2c55(_0x11e427,_0x360b40);}import*as a0_0x235ed6 from'path';import*as a0_0x34c3a9 from'crypto';import{ffmpeg}from'./converter.js';import a0_0x3eb4c6 from'fluent-ffmpeg';import{spawn}from'child_process';import a0_0xb9f79e from'./uploadFile.js';import a0_0x40b596 from'./uploadImage.js';import{fileTypeFromBuffer}from'file-type';import a0_0x51786f from'node-webpmux';import a0_0xf8c7d3 from'node-fetch';const __dirname=dirname(fileURLToPath(import.meta['url'])),tmp=a0_0x235ed6[a0_0x30a080(0x11c)](__dirname,a0_0x30a080(0xea));function sticker2(_0x1be97e,_0x5b2e40){return new Promise(async(_0x37ddd6,_0x20bd6f)=>{const _0x16c8cf=a0_0x2c55;try{if(_0x5b2e40){const _0x4494cc=await a0_0xf8c7d3(_0x5b2e40);if(_0x4494cc['status']!==0xc8)throw await _0x4494cc[_0x16c8cf(0x10a)]();_0x1be97e=await _0x4494cc[_0x16c8cf(0x10f)]();}const _0xcd6ee1=a0_0x235ed6[_0x16c8cf(0x11c)](tmp,+new Date()+_0x16c8cf(0xec));await a0_0x49ea8d['promises'][_0x16c8cf(0x107)](_0xcd6ee1,_0x1be97e);const _0x1748ad=spawn(_0x16c8cf(0x117),['-y','-i',_0xcd6ee1,_0x16c8cf(0x113),_0x16c8cf(0xfc),'-f',_0x16c8cf(0xff),'-']);_0x1748ad['on'](_0x16c8cf(0x109),_0x20bd6f),_0x1748ad['on'](_0x16c8cf(0xe4),async()=>{const _0xeda2f1=_0x16c8cf;await a0_0x49ea8d['promises'][_0xeda2f1(0x118)](_0xcd6ee1);});const _0x3176c5=[],[_0x3d042f,..._0x52adef]=[...module[_0x16c8cf(0xf1)][_0x16c8cf(0x125)]['gm']?['gm']:module[_0x16c8cf(0xf1)][_0x16c8cf(0x129)]?[_0x16c8cf(0x129)]:[],_0x16c8cf(0x102),_0x16c8cf(0xf6),_0x16c8cf(0x115)],_0xf64e8a=spawn(_0x3d042f,_0x52adef);_0xf64e8a['on'](_0x16c8cf(0x109),_0x3b2c83=>conn['reply'](m['chat'],util[_0x16c8cf(0xf0)](_0x3b2c83),m)),_0xf64e8a[_0x16c8cf(0x11e)]['on']('data',_0x6f13b4=>_0x3176c5['push'](_0x6f13b4)),_0x1748ad['stdout'][_0x16c8cf(0x12f)](_0xf64e8a[_0x16c8cf(0x128)]),_0xf64e8a['on'](_0x16c8cf(0xfa),()=>{const _0x3a0741=_0x16c8cf;_0x37ddd6(Buffer[_0x3a0741(0x130)](_0x3176c5));});}catch(_0x4c272d){_0x20bd6f(_0x4c272d);}});}async function sticker3(_0x58d2e2,_0x3aaeae,_0x449de1,_0x3490f6){const _0x4a2ed7=a0_0x30a080;_0x3aaeae=_0x3aaeae?_0x3aaeae:await a0_0xb9f79e(_0x58d2e2);const _0x495748=await a0_0xf8c7d3(_0x4a2ed7(0x105)+new URLSearchParams(Object[_0x4a2ed7(0xe7)]({'url':_0x3aaeae,'packname':_0x449de1,'author':_0x3490f6})));return await _0x495748[_0x4a2ed7(0x10f)]();}async function sticker4(_0x4b9a42,_0x3f1bea){const _0x3b2dab=a0_0x30a080;if(_0x3f1bea){const _0x1fbd09=await a0_0xf8c7d3(_0x3f1bea);if(_0x1fbd09[_0x3b2dab(0xeb)]!==0xc8)throw await _0x1fbd09['text']();_0x4b9a42=await _0x1fbd09['buffer']();}return await ffmpeg(_0x4b9a42,['-vf',_0x3b2dab(0xfc)],_0x3b2dab(0x112),_0x3b2dab(0x106));}async function sticker5(_0x977762,_0x183966,_0x40d940,_0x5f21be,_0x9bf551=[''],_0x3defad={}){const _0x4b312b=a0_0x30a080,{Sticker:_0x51ae79}=await import(_0x4b312b(0x116)),_0xe76d62={'type':'default','pack':_0x40d940,'author':_0x5f21be,'categories':_0x9bf551,..._0x3defad};return new _0x51ae79(_0x977762?_0x977762:_0x183966,_0xe76d62)[_0x4b312b(0x111)]();}function sticker6(_0x3ac48e,_0x3c39cb){return new Promise(async(_0x5b1cf7,_0x2bded7)=>{const _0x13e9c0=a0_0x2c55;if(_0x3c39cb){const _0x193374=await a0_0xf8c7d3(_0x3c39cb);if(_0x193374[_0x13e9c0(0xeb)]!==0xc8)throw await _0x193374[_0x13e9c0(0x10a)]();_0x3ac48e=await _0x193374['buffer']();}const _0x1d68ba=await fileTypeFromBuffer(_0x3ac48e)||{'mime':_0x13e9c0(0x100),'ext':_0x13e9c0(0xfd)};if(_0x1d68ba[_0x13e9c0(0xe2)]==_0x13e9c0(0xfd))_0x2bded7(_0x3ac48e);const _0x56636f=a0_0x235ed6[_0x13e9c0(0x11c)](__dirname,_0x13e9c0(0x12c)+ +new Date()+'.'+_0x1d68ba['ext']),_0x447f3d=a0_0x235ed6[_0x13e9c0(0x11c)](_0x56636f+_0x13e9c0(0x121));await a0_0x49ea8d[_0x13e9c0(0xfe)][_0x13e9c0(0x107)](_0x56636f,_0x3ac48e);const _0x2ed1b6=/video/i[_0x13e9c0(0x10b)](_0x1d68ba[_0x13e9c0(0x124)])?a0_0x3eb4c6(_0x56636f)['inputFormat'](_0x1d68ba[_0x13e9c0(0xe2)]):a0_0x3eb4c6(_0x56636f)['input'](_0x56636f);_0x2ed1b6['on'](_0x13e9c0(0x109),function(_0x3a95a9){const _0x176ca8=_0x13e9c0;console[_0x176ca8(0x109)](_0x3a95a9),a0_0x49ea8d['promises'][_0x176ca8(0x118)](_0x56636f),_0x2bded7(_0x3ac48e);})['on']('end',async function(){const _0x5815df=_0x13e9c0;a0_0x49ea8d[_0x5815df(0xfe)][_0x5815df(0x118)](_0x56636f),_0x5b1cf7(await a0_0x49ea8d[_0x5815df(0xfe)][_0x5815df(0xf7)](_0x447f3d));})['addOutputOptions']([_0x13e9c0(0xf8),_0x13e9c0(0xe9),_0x13e9c0(0x113),'scale=\x27min(320,iw)\x27:min\x27(320,ih)\x27:force_original_aspect_ratio=decrease,fps=15,\x20pad=320:320:-1:-1:color=white@0.0,\x20split\x20[a][b];\x20[a]\x20palettegen=reserve_transparent=on:transparency_color=ffffff\x20[p];\x20[b][p]\x20paletteuse'])[_0x13e9c0(0x11b)]('webp')[_0x13e9c0(0x103)](_0x447f3d);});}async function addExif(_0x1f1f0a,_0x2df155,_0x4cec55,_0x3df730=[''],_0x9a9b9c){const _0x243826=a0_0x30a080,_0x52feff=new a0_0x51786f['Image'](),_0x5d2482=_0x243826(0xf9)+a0_0x34c3a9[_0x243826(0x10c)](0xc)['toString'](_0x243826(0x123))[_0x243826(0x12d)](),_0x5582fe={'sticker-pack-id':_0x9a9b9c[_0x243826(0x11f)]?_0x9a9b9c[_0x243826(0x11f)]:''+_0x5d2482,'sticker-pack-name':_0x2df155?_0x2df155:undefined,'sticker-pack-publisher':_0x4cec55?_0x4cec55:undefined,'android-app-store-link':_0x9a9b9c[_0x243826(0xe6)]?_0x9a9b9c[_0x243826(0xe6)]:undefined,'ios-app-store-link':_0x9a9b9c['iosAppStoreLink']?_0x9a9b9c[_0x243826(0xf5)]:undefined,'is-ai-sticker':_0x9a9b9c[_0x243826(0xe5)]?0x1:undefined,'is-first-party-sticker':_0x9a9b9c[_0x243826(0xed)]?0x1:undefined,'accessibility-text':_0x9a9b9c['accessibilityText']?_0x9a9b9c['accessibilityText']:undefined,'avatar-sticker-template-id':_0x9a9b9c[_0x243826(0x10d)]?_0x9a9b9c[_0x243826(0x10d)]:undefined,'is-avatar-sticker':_0x9a9b9c[_0x243826(0x127)]?0x1:undefined,'sticker-maker-source-type':_0x9a9b9c['stickerMakerSourceType']?_0x9a9b9c[_0x243826(0x104)]:undefined,'emojis':_0x3df730?_0x3df730:undefined},_0x16037f=Buffer[_0x243826(0xee)]([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x1b0ea3=Buffer['from'](JSON[_0x243826(0xf3)](_0x5582fe),_0x243826(0x12b)),_0x48c2df=Buffer[_0x243826(0x130)]([_0x16037f,_0x1b0ea3]);return _0x48c2df[_0x243826(0x110)](_0x1b0ea3['length'],0xe,0x4),await _0x52feff['load'](_0x1f1f0a),_0x52feff['exif']=_0x48c2df,await _0x52feff[_0x243826(0x103)](null);}async function sticker(_0x3e153a,_0x22980d,..._0xf54e09){const _0xe22af7=a0_0x30a080;let _0x1bb279,_0x1a7694;for(const _0x358377 of[sticker3,global['support'][_0xe22af7(0x117)]&&sticker6,sticker5,global[_0xe22af7(0x125)][_0xe22af7(0x117)]&&global[_0xe22af7(0x125)][_0xe22af7(0x126)]&&sticker4,global[_0xe22af7(0x125)][_0xe22af7(0x117)]&&(global[_0xe22af7(0x125)][_0xe22af7(0x102)]||global[_0xe22af7(0x125)][_0xe22af7(0x129)]||global['support']['gm'])&&sticker2][_0xe22af7(0xe1)](_0x44df91=>_0x44df91)){try{_0x1a7694=await _0x358377(_0x3e153a,_0x22980d,..._0xf54e09);if(_0x1a7694[_0xe22af7(0x119)](_0xe22af7(0xe8)))continue;if(_0x1a7694[_0xe22af7(0x119)](_0xe22af7(0x120)))try{return await addExif(_0x1a7694,..._0xf54e09);}catch(_0x99c4ea){return console['error'](_0x99c4ea),_0x1a7694;}throw _0x1a7694[_0xe22af7(0xef)]();}catch(_0x300def){_0x1bb279=_0x300def;continue;}}return console[_0xe22af7(0x109)](_0x1bb279),_0x1bb279;}const support={'ffmpeg':!![],'ffprobe':!![],'ffmpegWebp':!![],'convert':!![],'magick':![],'gm':![],'find':![]};function a0_0x2352(){const _0x20ad63=['toString','format','exports','9GLoyjf','stringify','7025876iWRXCN','iosAppStoreLink','png:-','readFile','-vcodec','MYSTIC','exit','16RKExVV','scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','bin','promises','png','application/octet-stream','1101205WLdIAu','convert','save','stickerMakerSourceType','https://api.xteam.xyz/sticker/wm?','webp','writeFile','9454416xYePUv','error','text','test','randomBytes','templateId','448MsCOBw','buffer','writeUIntLE','toBuffer','jpeg','-vf','119880vqxkuE','webp:-','wa-sticker-formatter','ffmpeg','unlink','includes','1742NsUgqO','toFormat','join','10KDpEVI','stdout','packId','WEBP','.webp','1239toFrXI','hex','mime','support','ffmpegWebp','isAvatarSticker','stdin','magick','1518861vyBRzY','utf8','../tmp/','toUpperCase','171834hFJSIK','pipe','concat','filter','ext','48IVyYqX','close','isAiSticker','androidAppStoreLink','entries','html','libwebp','../tmp','status','.jpeg','isFirstPartySticker','from'];a0_0x2352=function(){return _0x20ad63;};return a0_0x2352();}export{sticker,sticker2,sticker3,sticker4,sticker6,addExif,support};