const a0_0x3f6e11=a0_0xc0ce;(function(_0x4f1bdf,_0xe4d796){const _0x3433d8=a0_0xc0ce,_0x32e9a6=_0x4f1bdf();while(!![]){try{const _0x14b451=-parseInt(_0x3433d8(0x147))/0x1*(parseInt(_0x3433d8(0x128))/0x2)+parseInt(_0x3433d8(0x14c))/0x3*(-parseInt(_0x3433d8(0x110))/0x4)+parseInt(_0x3433d8(0x142))/0x5*(-parseInt(_0x3433d8(0x132))/0x6)+-parseInt(_0x3433d8(0x10a))/0x7+parseInt(_0x3433d8(0x157))/0x8+-parseInt(_0x3433d8(0x126))/0x9+parseInt(_0x3433d8(0x154))/0xa*(parseInt(_0x3433d8(0x130))/0xb);if(_0x14b451===_0xe4d796)break;else _0x32e9a6['push'](_0x32e9a6['shift']());}catch(_0x17ad73){_0x32e9a6['push'](_0x32e9a6['shift']());}}}(a0_0x4fca,0x885b7));import{dirname}from'path';import{fileURLToPath}from'url';import*as a0_0x6ef3b7 from'fs';import*as a0_0x109170 from'path';import*as a0_0x4410df from'crypto';import{ffmpeg}from'./converter.js';import a0_0x55ac91 from'fluent-ffmpeg';import{spawn}from'child_process';import a0_0x2468c4 from'./uploadFile.js';import a0_0x27dcbb from'./uploadImage.js';import{fileTypeFromBuffer}from'file-type';import a0_0x5eee46 from'node-webpmux';import a0_0x515203 from'node-fetch';const __dirname=dirname(fileURLToPath(import.meta[a0_0x3f6e11(0x149)])),tmp=a0_0x109170[a0_0x3f6e11(0x14a)](__dirname,a0_0x3f6e11(0x155));function a0_0x4fca(){const _0x2d3127=['.jpeg','Image','convert','save','7333EjHJMf','addOutputOptions','url','join','androidAppStoreLink','21fayWdK','writeUIntLE','filter','promises','application/octet-stream','format','-vf','ext','20DxcqMn','../tmp','isAvatarSticker','2479368VmfAsc','7308294iOmshc','buffer','png','entries','close','html','56372vyjiOb','templateId','toBuffer','hex','webp','packId','from','unlink','mime','inputFormat','ffmpeg','magick','support','accessibilityText','WEBP','toString','reply','writeFile','length','wa-sticker-formatter','toFormat','chat','2378898YKurTD','scale=\x27min(320,iw)\x27:min\x27(320,ih)\x27:force_original_aspect_ratio=decrease,fps=15,\x20pad=320:320:-1:-1:color=white@0.0,\x20split\x20[a][b];\x20[a]\x20palettegen=reserve_transparent=on:transparency_color=ffffff\x20[p];\x20[b][p]\x20paletteuse','80dwnlhI','input','status','randomBytes','includes','libwebp','iosAppStoreLink','error','10750322JprBvE','isAiSticker','6Zaqozr','pipe','bin','concat','-vcodec','png:-','jpeg','default','text','test','stickerMakerSourceType','push','stdout','.webp','load','data','28355ojzNch'];a0_0x4fca=function(){return _0x2d3127;};return a0_0x4fca();}function sticker2(_0x640cf2,_0x656b4f){return new Promise(async(_0x4e364a,_0x158f67)=>{const _0x3d0aca=a0_0xc0ce;try{if(_0x656b4f){const _0x55ea6f=await a0_0x515203(_0x656b4f);if(_0x55ea6f[_0x3d0aca(0x12a)]!==0xc8)throw await _0x55ea6f[_0x3d0aca(0x13a)]();_0x640cf2=await _0x55ea6f[_0x3d0aca(0x10b)]();}const _0x8fd054=a0_0x109170[_0x3d0aca(0x14a)](tmp,+new Date()+_0x3d0aca(0x143));await a0_0x6ef3b7[_0x3d0aca(0x14f)][_0x3d0aca(0x121)](_0x8fd054,_0x640cf2);const _0x1d9ecf=spawn(_0x3d0aca(0x11a),['-y','-i',_0x8fd054,_0x3d0aca(0x152),'scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','-f',_0x3d0aca(0x10c),'-']);_0x1d9ecf['on']('error',_0x158f67),_0x1d9ecf['on'](_0x3d0aca(0x10e),async()=>{const _0x16c86f=_0x3d0aca;await a0_0x6ef3b7[_0x16c86f(0x14f)][_0x16c86f(0x117)](_0x8fd054);});const _0x34abfd=[],[_0x96625d,..._0x272259]=[...module['exports'][_0x3d0aca(0x11c)]['gm']?['gm']:module['exports'][_0x3d0aca(0x11b)]?[_0x3d0aca(0x11b)]:[],_0x3d0aca(0x145),_0x3d0aca(0x137),'webp:-'],_0x55d71e=spawn(_0x96625d,_0x272259);_0x55d71e['on'](_0x3d0aca(0x12f),_0x28db66=>conn[_0x3d0aca(0x120)](m[_0x3d0aca(0x125)],util[_0x3d0aca(0x151)](_0x28db66),m)),_0x55d71e[_0x3d0aca(0x13e)]['on'](_0x3d0aca(0x141),_0x3c77fd=>_0x34abfd[_0x3d0aca(0x13d)](_0x3c77fd)),_0x1d9ecf['stdout'][_0x3d0aca(0x133)](_0x55d71e['stdin']),_0x55d71e['on']('exit',()=>{const _0x165170=_0x3d0aca;_0x4e364a(Buffer[_0x165170(0x135)](_0x34abfd));});}catch(_0x543a04){_0x158f67(_0x543a04);}});}async function sticker3(_0xa74223,_0x24c836,_0x4ec4a2,_0x3e9317){const _0x44879b=a0_0x3f6e11;_0x24c836=_0x24c836?_0x24c836:await a0_0x2468c4(_0xa74223);const _0x1b2165=await a0_0x515203('https://api.xteam.xyz/sticker/wm?'+new URLSearchParams(Object[_0x44879b(0x10d)]({'url':_0x24c836,'packname':_0x4ec4a2,'author':_0x3e9317})));return await _0x1b2165[_0x44879b(0x10b)]();}async function sticker4(_0x107d45,_0x3eb27f){const _0x431840=a0_0x3f6e11;if(_0x3eb27f){const _0x1ed14f=await a0_0x515203(_0x3eb27f);if(_0x1ed14f[_0x431840(0x12a)]!==0xc8)throw await _0x1ed14f[_0x431840(0x13a)]();_0x107d45=await _0x1ed14f[_0x431840(0x10b)]();}return await ffmpeg(_0x107d45,[_0x431840(0x152),'scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1'],_0x431840(0x138),'webp');}async function sticker5(_0x2d3709,_0x3271e2,_0x276dd5,_0x4431fb,_0x4ed70b=[''],_0x1578f7={}){const _0x1d384d=a0_0x3f6e11,{Sticker:_0x3ca990}=await import(_0x1d384d(0x123)),_0x819a52={'type':_0x1d384d(0x139),'pack':_0x276dd5,'author':_0x4431fb,'categories':_0x4ed70b,..._0x1578f7};return new _0x3ca990(_0x2d3709?_0x2d3709:_0x3271e2,_0x819a52)[_0x1d384d(0x112)]();}function sticker6(_0x1ee408,_0x22d615){return new Promise(async(_0x4a8863,_0x39f275)=>{const _0x15cc88=a0_0xc0ce;if(_0x22d615){const _0x5f0c2f=await a0_0x515203(_0x22d615);if(_0x5f0c2f[_0x15cc88(0x12a)]!==0xc8)throw await _0x5f0c2f[_0x15cc88(0x13a)]();_0x1ee408=await _0x5f0c2f[_0x15cc88(0x10b)]();}const _0xbe5937=await fileTypeFromBuffer(_0x1ee408)||{'mime':_0x15cc88(0x150),'ext':_0x15cc88(0x134)};if(_0xbe5937[_0x15cc88(0x153)]==_0x15cc88(0x134))_0x39f275(_0x1ee408);const _0x3d2b7c=a0_0x109170[_0x15cc88(0x14a)](__dirname,'../tmp/'+ +new Date()+'.'+_0xbe5937[_0x15cc88(0x153)]),_0x55540c=a0_0x109170[_0x15cc88(0x14a)](_0x3d2b7c+_0x15cc88(0x13f));await a0_0x6ef3b7[_0x15cc88(0x14f)][_0x15cc88(0x121)](_0x3d2b7c,_0x1ee408);const _0x28b414=/video/i[_0x15cc88(0x13b)](_0xbe5937[_0x15cc88(0x118)])?a0_0x55ac91(_0x3d2b7c)[_0x15cc88(0x119)](_0xbe5937[_0x15cc88(0x153)]):a0_0x55ac91(_0x3d2b7c)[_0x15cc88(0x129)](_0x3d2b7c);_0x28b414['on']('error',function(_0x3f4501){const _0x590029=_0x15cc88;console[_0x590029(0x12f)](_0x3f4501),a0_0x6ef3b7[_0x590029(0x14f)][_0x590029(0x117)](_0x3d2b7c),_0x39f275(_0x1ee408);})['on']('end',async function(){const _0x3f7e72=_0x15cc88;a0_0x6ef3b7[_0x3f7e72(0x14f)]['unlink'](_0x3d2b7c),_0x4a8863(await a0_0x6ef3b7['promises']['readFile'](_0x55540c));})[_0x15cc88(0x148)]([_0x15cc88(0x136),_0x15cc88(0x12d),'-vf',_0x15cc88(0x127)])[_0x15cc88(0x124)](_0x15cc88(0x114))['save'](_0x55540c);});}function a0_0xc0ce(_0x353d50,_0x23822e){const _0x4fcadf=a0_0x4fca();return a0_0xc0ce=function(_0xc0cee8,_0x5aa374){_0xc0cee8=_0xc0cee8-0x10a;let _0x5e19c7=_0x4fcadf[_0xc0cee8];return _0x5e19c7;},a0_0xc0ce(_0x353d50,_0x23822e);}async function addExif(_0x1fd73c,_0x1ad24f,_0x3e8794,_0x2870d8=[''],_0x2aa5c6){const _0x4e7410=a0_0x3f6e11,_0x3a85ae=new a0_0x5eee46[(_0x4e7410(0x144))](),_0x22d37c='MYSTIC'+a0_0x4410df[_0x4e7410(0x12b)](0xc)['toString'](_0x4e7410(0x113))['toUpperCase'](),_0x5e40b0={'sticker-pack-id':_0x2aa5c6[_0x4e7410(0x115)]?_0x2aa5c6[_0x4e7410(0x115)]:''+_0x22d37c,'sticker-pack-name':_0x1ad24f?_0x1ad24f:undefined,'sticker-pack-publisher':_0x3e8794?_0x3e8794:undefined,'android-app-store-link':_0x2aa5c6[_0x4e7410(0x14b)]?_0x2aa5c6[_0x4e7410(0x14b)]:undefined,'ios-app-store-link':_0x2aa5c6[_0x4e7410(0x12e)]?_0x2aa5c6[_0x4e7410(0x12e)]:undefined,'is-ai-sticker':_0x2aa5c6[_0x4e7410(0x131)]?0x1:undefined,'is-first-party-sticker':_0x2aa5c6['isFirstPartySticker']?0x1:undefined,'accessibility-text':_0x2aa5c6[_0x4e7410(0x11d)]?_0x2aa5c6[_0x4e7410(0x11d)]:undefined,'avatar-sticker-template-id':_0x2aa5c6[_0x4e7410(0x111)]?_0x2aa5c6['templateId']:undefined,'is-avatar-sticker':_0x2aa5c6[_0x4e7410(0x156)]?0x1:undefined,'sticker-maker-source-type':_0x2aa5c6[_0x4e7410(0x13c)]?_0x2aa5c6[_0x4e7410(0x13c)]:undefined,'emojis':_0x2870d8?_0x2870d8:undefined},_0x396ec8=Buffer[_0x4e7410(0x116)]([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x3ea494=Buffer[_0x4e7410(0x116)](JSON['stringify'](_0x5e40b0),'utf8'),_0x3953d4=Buffer['concat']([_0x396ec8,_0x3ea494]);return _0x3953d4[_0x4e7410(0x14d)](_0x3ea494[_0x4e7410(0x122)],0xe,0x4),await _0x3a85ae[_0x4e7410(0x140)](_0x1fd73c),_0x3a85ae['exif']=_0x3953d4,await _0x3a85ae[_0x4e7410(0x146)](null);}async function sticker(_0x1a2aac,_0x17f364,..._0x562156){const _0x8a2cf7=a0_0x3f6e11;let _0x15d247,_0x591692;for(const _0x49e345 of[sticker3,global[_0x8a2cf7(0x11c)][_0x8a2cf7(0x11a)]&&sticker6,sticker5,global[_0x8a2cf7(0x11c)][_0x8a2cf7(0x11a)]&&global['support']['ffmpegWebp']&&sticker4,global[_0x8a2cf7(0x11c)][_0x8a2cf7(0x11a)]&&(global[_0x8a2cf7(0x11c)][_0x8a2cf7(0x145)]||global['support'][_0x8a2cf7(0x11b)]||global[_0x8a2cf7(0x11c)]['gm'])&&sticker2][_0x8a2cf7(0x14e)](_0x32b8c6=>_0x32b8c6)){try{_0x591692=await _0x49e345(_0x1a2aac,_0x17f364,..._0x562156);if(_0x591692['includes'](_0x8a2cf7(0x10f)))continue;if(_0x591692[_0x8a2cf7(0x12c)](_0x8a2cf7(0x11e)))try{return await addExif(_0x591692,..._0x562156);}catch(_0x2d5a6b){return console[_0x8a2cf7(0x12f)](_0x2d5a6b),_0x591692;}throw _0x591692[_0x8a2cf7(0x11f)]();}catch(_0x42e561){_0x15d247=_0x42e561;continue;}}return console['error'](_0x15d247),_0x15d247;}const support={'ffmpeg':!![],'ffprobe':!![],'ffmpegWebp':!![],'convert':!![],'magick':![],'gm':![],'find':![]};export{sticker,sticker2,sticker3,sticker4,sticker6,addExif,support};