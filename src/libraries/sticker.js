const a0_0xc40ee8=a0_0x3b6b;(function(_0x4903b1,_0x435721){const _0x1f959d=a0_0x3b6b,_0x4cc5d9=_0x4903b1();while(!![]){try{const _0x523d2f=parseInt(_0x1f959d(0xad))/0x1*(-parseInt(_0x1f959d(0xb7))/0x2)+parseInt(_0x1f959d(0x93))/0x3+-parseInt(_0x1f959d(0x8e))/0x4+-parseInt(_0x1f959d(0xb0))/0x5+-parseInt(_0x1f959d(0xab))/0x6+parseInt(_0x1f959d(0xc3))/0x7*(-parseInt(_0x1f959d(0xc4))/0x8)+parseInt(_0x1f959d(0x9d))/0x9;if(_0x523d2f===_0x435721)break;else _0x4cc5d9['push'](_0x4cc5d9['shift']());}catch(_0x359d64){_0x4cc5d9['push'](_0x4cc5d9['shift']());}}}(a0_0x2fe4,0x5bd24));import{dirname}from'path';function a0_0x3b6b(_0x41a005,_0x394789){const _0x2fe4e7=a0_0x2fe4();return a0_0x3b6b=function(_0x3b6b9f,_0x2fcc2e){_0x3b6b9f=_0x3b6b9f-0x85;let _0x32df5f=_0x2fe4e7[_0x3b6b9f];return _0x32df5f;},a0_0x3b6b(_0x41a005,_0x394789);}import{fileURLToPath}from'url';function a0_0x2fe4(){const _0x3daaaf=['readFile','ffmpegWebp','reply','buffer','data','2msYZrO','application/octet-stream','input','concat','writeFile','stickerMakerSourceType','load','default','isFirstPartySticker','WEBP','exit','png','400295GlxYxw','40esLfNr','-vf','push','.webp','stdout','status','magick','libwebp','../tmp/','../tmp','ext','error','ffmpeg','stringify','toString','toFormat','androidAppStoreLink','url','isAvatarSticker','isAiSticker','inputFormat','bin','2282688AXLIDu','templateId','mime','-vcodec','filter','609258yBvbCt','toBuffer','scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','support','MYSTIC','https://api.xteam.xyz/sticker/wm?','text','scale=\x27min(320,iw)\x27:min\x27(320,ih)\x27:force_original_aspect_ratio=decrease,fps=15,\x20pad=320:320:-1:-1:color=white@0.0,\x20split\x20[a][b];\x20[a]\x20palettegen=reserve_transparent=on:transparency_color=ffffff\x20[p];\x20[b][p]\x20paletteuse','randomBytes','exports','19317492hzLhUp','stdin','unlink','close','Image','.jpeg','end','promises','pipe','join','save','exif','length','webp','4407912iWrwoP','convert','14566hNqrqk','packId','html','1837795WLBXLM','includes'];a0_0x2fe4=function(){return _0x3daaaf;};return a0_0x2fe4();}import*as a0_0x378c91 from'fs';import*as a0_0x98aa5a from'path';import*as a0_0x48215f from'crypto';import{ffmpeg}from'./converter.js';import a0_0x24a996 from'fluent-ffmpeg';import{spawn}from'child_process';import a0_0x3c1665 from'./uploadFile.js';import a0_0x4158f5 from'./uploadImage.js';import{fileTypeFromBuffer}from'file-type';import a0_0x566885 from'node-webpmux';import a0_0x25b2f4 from'node-fetch';const __dirname=dirname(fileURLToPath(import.meta[a0_0xc40ee8(0x89)])),tmp=a0_0x98aa5a[a0_0xc40ee8(0xa6)](__dirname,a0_0xc40ee8(0xcd));function sticker2(_0x448e46,_0x2e2ec){return new Promise(async(_0x74b2dd,_0xec2c0a)=>{const _0x574f41=a0_0x3b6b;try{if(_0x2e2ec){const _0x3e1f91=await a0_0x25b2f4(_0x2e2ec);if(_0x3e1f91[_0x574f41(0xc9)]!==0xc8)throw await _0x3e1f91[_0x574f41(0x99)]();_0x448e46=await _0x3e1f91['buffer']();}const _0x55137f=a0_0x98aa5a[_0x574f41(0xa6)](tmp,+new Date()+_0x574f41(0xa2));await a0_0x378c91[_0x574f41(0xa4)][_0x574f41(0xbb)](_0x55137f,_0x448e46);const _0x4f7966=spawn(_0x574f41(0xd0),['-y','-i',_0x55137f,_0x574f41(0xc5),_0x574f41(0x95),'-f',_0x574f41(0xc2),'-']);_0x4f7966['on'](_0x574f41(0xcf),_0xec2c0a),_0x4f7966['on'](_0x574f41(0xa0),async()=>{const _0x311405=_0x574f41;await a0_0x378c91[_0x311405(0xa4)]['unlink'](_0x55137f);});const _0x5b2289=[],[_0x1a3a5b,..._0x59fde2]=[...module[_0x574f41(0x9c)][_0x574f41(0x96)]['gm']?['gm']:module[_0x574f41(0x9c)][_0x574f41(0xca)]?[_0x574f41(0xca)]:[],'convert','png:-','webp:-'],_0x487a4a=spawn(_0x1a3a5b,_0x59fde2);_0x487a4a['on'](_0x574f41(0xcf),_0x2f0bef=>conn[_0x574f41(0xb4)](m['chat'],util['format'](_0x2f0bef),m)),_0x487a4a[_0x574f41(0xc8)]['on'](_0x574f41(0xb6),_0x3f8e90=>_0x5b2289[_0x574f41(0xc6)](_0x3f8e90)),_0x4f7966['stdout'][_0x574f41(0xa5)](_0x487a4a[_0x574f41(0x9e)]),_0x487a4a['on'](_0x574f41(0xc1),()=>{const _0x234aab=_0x574f41;_0x74b2dd(Buffer[_0x234aab(0xba)](_0x5b2289));});}catch(_0x14362d){_0xec2c0a(_0x14362d);}});}async function sticker3(_0xf1577d,_0x59ae55,_0x1e1466,_0x4a4e63){const _0x168f16=a0_0xc40ee8;_0x59ae55=_0x59ae55?_0x59ae55:await a0_0x3c1665(_0xf1577d);const _0x5b34da=await a0_0x25b2f4(_0x168f16(0x98)+new URLSearchParams(Object['entries']({'url':_0x59ae55,'packname':_0x1e1466,'author':_0x4a4e63})));return await _0x5b34da['buffer']();}async function sticker4(_0x182428,_0x935a50){const _0x26be2f=a0_0xc40ee8;if(_0x935a50){const _0x5da909=await a0_0x25b2f4(_0x935a50);if(_0x5da909['status']!==0xc8)throw await _0x5da909[_0x26be2f(0x99)]();_0x182428=await _0x5da909[_0x26be2f(0xb5)]();}return await ffmpeg(_0x182428,[_0x26be2f(0xc5),_0x26be2f(0x95)],'jpeg',_0x26be2f(0xaa));}async function sticker5(_0x41b6f6,_0x36d0a6,_0x335487,_0x3ce43f,_0x20f13a=[''],_0x14fcf1={}){const _0x16bf18=a0_0xc40ee8,{Sticker:_0x2d09fe}=await import('wa-sticker-formatter'),_0x5d2956={'type':_0x16bf18(0xbe),'pack':_0x335487,'author':_0x3ce43f,'categories':_0x20f13a,..._0x14fcf1};return new _0x2d09fe(_0x41b6f6?_0x41b6f6:_0x36d0a6,_0x5d2956)[_0x16bf18(0x94)]();}function sticker6(_0x3aaa4b,_0x35f755){return new Promise(async(_0x8dd6a9,_0x3c2e08)=>{const _0x4b6631=a0_0x3b6b;if(_0x35f755){const _0x5453ab=await a0_0x25b2f4(_0x35f755);if(_0x5453ab[_0x4b6631(0xc9)]!==0xc8)throw await _0x5453ab[_0x4b6631(0x99)]();_0x3aaa4b=await _0x5453ab[_0x4b6631(0xb5)]();}const _0x2f8c60=await fileTypeFromBuffer(_0x3aaa4b)||{'mime':_0x4b6631(0xb8),'ext':_0x4b6631(0x8d)};if(_0x2f8c60[_0x4b6631(0xce)]=='bin')_0x3c2e08(_0x3aaa4b);const _0x5bc01c=a0_0x98aa5a[_0x4b6631(0xa6)](__dirname,_0x4b6631(0xcc)+ +new Date()+'.'+_0x2f8c60[_0x4b6631(0xce)]),_0x3ba3fb=a0_0x98aa5a[_0x4b6631(0xa6)](_0x5bc01c+_0x4b6631(0xc7));await a0_0x378c91[_0x4b6631(0xa4)][_0x4b6631(0xbb)](_0x5bc01c,_0x3aaa4b);const _0x14af33=/video/i['test'](_0x2f8c60[_0x4b6631(0x90)])?a0_0x24a996(_0x5bc01c)[_0x4b6631(0x8c)](_0x2f8c60[_0x4b6631(0xce)]):a0_0x24a996(_0x5bc01c)[_0x4b6631(0xb9)](_0x5bc01c);_0x14af33['on'](_0x4b6631(0xcf),function(_0x422905){console['error'](_0x422905),a0_0x378c91['promises']['unlink'](_0x5bc01c),_0x3c2e08(_0x3aaa4b);})['on'](_0x4b6631(0xa3),async function(){const _0x50fb82=_0x4b6631;a0_0x378c91[_0x50fb82(0xa4)][_0x50fb82(0x9f)](_0x5bc01c),_0x8dd6a9(await a0_0x378c91[_0x50fb82(0xa4)][_0x50fb82(0xb2)](_0x3ba3fb));})['addOutputOptions']([_0x4b6631(0x91),_0x4b6631(0xcb),_0x4b6631(0xc5),_0x4b6631(0x9a)])[_0x4b6631(0x87)](_0x4b6631(0xaa))[_0x4b6631(0xa7)](_0x3ba3fb);});}async function addExif(_0x23cec4,_0x48d34a,_0xa56f30,_0x2f9986=[''],_0xc27fda){const _0x21e6d3=a0_0xc40ee8,_0x122ac8=new a0_0x566885[(_0x21e6d3(0xa1))](),_0x3627fd=_0x21e6d3(0x97)+a0_0x48215f[_0x21e6d3(0x9b)](0xc)['toString']('hex')['toUpperCase'](),_0x189ef5={'sticker-pack-id':_0xc27fda['packId']?_0xc27fda[_0x21e6d3(0xae)]:''+_0x3627fd,'sticker-pack-name':_0x48d34a?_0x48d34a:undefined,'sticker-pack-publisher':_0xa56f30?_0xa56f30:undefined,'android-app-store-link':_0xc27fda[_0x21e6d3(0x88)]?_0xc27fda[_0x21e6d3(0x88)]:undefined,'ios-app-store-link':_0xc27fda['iosAppStoreLink']?_0xc27fda['iosAppStoreLink']:undefined,'is-ai-sticker':_0xc27fda[_0x21e6d3(0x8b)]?0x1:undefined,'is-first-party-sticker':_0xc27fda[_0x21e6d3(0xbf)]?0x1:undefined,'accessibility-text':_0xc27fda['accessibilityText']?_0xc27fda['accessibilityText']:undefined,'avatar-sticker-template-id':_0xc27fda[_0x21e6d3(0x8f)]?_0xc27fda[_0x21e6d3(0x8f)]:undefined,'is-avatar-sticker':_0xc27fda[_0x21e6d3(0x8a)]?0x1:undefined,'sticker-maker-source-type':_0xc27fda['stickerMakerSourceType']?_0xc27fda[_0x21e6d3(0xbc)]:undefined,'emojis':_0x2f9986?_0x2f9986:undefined},_0x3a378e=Buffer['from']([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x104d97=Buffer['from'](JSON[_0x21e6d3(0x85)](_0x189ef5),'utf8'),_0x5031fb=Buffer[_0x21e6d3(0xba)]([_0x3a378e,_0x104d97]);return _0x5031fb['writeUIntLE'](_0x104d97[_0x21e6d3(0xa9)],0xe,0x4),await _0x122ac8[_0x21e6d3(0xbd)](_0x23cec4),_0x122ac8[_0x21e6d3(0xa8)]=_0x5031fb,await _0x122ac8[_0x21e6d3(0xa7)](null);}async function sticker(_0x5587dd,_0x31acd9,..._0x104724){const _0x10a9a7=a0_0xc40ee8;let _0x136cba,_0x49a463;for(const _0x50709e of[sticker3,global[_0x10a9a7(0x96)][_0x10a9a7(0xd0)]&&sticker6,sticker5,global[_0x10a9a7(0x96)][_0x10a9a7(0xd0)]&&global[_0x10a9a7(0x96)][_0x10a9a7(0xb3)]&&sticker4,global[_0x10a9a7(0x96)]['ffmpeg']&&(global[_0x10a9a7(0x96)][_0x10a9a7(0xac)]||global[_0x10a9a7(0x96)][_0x10a9a7(0xca)]||global[_0x10a9a7(0x96)]['gm'])&&sticker2][_0x10a9a7(0x92)](_0x1b2765=>_0x1b2765)){try{_0x49a463=await _0x50709e(_0x5587dd,_0x31acd9,..._0x104724);if(_0x49a463[_0x10a9a7(0xb1)](_0x10a9a7(0xaf)))continue;if(_0x49a463[_0x10a9a7(0xb1)](_0x10a9a7(0xc0)))try{return await addExif(_0x49a463,..._0x104724);}catch(_0x281700){return console[_0x10a9a7(0xcf)](_0x281700),_0x49a463;}throw _0x49a463[_0x10a9a7(0x86)]();}catch(_0x3a035f){_0x136cba=_0x3a035f;continue;}}return console[_0x10a9a7(0xcf)](_0x136cba),_0x136cba;}const support={'ffmpeg':!![],'ffprobe':!![],'ffmpegWebp':!![],'convert':!![],'magick':![],'gm':![],'find':![]};export{sticker,sticker2,sticker3,sticker4,sticker6,addExif,support};