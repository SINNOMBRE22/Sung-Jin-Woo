const a0_0x35a856=a0_0x47a0;(function(_0x42ca6b,_0x47e5d9){const _0x378dc0=a0_0x47a0,_0x31590c=_0x42ca6b();while(!![]){try{const _0x364310=-parseInt(_0x378dc0(0xfa))/0x1+-parseInt(_0x378dc0(0xe2))/0x2+-parseInt(_0x378dc0(0xbf))/0x3*(-parseInt(_0x378dc0(0x100))/0x4)+parseInt(_0x378dc0(0xf5))/0x5+parseInt(_0x378dc0(0xcf))/0x6*(parseInt(_0x378dc0(0xd2))/0x7)+parseInt(_0x378dc0(0xda))/0x8*(-parseInt(_0x378dc0(0xfc))/0x9)+-parseInt(_0x378dc0(0xf2))/0xa*(-parseInt(_0x378dc0(0xbc))/0xb);if(_0x364310===_0x47e5d9)break;else _0x31590c['push'](_0x31590c['shift']());}catch(_0x5e9f43){_0x31590c['push'](_0x31590c['shift']());}}}(a0_0x5baa,0x49193));import{dirname}from'path';import{fileURLToPath}from'url';import*as a0_0x2a1b6d from'fs';import*as a0_0x4d6b7f from'path';import*as a0_0x1642c7 from'crypto';import{ffmpeg}from'./converter.js';import a0_0xc791d9 from'fluent-ffmpeg';import{spawn}from'child_process';import a0_0x2ac17c from'./uploadFile.js';function a0_0x47a0(_0x46ca07,_0x2b6193){const _0x5baa08=a0_0x5baa();return a0_0x47a0=function(_0x47a0de,_0x3c9a68){_0x47a0de=_0x47a0de-0xba;let _0x939b79=_0x5baa08[_0x47a0de];return _0x939b79;},a0_0x47a0(_0x46ca07,_0x2b6193);}import a0_0x44674b from'./uploadImage.js';import{fileTypeFromBuffer}from'file-type';import a0_0x278658 from'node-webpmux';import a0_0x6a3769 from'node-fetch';const __dirname=dirname(fileURLToPath(import.meta[a0_0x35a856(0x101)])),tmp=a0_0x4d6b7f[a0_0x35a856(0xeb)](__dirname,'../tmp');function a0_0x5baa(){const _0x117e44=['text','length','-vcodec','toString','9173692wAKtuG','scale=\x27min(320,iw)\x27:min\x27(320,ih)\x27:force_original_aspect_ratio=decrease,fps=15,\x20pad=320:320:-1:-1:color=white@0.0,\x20split\x20[a][b];\x20[a]\x20palettegen=reserve_transparent=on:transparency_color=ffffff\x20[p];\x20[b][p]\x20paletteuse','status','3IBXvJJ','error','templateId','scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','ext','support','MYSTIC','ffmpeg','entries','stringify','png:-','-vf','magick','png','reply','libwebp','882WlFREc','utf8','stdout','27090yQNvcx','save','mime','packId','Image','webp:-','hex','webp','3719208VAQPpV','includes','concat','input','toUpperCase','iosAppStoreLink','default','buffer','633468cMGJaS','exports','convert','jpeg','isAvatarSticker','from','end','accessibilityText','filter','join','isFirstPartySticker','pipe','format','isAiSticker','.jpeg','.webp','10BQpOSv','close','promises','622375LjBWsu','writeFile','toFormat','addOutputOptions','https://api.xteam.xyz/sticker/wm?','499541YBSdyi','stdin','9fOzrpP','data','test','writeUIntLE','213000OeVnfb','url','stickerMakerSourceType','androidAppStoreLink','unlink'];a0_0x5baa=function(){return _0x117e44;};return a0_0x5baa();}function sticker2(_0x3ad617,_0x239d2f){return new Promise(async(_0x423bc7,_0x197623)=>{const _0x18f401=a0_0x47a0;try{if(_0x239d2f){const _0x475080=await a0_0x6a3769(_0x239d2f);if(_0x475080[_0x18f401(0xbe)]!==0xc8)throw await _0x475080[_0x18f401(0x105)]();_0x3ad617=await _0x475080['buffer']();}const _0x300f87=a0_0x4d6b7f[_0x18f401(0xeb)](tmp,+new Date()+_0x18f401(0xf0));await a0_0x2a1b6d[_0x18f401(0xf4)][_0x18f401(0xf6)](_0x300f87,_0x3ad617);const _0x46c9e2=spawn(_0x18f401(0xc6),['-y','-i',_0x300f87,_0x18f401(0xca),'scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','-f',_0x18f401(0xcc),'-']);_0x46c9e2['on'](_0x18f401(0xc0),_0x197623),_0x46c9e2['on'](_0x18f401(0xf3),async()=>{const _0x563fd5=_0x18f401;await a0_0x2a1b6d[_0x563fd5(0xf4)][_0x563fd5(0x104)](_0x300f87);});const _0x372c2f=[],[_0x579092,..._0x30bd9b]=[...module[_0x18f401(0xe3)][_0x18f401(0xc4)]['gm']?['gm']:module[_0x18f401(0xe3)][_0x18f401(0xcb)]?[_0x18f401(0xcb)]:[],_0x18f401(0xe4),_0x18f401(0xc9),_0x18f401(0xd7)],_0x21e4b9=spawn(_0x579092,_0x30bd9b);_0x21e4b9['on'](_0x18f401(0xc0),_0x47612d=>conn[_0x18f401(0xcd)](m['chat'],util[_0x18f401(0xee)](_0x47612d),m)),_0x21e4b9[_0x18f401(0xd1)]['on'](_0x18f401(0xfd),_0x281740=>_0x372c2f['push'](_0x281740)),_0x46c9e2[_0x18f401(0xd1)][_0x18f401(0xed)](_0x21e4b9[_0x18f401(0xfb)]),_0x21e4b9['on']('exit',()=>{_0x423bc7(Buffer['concat'](_0x372c2f));});}catch(_0x5b02b3){_0x197623(_0x5b02b3);}});}async function sticker3(_0x2c6ae5,_0x292841,_0x799fce,_0x6623f5){const _0x501cab=a0_0x35a856;_0x292841=_0x292841?_0x292841:await a0_0x2ac17c(_0x2c6ae5);const _0x171916=await a0_0x6a3769(_0x501cab(0xf9)+new URLSearchParams(Object[_0x501cab(0xc7)]({'url':_0x292841,'packname':_0x799fce,'author':_0x6623f5})));return await _0x171916[_0x501cab(0xe1)]();}async function sticker4(_0x13cc85,_0x245bc7){const _0x482ab2=a0_0x35a856;if(_0x245bc7){const _0x3a8448=await a0_0x6a3769(_0x245bc7);if(_0x3a8448[_0x482ab2(0xbe)]!==0xc8)throw await _0x3a8448[_0x482ab2(0x105)]();_0x13cc85=await _0x3a8448[_0x482ab2(0xe1)]();}return await ffmpeg(_0x13cc85,[_0x482ab2(0xca),_0x482ab2(0xc2)],_0x482ab2(0xe5),'webp');}async function sticker5(_0xcf7aa,_0x110dfe,_0xc3581,_0x485b3d,_0xf6e723=[''],_0x5145fb={}){const _0x25d829=a0_0x35a856,{Sticker:_0x3d9be1}=await import('wa-sticker-formatter'),_0x1cdfaf={'type':_0x25d829(0xe0),'pack':_0xc3581,'author':_0x485b3d,'categories':_0xf6e723,..._0x5145fb};return new _0x3d9be1(_0xcf7aa?_0xcf7aa:_0x110dfe,_0x1cdfaf)['toBuffer']();}function sticker6(_0x405f76,_0x150916){return new Promise(async(_0x207ae9,_0x28647d)=>{const _0x1fc010=a0_0x47a0;if(_0x150916){const _0x61b7f7=await a0_0x6a3769(_0x150916);if(_0x61b7f7['status']!==0xc8)throw await _0x61b7f7[_0x1fc010(0x105)]();_0x405f76=await _0x61b7f7[_0x1fc010(0xe1)]();}const _0x5e7d09=await fileTypeFromBuffer(_0x405f76)||{'mime':'application/octet-stream','ext':'bin'};if(_0x5e7d09['ext']=='bin')_0x28647d(_0x405f76);const _0x2f197d=a0_0x4d6b7f['join'](__dirname,'../tmp/'+ +new Date()+'.'+_0x5e7d09[_0x1fc010(0xc3)]),_0x493080=a0_0x4d6b7f[_0x1fc010(0xeb)](_0x2f197d+_0x1fc010(0xf1));await a0_0x2a1b6d[_0x1fc010(0xf4)]['writeFile'](_0x2f197d,_0x405f76);const _0xff35c8=/video/i[_0x1fc010(0xfe)](_0x5e7d09[_0x1fc010(0xd4)])?a0_0xc791d9(_0x2f197d)['inputFormat'](_0x5e7d09[_0x1fc010(0xc3)]):a0_0xc791d9(_0x2f197d)[_0x1fc010(0xdd)](_0x2f197d);_0xff35c8['on'](_0x1fc010(0xc0),function(_0x52b397){const _0x5ae9d7=_0x1fc010;console[_0x5ae9d7(0xc0)](_0x52b397),a0_0x2a1b6d[_0x5ae9d7(0xf4)][_0x5ae9d7(0x104)](_0x2f197d),_0x28647d(_0x405f76);})['on'](_0x1fc010(0xe8),async function(){const _0x55b4f8=_0x1fc010;a0_0x2a1b6d[_0x55b4f8(0xf4)]['unlink'](_0x2f197d),_0x207ae9(await a0_0x2a1b6d[_0x55b4f8(0xf4)]['readFile'](_0x493080));})[_0x1fc010(0xf8)]([_0x1fc010(0xba),_0x1fc010(0xce),_0x1fc010(0xca),_0x1fc010(0xbd)])[_0x1fc010(0xf7)](_0x1fc010(0xd9))[_0x1fc010(0xd3)](_0x493080);});}async function addExif(_0x3af65f,_0x26a8dd,_0x45508b,_0x487fdd=[''],_0x49b0df){const _0x14f25a=a0_0x35a856,_0x361146=new a0_0x278658[(_0x14f25a(0xd6))](),_0x1d0d15=_0x14f25a(0xc5)+a0_0x1642c7['randomBytes'](0xc)[_0x14f25a(0xbb)](_0x14f25a(0xd8))[_0x14f25a(0xde)](),_0x1fb30b={'sticker-pack-id':_0x49b0df[_0x14f25a(0xd5)]?_0x49b0df[_0x14f25a(0xd5)]:''+_0x1d0d15,'sticker-pack-name':_0x26a8dd?_0x26a8dd:undefined,'sticker-pack-publisher':_0x45508b?_0x45508b:undefined,'android-app-store-link':_0x49b0df[_0x14f25a(0x103)]?_0x49b0df[_0x14f25a(0x103)]:undefined,'ios-app-store-link':_0x49b0df[_0x14f25a(0xdf)]?_0x49b0df[_0x14f25a(0xdf)]:undefined,'is-ai-sticker':_0x49b0df[_0x14f25a(0xef)]?0x1:undefined,'is-first-party-sticker':_0x49b0df[_0x14f25a(0xec)]?0x1:undefined,'accessibility-text':_0x49b0df[_0x14f25a(0xe9)]?_0x49b0df['accessibilityText']:undefined,'avatar-sticker-template-id':_0x49b0df[_0x14f25a(0xc1)]?_0x49b0df[_0x14f25a(0xc1)]:undefined,'is-avatar-sticker':_0x49b0df[_0x14f25a(0xe6)]?0x1:undefined,'sticker-maker-source-type':_0x49b0df[_0x14f25a(0x102)]?_0x49b0df[_0x14f25a(0x102)]:undefined,'emojis':_0x487fdd?_0x487fdd:undefined},_0x48da3f=Buffer['from']([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x472218=Buffer[_0x14f25a(0xe7)](JSON[_0x14f25a(0xc8)](_0x1fb30b),_0x14f25a(0xd0)),_0x96be6c=Buffer[_0x14f25a(0xdc)]([_0x48da3f,_0x472218]);return _0x96be6c[_0x14f25a(0xff)](_0x472218[_0x14f25a(0x106)],0xe,0x4),await _0x361146['load'](_0x3af65f),_0x361146['exif']=_0x96be6c,await _0x361146['save'](null);}async function sticker(_0xdc2b64,_0x13ed40,..._0x2c8432){const _0x2e0086=a0_0x35a856;let _0x41a52b,_0x1310dc;for(const _0x55a72c of[sticker3,global[_0x2e0086(0xc4)][_0x2e0086(0xc6)]&&sticker6,sticker5,global[_0x2e0086(0xc4)][_0x2e0086(0xc6)]&&global[_0x2e0086(0xc4)]['ffmpegWebp']&&sticker4,global[_0x2e0086(0xc4)]['ffmpeg']&&(global[_0x2e0086(0xc4)]['convert']||global[_0x2e0086(0xc4)]['magick']||global[_0x2e0086(0xc4)]['gm'])&&sticker2][_0x2e0086(0xea)](_0xf05bdc=>_0xf05bdc)){try{_0x1310dc=await _0x55a72c(_0xdc2b64,_0x13ed40,..._0x2c8432);if(_0x1310dc[_0x2e0086(0xdb)]('html'))continue;if(_0x1310dc[_0x2e0086(0xdb)]('WEBP'))try{return await addExif(_0x1310dc,..._0x2c8432);}catch(_0xaa4271){return console[_0x2e0086(0xc0)](_0xaa4271),_0x1310dc;}throw _0x1310dc[_0x2e0086(0xbb)]();}catch(_0x2b516e){_0x41a52b=_0x2b516e;continue;}}return console[_0x2e0086(0xc0)](_0x41a52b),_0x41a52b;}const support={'ffmpeg':!![],'ffprobe':!![],'ffmpegWebp':!![],'convert':!![],'magick':![],'gm':![],'find':![]};export{sticker,sticker2,sticker3,sticker4,sticker6,addExif,support};