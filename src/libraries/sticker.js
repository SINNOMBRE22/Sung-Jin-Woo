const a0_0x432238=a0_0x1a92;(function(_0x276fc6,_0x2d34ce){const _0x1e82c4=a0_0x1a92,_0x2551cf=_0x276fc6();while(!![]){try{const _0x599266=parseInt(_0x1e82c4(0xb3))/0x1*(parseInt(_0x1e82c4(0xa0))/0x2)+parseInt(_0x1e82c4(0x87))/0x3+-parseInt(_0x1e82c4(0x9f))/0x4*(parseInt(_0x1e82c4(0x95))/0x5)+parseInt(_0x1e82c4(0x90))/0x6*(parseInt(_0x1e82c4(0x73))/0x7)+parseInt(_0x1e82c4(0x88))/0x8+parseInt(_0x1e82c4(0xa6))/0x9*(parseInt(_0x1e82c4(0xae))/0xa)+-parseInt(_0x1e82c4(0xa9))/0xb;if(_0x599266===_0x2d34ce)break;else _0x2551cf['push'](_0x2551cf['shift']());}catch(_0x55fc60){_0x2551cf['push'](_0x2551cf['shift']());}}}(a0_0xede3,0x25be1));import{dirname}from'path';import{fileURLToPath}from'url';import*as a0_0x2bf9c0 from'fs';import*as a0_0x27a3c2 from'path';import*as a0_0x5096ef from'crypto';import{ffmpeg}from'./converter.js';import a0_0x30cf94 from'fluent-ffmpeg';import{spawn}from'child_process';function a0_0xede3(){const _0x54c442=['ffmpegWebp','from','scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','3020ifEEab','isAvatarSticker','filter','save','unlink','length','templateId','androidAppStoreLink','MYSTIC','WEBP','1688jerGeG','3062EpcKzn','data','-vcodec','toBuffer','join','accessibilityText','16191sJnlxS','writeFile','includes','7041045bzkcBc','exports','test','ffmpeg','concat','770teaeRh','toString','ext','utf8','toFormat','79OLqLFI','entries','close','html','writeUIntLE','readFile','magick','input','webp:-','png:-','convert','error','Image','toUpperCase','exit','promises','stringify','stickerMakerSourceType','end','756xznXEJ','-vf','buffer','text','hex','exif','libwebp','isFirstPartySticker','default','chat','push','../tmp/','scale=\x27min(320,iw)\x27:min\x27(320,ih)\x27:force_original_aspect_ratio=decrease,fps=15,\x20pad=320:320:-1:-1:color=white@0.0,\x20split\x20[a][b];\x20[a]\x20palettegen=reserve_transparent=on:transparency_color=ffffff\x20[p];\x20[b][p]\x20paletteuse','wa-sticker-formatter','../tmp','mime','webp','load','bin','https://api.xteam.xyz/sticker/wm?','920268rDEpHd','2183712PWpVpX','support','.webp','packId','iosAppStoreLink','stdout','status','png','11688lpfemb','inputFormat'];a0_0xede3=function(){return _0x54c442;};return a0_0xede3();}import a0_0x2d9e75 from'./uploadFile.js';import a0_0x1da0c4 from'./uploadImage.js';import{fileTypeFromBuffer}from'file-type';import a0_0xd964fe from'node-webpmux';function a0_0x1a92(_0xd8ff95,_0x1baaf0){const _0xede3b6=a0_0xede3();return a0_0x1a92=function(_0x1a92e4,_0x1dee6c){_0x1a92e4=_0x1a92e4-0x67;let _0x2a79a0=_0xede3b6[_0x1a92e4];return _0x2a79a0;},a0_0x1a92(_0xd8ff95,_0x1baaf0);}import a0_0x6bf4d7 from'node-fetch';const __dirname=dirname(fileURLToPath(import.meta['url'])),tmp=a0_0x27a3c2['join'](__dirname,a0_0x432238(0x81));function sticker2(_0xc8a072,_0x1a2911){return new Promise(async(_0x2ed214,_0x3ba248)=>{const _0x4c0f50=a0_0x1a92;try{if(_0x1a2911){const _0x57e9ca=await a0_0x6bf4d7(_0x1a2911);if(_0x57e9ca['status']!==0xc8)throw await _0x57e9ca[_0x4c0f50(0x76)]();_0xc8a072=await _0x57e9ca['buffer']();}const _0x877fb2=a0_0x27a3c2[_0x4c0f50(0xa4)](tmp,+new Date()+'.jpeg');await a0_0x2bf9c0[_0x4c0f50(0x6f)][_0x4c0f50(0xa7)](_0x877fb2,_0xc8a072);const _0x5586ea=spawn(_0x4c0f50(0xac),['-y','-i',_0x877fb2,'-vf',_0x4c0f50(0x94),'-f',_0x4c0f50(0x8f),'-']);_0x5586ea['on'](_0x4c0f50(0x6b),_0x3ba248),_0x5586ea['on'](_0x4c0f50(0xb5),async()=>{const _0x17b522=_0x4c0f50;await a0_0x2bf9c0['promises'][_0x17b522(0x99)](_0x877fb2);});const _0x1a81df=[],[_0x46db13,..._0x34bed3]=[...module[_0x4c0f50(0xaa)][_0x4c0f50(0x89)]['gm']?['gm']:module[_0x4c0f50(0xaa)][_0x4c0f50(0xb9)]?[_0x4c0f50(0xb9)]:[],_0x4c0f50(0x6a),_0x4c0f50(0x69),_0x4c0f50(0x68)],_0x41d545=spawn(_0x46db13,_0x34bed3);_0x41d545['on'](_0x4c0f50(0x6b),_0x5e923e=>conn['reply'](m[_0x4c0f50(0x7c)],util['format'](_0x5e923e),m)),_0x41d545[_0x4c0f50(0x8d)]['on'](_0x4c0f50(0xa1),_0x3c583d=>_0x1a81df[_0x4c0f50(0x7d)](_0x3c583d)),_0x5586ea[_0x4c0f50(0x8d)]['pipe'](_0x41d545['stdin']),_0x41d545['on'](_0x4c0f50(0x6e),()=>{_0x2ed214(Buffer['concat'](_0x1a81df));});}catch(_0x21ad25){_0x3ba248(_0x21ad25);}});}async function sticker3(_0x5bd925,_0x236713,_0x100c77,_0x15cba7){const _0x25e58d=a0_0x432238;_0x236713=_0x236713?_0x236713:await a0_0x2d9e75(_0x5bd925);const _0x42bd48=await a0_0x6bf4d7(_0x25e58d(0x86)+new URLSearchParams(Object[_0x25e58d(0xb4)]({'url':_0x236713,'packname':_0x100c77,'author':_0x15cba7})));return await _0x42bd48[_0x25e58d(0x75)]();}async function sticker4(_0xb56493,_0x3f941a){const _0x127997=a0_0x432238;if(_0x3f941a){const _0x38cd85=await a0_0x6bf4d7(_0x3f941a);if(_0x38cd85[_0x127997(0x8e)]!==0xc8)throw await _0x38cd85[_0x127997(0x76)]();_0xb56493=await _0x38cd85[_0x127997(0x75)]();}return await ffmpeg(_0xb56493,[_0x127997(0x74),_0x127997(0x94)],'jpeg','webp');}async function sticker5(_0x2e0bb1,_0x2b7e54,_0x1fead3,_0x1d8f5d,_0x3f822e=[''],_0x19c1b4={}){const _0x2a23a1=a0_0x432238,{Sticker:_0x1287b2}=await import(_0x2a23a1(0x80)),_0x52da5d={'type':_0x2a23a1(0x7b),'pack':_0x1fead3,'author':_0x1d8f5d,'categories':_0x3f822e,..._0x19c1b4};return new _0x1287b2(_0x2e0bb1?_0x2e0bb1:_0x2b7e54,_0x52da5d)[_0x2a23a1(0xa3)]();}function sticker6(_0x152814,_0xed6f60){return new Promise(async(_0x5a8c3f,_0x281659)=>{const _0x2ee83e=a0_0x1a92;if(_0xed6f60){const _0x30323e=await a0_0x6bf4d7(_0xed6f60);if(_0x30323e[_0x2ee83e(0x8e)]!==0xc8)throw await _0x30323e[_0x2ee83e(0x76)]();_0x152814=await _0x30323e[_0x2ee83e(0x75)]();}const _0x4bab76=await fileTypeFromBuffer(_0x152814)||{'mime':'application/octet-stream','ext':_0x2ee83e(0x85)};if(_0x4bab76[_0x2ee83e(0xb0)]==_0x2ee83e(0x85))_0x281659(_0x152814);const _0x203e09=a0_0x27a3c2['join'](__dirname,_0x2ee83e(0x7e)+ +new Date()+'.'+_0x4bab76[_0x2ee83e(0xb0)]),_0x3b599e=a0_0x27a3c2[_0x2ee83e(0xa4)](_0x203e09+_0x2ee83e(0x8a));await a0_0x2bf9c0[_0x2ee83e(0x6f)][_0x2ee83e(0xa7)](_0x203e09,_0x152814);const _0x10212b=/video/i[_0x2ee83e(0xab)](_0x4bab76[_0x2ee83e(0x82)])?a0_0x30cf94(_0x203e09)[_0x2ee83e(0x91)](_0x4bab76[_0x2ee83e(0xb0)]):a0_0x30cf94(_0x203e09)[_0x2ee83e(0x67)](_0x203e09);_0x10212b['on'](_0x2ee83e(0x6b),function(_0x5554c0){const _0x902e35=_0x2ee83e;console[_0x902e35(0x6b)](_0x5554c0),a0_0x2bf9c0['promises']['unlink'](_0x203e09),_0x281659(_0x152814);})['on'](_0x2ee83e(0x72),async function(){const _0x1f9543=_0x2ee83e;a0_0x2bf9c0['promises']['unlink'](_0x203e09),_0x5a8c3f(await a0_0x2bf9c0['promises'][_0x1f9543(0xb8)](_0x3b599e));})['addOutputOptions']([_0x2ee83e(0xa2),_0x2ee83e(0x79),_0x2ee83e(0x74),_0x2ee83e(0x7f)])[_0x2ee83e(0xb2)](_0x2ee83e(0x83))['save'](_0x3b599e);});}async function addExif(_0x348453,_0xcd641e,_0x7a2fc3,_0x2d4dba=[''],_0x12e89f){const _0x608c63=a0_0x432238,_0x4b34f0=new a0_0xd964fe[(_0x608c63(0x6c))](),_0x3ec528=_0x608c63(0x9d)+a0_0x5096ef['randomBytes'](0xc)[_0x608c63(0xaf)](_0x608c63(0x77))[_0x608c63(0x6d)](),_0x45ff94={'sticker-pack-id':_0x12e89f[_0x608c63(0x8b)]?_0x12e89f[_0x608c63(0x8b)]:''+_0x3ec528,'sticker-pack-name':_0xcd641e?_0xcd641e:undefined,'sticker-pack-publisher':_0x7a2fc3?_0x7a2fc3:undefined,'android-app-store-link':_0x12e89f[_0x608c63(0x9c)]?_0x12e89f['androidAppStoreLink']:undefined,'ios-app-store-link':_0x12e89f['iosAppStoreLink']?_0x12e89f[_0x608c63(0x8c)]:undefined,'is-ai-sticker':_0x12e89f['isAiSticker']?0x1:undefined,'is-first-party-sticker':_0x12e89f[_0x608c63(0x7a)]?0x1:undefined,'accessibility-text':_0x12e89f[_0x608c63(0xa5)]?_0x12e89f[_0x608c63(0xa5)]:undefined,'avatar-sticker-template-id':_0x12e89f['templateId']?_0x12e89f[_0x608c63(0x9b)]:undefined,'is-avatar-sticker':_0x12e89f[_0x608c63(0x96)]?0x1:undefined,'sticker-maker-source-type':_0x12e89f[_0x608c63(0x71)]?_0x12e89f[_0x608c63(0x71)]:undefined,'emojis':_0x2d4dba?_0x2d4dba:undefined},_0x18330f=Buffer[_0x608c63(0x93)]([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x3a64fd=Buffer['from'](JSON[_0x608c63(0x70)](_0x45ff94),_0x608c63(0xb1)),_0x24f18f=Buffer[_0x608c63(0xad)]([_0x18330f,_0x3a64fd]);return _0x24f18f[_0x608c63(0xb7)](_0x3a64fd[_0x608c63(0x9a)],0xe,0x4),await _0x4b34f0[_0x608c63(0x84)](_0x348453),_0x4b34f0[_0x608c63(0x78)]=_0x24f18f,await _0x4b34f0[_0x608c63(0x98)](null);}async function sticker(_0x19430b,_0x56228f,..._0x332681){const _0x4de246=a0_0x432238;let _0x15937b,_0x5dfae7;for(const _0x47bf02 of[sticker3,global[_0x4de246(0x89)][_0x4de246(0xac)]&&sticker6,sticker5,global[_0x4de246(0x89)][_0x4de246(0xac)]&&global[_0x4de246(0x89)][_0x4de246(0x92)]&&sticker4,global[_0x4de246(0x89)]['ffmpeg']&&(global[_0x4de246(0x89)][_0x4de246(0x6a)]||global[_0x4de246(0x89)][_0x4de246(0xb9)]||global['support']['gm'])&&sticker2][_0x4de246(0x97)](_0x575759=>_0x575759)){try{_0x5dfae7=await _0x47bf02(_0x19430b,_0x56228f,..._0x332681);if(_0x5dfae7[_0x4de246(0xa8)](_0x4de246(0xb6)))continue;if(_0x5dfae7[_0x4de246(0xa8)](_0x4de246(0x9e)))try{return await addExif(_0x5dfae7,..._0x332681);}catch(_0x2c8998){return console[_0x4de246(0x6b)](_0x2c8998),_0x5dfae7;}throw _0x5dfae7[_0x4de246(0xaf)]();}catch(_0x1ade83){_0x15937b=_0x1ade83;continue;}}return console[_0x4de246(0x6b)](_0x15937b),_0x15937b;}const support={'ffmpeg':!![],'ffprobe':!![],'ffmpegWebp':!![],'convert':!![],'magick':![],'gm':![],'find':![]};export{sticker,sticker2,sticker3,sticker4,sticker6,addExif,support};