const a0_0x17dd58=a0_0x4f5c;(function(_0x45d2d9,_0x4f675c){const _0x4aae4a=a0_0x4f5c,_0xdcb99a=_0x45d2d9();while(!![]){try{const _0x5bcab9=-parseInt(_0x4aae4a(0x1a5))/0x1+parseInt(_0x4aae4a(0x1b0))/0x2*(-parseInt(_0x4aae4a(0x165))/0x3)+parseInt(_0x4aae4a(0x19f))/0x4*(parseInt(_0x4aae4a(0x183))/0x5)+-parseInt(_0x4aae4a(0x18e))/0x6*(parseInt(_0x4aae4a(0x17a))/0x7)+parseInt(_0x4aae4a(0x16a))/0x8+parseInt(_0x4aae4a(0x17e))/0x9*(-parseInt(_0x4aae4a(0x19c))/0xa)+parseInt(_0x4aae4a(0x195))/0xb;if(_0x5bcab9===_0x4f675c)break;else _0xdcb99a['push'](_0xdcb99a['shift']());}catch(_0x3dcd9a){_0xdcb99a['push'](_0xdcb99a['shift']());}}}(a0_0x8571,0x79058));import{dirname}from'path';import{fileURLToPath}from'url';import*as a0_0x4e655a from'fs';import*as a0_0x25c8e1 from'path';import*as a0_0x4baac7 from'crypto';import{ffmpeg}from'./converter.js';import a0_0x312c03 from'fluent-ffmpeg';import{spawn}from'child_process';import a0_0x3da36e from'./uploadFile.js';import a0_0x15f0ea from'./uploadImage.js';import{fileTypeFromBuffer}from'file-type';import a0_0x557434 from'node-webpmux';import a0_0x324d17 from'node-fetch';const __dirname=dirname(fileURLToPath(import.meta['url'])),tmp=a0_0x25c8e1[a0_0x17dd58(0x16e)](__dirname,a0_0x17dd58(0x189));function sticker2(_0x9cf623,_0x41836c){return new Promise(async(_0x4f29fe,_0x531701)=>{const _0x125d49=a0_0x4f5c;try{if(_0x41836c){const _0x4f8f5e=await a0_0x324d17(_0x41836c);if(_0x4f8f5e[_0x125d49(0x1a6)]!==0xc8)throw await _0x4f8f5e[_0x125d49(0x168)]();_0x9cf623=await _0x4f8f5e[_0x125d49(0x187)]();}const _0x575bbe=a0_0x25c8e1[_0x125d49(0x16e)](tmp,+new Date()+'.jpeg');await a0_0x4e655a[_0x125d49(0x18f)][_0x125d49(0x197)](_0x575bbe,_0x9cf623);const _0x51faeb=spawn(_0x125d49(0x16b),['-y','-i',_0x575bbe,_0x125d49(0x1af),'scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','-f',_0x125d49(0x1ac),'-']);_0x51faeb['on'](_0x125d49(0x19d),_0x531701),_0x51faeb['on'](_0x125d49(0x181),async()=>{const _0x4add79=_0x125d49;await a0_0x4e655a['promises'][_0x4add79(0x169)](_0x575bbe);});const _0x5e5d37=[],[_0x1c4ef8,..._0x58e955]=[...module[_0x125d49(0x1a9)][_0x125d49(0x1a3)]['gm']?['gm']:module['exports'][_0x125d49(0x1aa)]?[_0x125d49(0x1aa)]:[],_0x125d49(0x190),'png:-',_0x125d49(0x184)],_0x2b724c=spawn(_0x1c4ef8,_0x58e955);_0x2b724c['on']('error',_0x86e53b=>conn[_0x125d49(0x1a4)](m[_0x125d49(0x19e)],util['format'](_0x86e53b),m)),_0x2b724c[_0x125d49(0x18a)]['on'](_0x125d49(0x182),_0x604c7e=>_0x5e5d37[_0x125d49(0x16d)](_0x604c7e)),_0x51faeb[_0x125d49(0x18a)]['pipe'](_0x2b724c[_0x125d49(0x17b)]),_0x2b724c['on'](_0x125d49(0x1b2),()=>{const _0x26d916=_0x125d49;_0x4f29fe(Buffer[_0x26d916(0x17f)](_0x5e5d37));});}catch(_0x313881){_0x531701(_0x313881);}});}function a0_0x4f5c(_0x344570,_0x1729b3){const _0x857165=a0_0x8571();return a0_0x4f5c=function(_0x4f5c80,_0x28f63b){_0x4f5c80=_0x4f5c80-0x163;let _0x496d07=_0x857165[_0x4f5c80];return _0x496d07;},a0_0x4f5c(_0x344570,_0x1729b3);}async function sticker3(_0x123252,_0x2f0c8b,_0x407e7f,_0x408310){const _0x19e0f9=a0_0x17dd58;_0x2f0c8b=_0x2f0c8b?_0x2f0c8b:await a0_0x3da36e(_0x123252);const _0x65fe18=await a0_0x324d17(_0x19e0f9(0x188)+new URLSearchParams(Object[_0x19e0f9(0x1ad)]({'url':_0x2f0c8b,'packname':_0x407e7f,'author':_0x408310})));return await _0x65fe18['buffer']();}async function sticker4(_0x520fa1,_0x506353){const _0x1de81f=a0_0x17dd58;if(_0x506353){const _0x57a614=await a0_0x324d17(_0x506353);if(_0x57a614[_0x1de81f(0x1a6)]!==0xc8)throw await _0x57a614[_0x1de81f(0x168)]();_0x520fa1=await _0x57a614[_0x1de81f(0x187)]();}return await ffmpeg(_0x520fa1,['-vf',_0x1de81f(0x17c)],'jpeg',_0x1de81f(0x16f));}async function sticker5(_0x26f57b,_0x6f7102,_0x415d59,_0x6f139c,_0xf65049=[''],_0x50a51e={}){const _0x1d96f7=a0_0x17dd58,{Sticker:_0xe71331}=await import(_0x1d96f7(0x166)),_0x31eab3={'type':_0x1d96f7(0x192),'pack':_0x415d59,'author':_0x6f139c,'categories':_0xf65049,..._0x50a51e};return new _0xe71331(_0x26f57b?_0x26f57b:_0x6f7102,_0x31eab3)[_0x1d96f7(0x171)]();}function sticker6(_0x2dbccd,_0x4bbe0b){return new Promise(async(_0x41f477,_0x280d17)=>{const _0x47e52f=a0_0x4f5c;if(_0x4bbe0b){const _0x2059a7=await a0_0x324d17(_0x4bbe0b);if(_0x2059a7[_0x47e52f(0x1a6)]!==0xc8)throw await _0x2059a7[_0x47e52f(0x168)]();_0x2dbccd=await _0x2059a7['buffer']();}const _0x2a018e=await fileTypeFromBuffer(_0x2dbccd)||{'mime':_0x47e52f(0x1a2),'ext':_0x47e52f(0x1ab)};if(_0x2a018e[_0x47e52f(0x180)]=='bin')_0x280d17(_0x2dbccd);const _0x1d82af=a0_0x25c8e1[_0x47e52f(0x16e)](__dirname,_0x47e52f(0x193)+ +new Date()+'.'+_0x2a018e[_0x47e52f(0x180)]),_0x43e0c5=a0_0x25c8e1[_0x47e52f(0x16e)](_0x1d82af+_0x47e52f(0x1ae));await a0_0x4e655a['promises'][_0x47e52f(0x197)](_0x1d82af,_0x2dbccd);const _0x2570c4=/video/i[_0x47e52f(0x175)](_0x2a018e[_0x47e52f(0x1a7)])?a0_0x312c03(_0x1d82af)[_0x47e52f(0x179)](_0x2a018e[_0x47e52f(0x180)]):a0_0x312c03(_0x1d82af)[_0x47e52f(0x17d)](_0x1d82af);_0x2570c4['on'](_0x47e52f(0x19d),function(_0x44cf84){const _0x42414b=_0x47e52f;console[_0x42414b(0x19d)](_0x44cf84),a0_0x4e655a[_0x42414b(0x18f)][_0x42414b(0x169)](_0x1d82af),_0x280d17(_0x2dbccd);})['on'](_0x47e52f(0x16c),async function(){const _0xeb1ae6=_0x47e52f;a0_0x4e655a['promises'][_0xeb1ae6(0x169)](_0x1d82af),_0x41f477(await a0_0x4e655a[_0xeb1ae6(0x18f)][_0xeb1ae6(0x198)](_0x43e0c5));})[_0x47e52f(0x18d)]([_0x47e52f(0x19a),_0x47e52f(0x163),_0x47e52f(0x1af),_0x47e52f(0x199)])['toFormat'](_0x47e52f(0x16f))[_0x47e52f(0x176)](_0x43e0c5);});}async function addExif(_0xa5cf08,_0x36e68a,_0x5445bd,_0x4c491c=[''],_0x37ccd3){const _0x2b41a2=a0_0x17dd58,_0x2d81da=new a0_0x557434['Image'](),_0x4e8702=_0x2b41a2(0x173)+a0_0x4baac7[_0x2b41a2(0x19b)](0xc)[_0x2b41a2(0x167)](_0x2b41a2(0x172))[_0x2b41a2(0x1b1)](),_0x165300={'sticker-pack-id':_0x37ccd3[_0x2b41a2(0x186)]?_0x37ccd3[_0x2b41a2(0x186)]:''+_0x4e8702,'sticker-pack-name':_0x36e68a?_0x36e68a:undefined,'sticker-pack-publisher':_0x5445bd?_0x5445bd:undefined,'android-app-store-link':_0x37ccd3[_0x2b41a2(0x1a8)]?_0x37ccd3[_0x2b41a2(0x1a8)]:undefined,'ios-app-store-link':_0x37ccd3[_0x2b41a2(0x178)]?_0x37ccd3[_0x2b41a2(0x178)]:undefined,'is-ai-sticker':_0x37ccd3[_0x2b41a2(0x194)]?0x1:undefined,'is-first-party-sticker':_0x37ccd3['isFirstPartySticker']?0x1:undefined,'accessibility-text':_0x37ccd3[_0x2b41a2(0x191)]?_0x37ccd3[_0x2b41a2(0x191)]:undefined,'avatar-sticker-template-id':_0x37ccd3[_0x2b41a2(0x185)]?_0x37ccd3['templateId']:undefined,'is-avatar-sticker':_0x37ccd3[_0x2b41a2(0x18b)]?0x1:undefined,'sticker-maker-source-type':_0x37ccd3['stickerMakerSourceType']?_0x37ccd3[_0x2b41a2(0x1a1)]:undefined,'emojis':_0x4c491c?_0x4c491c:undefined},_0x20b969=Buffer['from']([0x49,0x49,0x2a,0x0,0x8,0x0,0x0,0x0,0x1,0x0,0x41,0x57,0x7,0x0,0x0,0x0,0x0,0x0,0x16,0x0,0x0,0x0]),_0x5a17f9=Buffer['from'](JSON[_0x2b41a2(0x170)](_0x165300),_0x2b41a2(0x174)),_0x30ade8=Buffer[_0x2b41a2(0x17f)]([_0x20b969,_0x5a17f9]);return _0x30ade8[_0x2b41a2(0x164)](_0x5a17f9[_0x2b41a2(0x177)],0xe,0x4),await _0x2d81da[_0x2b41a2(0x1a0)](_0xa5cf08),_0x2d81da['exif']=_0x30ade8,await _0x2d81da[_0x2b41a2(0x176)](null);}async function sticker(_0x2b9a7f,_0x559792,..._0x325a67){const _0x15f511=a0_0x17dd58;let _0x5483a6,_0xa89807;for(const _0x2d82ea of[sticker3,global[_0x15f511(0x1a3)][_0x15f511(0x16b)]&&sticker6,sticker5,global[_0x15f511(0x1a3)]['ffmpeg']&&global[_0x15f511(0x1a3)][_0x15f511(0x18c)]&&sticker4,global[_0x15f511(0x1a3)][_0x15f511(0x16b)]&&(global[_0x15f511(0x1a3)][_0x15f511(0x190)]||global[_0x15f511(0x1a3)][_0x15f511(0x1aa)]||global[_0x15f511(0x1a3)]['gm'])&&sticker2]['filter'](_0x293752=>_0x293752)){try{_0xa89807=await _0x2d82ea(_0x2b9a7f,_0x559792,..._0x325a67);if(_0xa89807['includes'](_0x15f511(0x1b3)))continue;if(_0xa89807['includes'](_0x15f511(0x196)))try{return await addExif(_0xa89807,..._0x325a67);}catch(_0x29448e){return console[_0x15f511(0x19d)](_0x29448e),_0xa89807;}throw _0xa89807[_0x15f511(0x167)]();}catch(_0x49bddc){_0x5483a6=_0x49bddc;continue;}}return console['error'](_0x5483a6),_0x5483a6;}function a0_0x8571(){const _0x3829e3=['support','reply','24586GVIiXd','status','mime','androidAppStoreLink','exports','magick','bin','png','entries','.webp','-vf','26438ZHKqIz','toUpperCase','exit','html','libwebp','writeUIntLE','141KzirLp','wa-sticker-formatter','toString','text','unlink','366792rnLEcw','ffmpeg','end','push','join','webp','stringify','toBuffer','hex','MYSTIC','utf8','test','save','length','iosAppStoreLink','inputFormat','791Ytznek','stdin','scale=512:512:flags=lanczos:force_original_aspect_ratio=decrease,format=rgba,pad=512:512:(ow-iw)/2:(oh-ih)/2:color=#00000000,setsar=1','input','18lACvHw','concat','ext','close','data','25doHDxe','webp:-','templateId','packId','buffer','https://api.xteam.xyz/sticker/wm?','../tmp','stdout','isAvatarSticker','ffmpegWebp','addOutputOptions','40188belNLp','promises','convert','accessibilityText','default','../tmp/','isAiSticker','25152721UKBgwL','WEBP','writeFile','readFile','scale=\x27min(320,iw)\x27:min\x27(320,ih)\x27:force_original_aspect_ratio=decrease,fps=15,\x20pad=320:320:-1:-1:color=white@0.0,\x20split\x20[a][b];\x20[a]\x20palettegen=reserve_transparent=on:transparency_color=ffffff\x20[p];\x20[b][p]\x20paletteuse','-vcodec','randomBytes','2891290AQBUrS','error','chat','115404gFzvOS','load','stickerMakerSourceType','application/octet-stream'];a0_0x8571=function(){return _0x3829e3;};return a0_0x8571();}const support={'ffmpeg':!![],'ffprobe':!![],'ffmpegWebp':!![],'convert':!![],'magick':![],'gm':![],'find':![]};export{sticker,sticker2,sticker3,sticker4,sticker6,addExif,support};